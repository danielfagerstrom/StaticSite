(function(){function h(a){if(e.hasOwnProperty(a))return e[a];if(d.hasOwnProperty(a))return i(a);throw new Error('Module "'+a+'" does not exist.')}function i(a){var b={id:a,uri:c+a+".js",exports:{extend:p}};return e[a]=b,d[a].call(window,j(a),b.exports,b),b}function j(a){var b=function(b){return b=n(b,a),h(b).exports};return g&&(b.main=h(g)),b}function k(a,b){a=n(a,b);if(d.hasOwnProperty(a))return;var e=c+a+".js",h=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");h.open("GET",e,!0),h.onreadystatechange=function(){if(h.readyState===4){var c=f.indexOf(h);if(c==-1)return;f.splice(c,1);if(h.status==200){var e=h.responseText;try{d[a]=new Function("require","exports","module",e)}catch(i){throw new i.constructor(i.message+" in module:"+a)}m(e,a),!f.length&&g&&require.run(g)}else o(a,b)}},f.push(h),h.send(null)}function l(a,b){a=n(a,b);if(d.hasOwnProperty(a))return;var e=c+a+".js",f=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");f.open("GET",e,!1),f.send(null);var g=f.responseText;d[a]=new Function("require","exports","module",g),m(g,a,!0)}function m(a,b,c){var d,e=/\brequire\(("|')(.+?)\1\)/g;while(d=e.exec(a))c?l(d[2],b):k(d[2],b)}function n(a,b){if(a.charAt(0)=="."){var c=b.split("/"),d=a.split("/");c.pop();if(a.slice(0,3)=="../"){while(d[0]=="..")c.length||o(a,b),d.shift(),c.pop();return(c.length?c.join("/")+"/":"")+d.join("/")}if(a.slice(0,2)=="./")return d.shift(),c.join("/")+"/"+d.join("/")}return a}function o(a,b){var c=b?" require()'d from module \""+b+'"':"";throw new Error('Could not load module "'+a+'"'+c)}function p(a){for(var b=0;b<arguments.length;b++){a=arguments[b];for(var c in a)a.hasOwnProperty(c)&&(this[c]=a[c])}return this}function q(){var a=document.getElementsByTagName("script"),b;for(var c=0;c<a.length;c++)if(b=a[c].getAttribute("data-main")){if(a[c].hasAttribute("data-root"))require.root(a[c].getAttribute("data-root"));else{var d=a[c].getAttribute("src");require.root(d.replace(/[^\/]+$/,""))}require.run(b)}}var a=location.protocol+"//"+location.host,b=location.href.replace(/[^\/]*$/,""),c=b,d={},e={},f=[],g;window.require=function(b){return l(b),h(b).exports},require.root=function(d){if(!arguments.length)return c;d.slice(-1)!="/"&&(d+="/"),d.charAt(0)=="/"?c=a+d:d.indexOf("://")==-1?c=b+d:c=d},require.run=function(a){if(d.hasOwnProperty(a))return h(a).exports;k(g=a,"")},require.addModuleClosure=function(a,b){d[a]=b},q()})(),Object.create=Object.create||function(){var a=Object.defineProperty||function(a,b,c){c.hasOwnProperty("value")&&(a[b]=c.value)},b=Object.defineProperties||function(b,c){for(var d in c)c.hasOwnProperty(d)&&a(b,d,c[d])};return function(a,c){var d=function(a){a&&b(this,a)};return d.prototype=a,new d(c)}}(),Function.prototype.bind||(Function.prototype.bind=function(a){var b=Array.prototype.slice,c=b.call(arguments,1),d=this,e=function(){},f=function(){return d.apply(this instanceof e?this:a||{},c.concat(b.call(arguments)))};return e.prototype=d.prototype,f.prototype=new e,f}),function(){var a=Array.prototype;a.forEach||(a.forEach=function(a,b){var c=b||window;for(var d=0,e=this.length;d<e;++d)a.call(c,this[d],d,this)}),a.every||(a.every=function(a,b){var c=b||window;for(var d=0,e=this.length;d<e;++d)if(!a.call(c,this[d],d,this))return!1;return!0}),a.some||(a.some=function(a,b){var c=b||window;for(var d=0,e=this.length;d<e;++d)if(a.call(c,this[d],d,this))return!0;return!1}),a.map||(a.map=function(a,b){var c=b||window,d=[];for(var e=0,f=this.length;e<f;++e)d.push(a.call(c,this[e],e,this));return d}),a.filter||(a.filter=function(a,b){var c=b||window,d=[];for(var e=0,f=this.length;e<f;++e)a.call(c,this[e],e,this)&&d.push(this[e]);return d}),a.indexOf||(a.indexOf=function(a,b){b=b||0;for(var c=b,d=this.length;c<d;++c)if(this[c]===a)return c;return-1}),a.lastIndexOf||(a.lastIndexOf=function(a,b){b=b!==undefined?b:this.length,b>=this.length&&(b=this.length),b<0&&(b=this.length+b);for(var c=b;c>=0;--c)if(this[c]===a)return c;return-1}),a.reduce||(a.reduce=function(a){if(this===void 0||this===null)throw new TypeError;var b=Object(this),c=b.length>>>0;if(typeof a!="function")throw new TypeError;if(c==0&&arguments.length==1)throw new TypeError;var d=0,e;if(arguments.length>=2)e=arguments[1];else do{if(d in b){e=b[d++];break}if(++d>=c)throw new TypeError}while(!0);while(d<c)d in b&&(e=a.call(undefined,e,b[d],d,b)),d++;return e}),a.reduceRight||(a.reduceRight=function(a){if(this===void 0||this===null)throw new TypeError;var b=Object(this),c=b.length>>>0;if(typeof a!="function")throw new TypeError;if(c==0&&arguments.length==1)throw new TypeError;var d=b.length-1,e;if(arguments.length>=2)e=arguments[1];else do{if(d in b){e=b[d--];break}if(--d<0)throw new TypeError}while(!0);while(d>=0)d in b&&(e=a.call(undefined,e,b[d],d,b)),d--;return e}),Function.prototype.bind||(Function.prototype.bind=function(a){var b=[].slice,c=b.call(arguments,1),d=this,e=function(){},f=function(){return d.apply(this instanceof e?this:a||{},c.concat(b.call(arguments)))};return e.prototype=d.prototype,f.prototype=new e,f})}();var p=Date.parse;Date.CultureInfo={name:"en-US",englishName:"English (United States)",nativeName:"English (United States)",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],firstLetterDayNames:["S","M","T","W","T","F","S"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],amDesignator:"AM",pmDesignator:"PM",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"mdy",formatPatterns:{shortDate:"M/d/yyyy",longDate:"dddd, MMMM dd, yyyy",shortTime:"h:mm tt",longTime:"h:mm:ss tt",fullDateTime:"dddd, MMMM dd, yyyy h:mm:ss tt",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"MMMM dd",yearMonth:"MMMM, yyyy"},regexPatterns:{jan:/^jan(uary)?/i,feb:/^feb(ruary)?/i,mar:/^mar(ch)?/i,apr:/^apr(il)?/i,may:/^may/i,jun:/^jun(e)?/i,jul:/^jul(y)?/i,aug:/^aug(ust)?/i,sep:/^sep(t(ember)?)?/i,oct:/^oct(ober)?/i,nov:/^nov(ember)?/i,dec:/^dec(ember)?/i,sun:/^su(n(day)?)?/i,mon:/^mo(n(day)?)?/i,tue:/^tu(e(s(day)?)?)?/i,wed:/^we(d(nesday)?)?/i,thu:/^th(u(r(s(day)?)?)?)?/i,fri:/^fr(i(day)?)?/i,sat:/^sa(t(urday)?)?/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|aft(er)?|from|hence)/i,subtract:/^(\-|bef(ore)?|ago)/i,yesterday:/^yes(terday)?/i,today:/^t(od(ay)?)?/i,tomorrow:/^tom(orrow)?/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,second:/^sec(ond)?s?/i,minute:/^mn|min(ute)?s?/i,hour:/^h(our)?s?/i,week:/^w(eek)?s?/i,month:/^m(onth)?s?/i,day:/^d(ay)?s?/i,year:/^y(ear)?s?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt|utc)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a(?!u|p)|p)/i},timezones:[{name:"UTC",offset:"-000"},{name:"GMT",offset:"-000"},{name:"EST",offset:"-0500"},{name:"EDT",offset:"-0400"},{name:"CST",offset:"-0600"},{name:"CDT",offset:"-0500"},{name:"MST",offset:"-0700"},{name:"MDT",offset:"-0600"},{name:"PST",offset:"-0800"},{name:"PDT",offset:"-0700"}]},function(){var a=Date,b=a.prototype,c=a.CultureInfo,d=function(a,b){return b||(b=2),("000"+a).slice(b*-1)};b.clearTime=function(){return this.setHours(0),this.setMinutes(0),this.setSeconds(0),this.setMilliseconds(0),this},b.setTimeToNow=function(){var a=new Date;return this.setHours(a.getHours()),this.setMinutes(a.getMinutes()),this.setSeconds(a.getSeconds()),this.setMilliseconds(a.getMilliseconds()),this},a.today=function(){return(new Date).clearTime()},a.compare=function(a,b){if(isNaN(a)||isNaN(b))throw new Error(a+" - "+b);if(a instanceof Date&&b instanceof Date)return a<b?-1:a>b?1:0;throw new TypeError(a+" - "+b)},a.equals=function(a,b){return a.compareTo(b)===0},a.getDayNumberFromName=function(a){var b=c.dayNames,d=c.abbreviatedDayNames,e=c.shortestDayNames,f=a.toLowerCase();for(var g=0;g<b.length;g++)if(b[g].toLowerCase()==f||d[g].toLowerCase()==f||e[g].toLowerCase()==f)return g;return-1},a.getMonthNumberFromName=function(a){var b=c.monthNames,d=c.abbreviatedMonthNames,e=a.toLowerCase();for(var f=0;f<b.length;f++)if(b[f].toLowerCase()==e||d[f].toLowerCase()==e)return f;return-1},a.isLeapYear=function(a){return a%4===0&&a%100!==0||a%400===0},a.getDaysInMonth=function(b,c){return[31,a.isLeapYear(b)?29:28,31,30,31,30,31,31,30,31,30,31][c]},a.getTimezoneAbbreviation=function(a){var b=c.timezones,d;for(var e=0;e<b.length;e++)if(b[e].offset===a)return b[e].name;return null},a.getTimezoneOffset=function(a){var b=c.timezones,d;for(var e=0;e<b.length;e++)if(b[e].name===a.toUpperCase())return b[e].offset;return null},b.clone=function(){return new Date(this.getTime())},b.compareTo=function(a){return Date.compare(this,a)},b.equals=function(a){return Date.equals(this,a||new Date)},b.between=function(a,b){return this.getTime()>=a.getTime()&&this.getTime()<=b.getTime()},b.isAfter=function(a){return this.compareTo(a||new Date)===1},b.isBefore=function(a){return this.compareTo(a||new Date)===-1},b.isToday=function(){return this.isSameDay(new Date)},b.isSameDay=function(a){return this.clone().clearTime().equals(a.clone().clearTime())},b.addMilliseconds=function(a){return this.setMilliseconds(this.getMilliseconds()+a),this},b.addSeconds=function(a){return this.addMilliseconds(a*1e3)},b.addMinutes=function(a){return this.addMilliseconds(a*6e4)},b.addHours=function(a){return this.addMilliseconds(a*36e5)},b.addDays=function(a){return this.setDate(this.getDate()+a),this},b.addWeeks=function(a){return this.addDays(a*7)},b.addMonths=function(b){var c=this.getDate();return this.setDate(1),this.setMonth(this.getMonth()+b),this.setDate(Math.min(c,a.getDaysInMonth(this.getFullYear(),this.getMonth()))),this},b.addYears=function(a){return this.addMonths(a*12)},b.add=function(a){if(typeof a=="number")return this._orient=a,this;var b=a;return b.milliseconds&&this.addMilliseconds(b.milliseconds),b.seconds&&this.addSeconds(b.seconds),b.minutes&&this.addMinutes(b.minutes),b.hours&&this.addHours(b.hours),b.weeks&&this.addWeeks(b.weeks),b.months&&this.addMonths(b.months),b.years&&this.addYears(b.years),b.days&&this.addDays(b.days),this};var e,f,g;b.getWeek=function(){var a,b,c,d,h,i,j,k,l,m;return e=e?e:this.getFullYear(),f=f?f:this.getMonth()+1,g=g?g:this.getDate(),f<=2?(a=e-1,b=(a/4|0)-(a/100|0)+(a/400|0),c=((a-1)/4|0)-((a-1)/100|0)+((a-1)/400|0),l=b-c,h=0,i=g-1+31*(f-1)):(a=e,b=(a/4|0)-(a/100|0)+(a/400|0),c=((a-1)/4|0)-((a-1)/100|0)+((a-1)/400|0),l=b-c,h=l+1,i=g+(153*(f-3)+2)/5+58+l),j=(a+b)%7,d=(i+j-h)%7,k=i+3-d|0,k<0?m=53-((j-l)/5|0):k>364+l?m=1:m=(k/7|0)+1,e=f=g=null,m},b.getISOWeek=function(){return e=this.getUTCFullYear(),f=this.getUTCMonth()+1,g=this.getUTCDate(),d(this.getWeek())},b.setWeek=function(a){return this.moveToDayOfWeek(1).addWeeks(a-this.getWeek())},a._validate=function(a,b,c,d){if(typeof a=="undefined")return!1;if(typeof a!="number")throw new TypeError(a+" is not a Number.");if(a<b||a>c)throw new RangeError(a+" is not a valid value for "+d+".");return!0},a.validateMillisecond=function(b){return a._validate(b,0,999,"millisecond")},a.validateSecond=function(b){return a._validate(b,0,59,"second")},a.validateMinute=function(b){return a._validate(b,0,59,"minute")},a.validateHour=function(b){return a._validate(b,0,23,"hour")},a.validateDay=function(b,c,d){return a._validate(b,1,a.getDaysInMonth(c,d),"day")},a.validateMonth=function(b){return a._validate(b,0,11,"month")},a.validateYear=function(b){return a._validate(b,0,9999,"year")},b.set=function(b){return a.validateMillisecond(b.millisecond)&&this.addMilliseconds(b.millisecond-this.getMilliseconds()),a.validateSecond(b.second)&&this.addSeconds(b.second-this.getSeconds()),a.validateMinute(b.minute)&&this.addMinutes(b.minute-this.getMinutes()),a.validateHour(b.hour)&&this.addHours(b.hour-this.getHours()),a.validateMonth(b.month)&&this.addMonths(b.month-this.getMonth()),a.validateYear(b.year)&&this.addYears(b.year-this.getFullYear()),a.validateDay(b.day,this.getFullYear(),this.getMonth())&&this.addDays(b.day-this.getDate()),b.timezone&&this.setTimezone(b.timezone),b.timezoneOffset&&this.setTimezoneOffset(b.timezoneOffset),b.week&&a._validate(b.week,0,53,"week")&&this.setWeek(b.week),this},b.moveToFirstDayOfMonth=function(){return this.set({day:1})},b.moveToLastDayOfMonth=function(){return this.set({day:a.getDaysInMonth(this.getFullYear(),this.getMonth())})},b.moveToNthOccurrence=function(a,b){var c=0;if(b>0)c=b-1;else if(b===-1)return this.moveToLastDayOfMonth(),this.getDay()!==a&&this.moveToDayOfWeek(a,-1),this;return this.moveToFirstDayOfMonth().addDays(-1).moveToDayOfWeek(a,1).addWeeks(c)},b.moveToDayOfWeek=function(a,b){var c=(a-this.getDay()+7*(b||1))%7;return this.addDays(c===0?c+=7*(b||1):c)},b.moveToMonth=function(a,b){var c=(a-this.getMonth()+12*(b||1))%12;return this.addMonths(c===0?c+=12*(b||1):c)},b.getOrdinalNumber=function(){return Math.ceil((this.clone().clearTime()-new Date(this.getFullYear(),0,1))/864e5)+1},b.getTimezone=function(){return a.getTimezoneAbbreviation(this.getUTCOffset())},b.setTimezoneOffset=function(a){var b=this.getTimezoneOffset(),c=Number(a)*-6/10;return this.addMinutes(c-b)},b.setTimezone=function(b){return this.setTimezoneOffset(a.getTimezoneOffset(b))},b.hasDaylightSavingTime=function(){return Date.today().set({month:0,day:1}).getTimezoneOffset()!==Date.today().set({month:6,day:1}).getTimezoneOffset()},b.isDaylightSavingTime=function(){return this.hasDaylightSavingTime()&&(new Date).getTimezoneOffset()===Date.today().set({month:6,day:1}).getTimezoneOffset()},b.getUTCOffset=function(){var a=this.getTimezoneOffset()*-10/6,b;return a<0?(b=(a-1e4).toString(),b.charAt(0)+b.substr(2)):(b=(a+1e4).toString(),"+"+b.substr(1))},b.getElapsed=function(a){return(a||new Date)-this},b.toISOString||(b.toISOString=function(){function a(a){return a<10?"0"+a:a}return'"'+this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+'Z"'}),b._toString=b.toString,b.toString=function(a){var b=this;if(a&&a.length==1){var e=c.formatPatterns;b.t=b.toString;switch(a){case"d":return b.t(e.shortDate);case"D":return b.t(e.longDate);case"F":return b.t(e.fullDateTime);case"m":return b.t(e.monthDay);case"r":return b.t(e.rfc1123);case"s":return b.t(e.sortableDateTime);case"t":return b.t(e.shortTime);case"T":return b.t(e.longTime);case"u":return b.t(e.universalSortableDateTime);case"y":return b.t(e.yearMonth)}}var f=function(a){switch(a*1){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}};return a?a.replace(/(\\)?(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|S)/g,function(a){if(a.charAt(0)==="\\")return a.replace("\\","");b.h=b.getHours;switch(a){case"hh":return d(b.h()<13?b.h()===0?12:b.h():b.h()-12);case"h":return b.h()<13?b.h()===0?12:b.h():b.h()-12;case"HH":return d(b.h());case"H":return b.h();case"mm":return d(b.getMinutes());case"m":return b.getMinutes();case"ss":return d(b.getSeconds());case"s":return b.getSeconds();case"yyyy":return d(b.getFullYear(),4);case"yy":return d(b.getFullYear());case"dddd":return c.dayNames[b.getDay()];case"ddd":return c.abbreviatedDayNames[b.getDay()];case"dd":return d(b.getDate());case"d":return b.getDate();case"MMMM":return c.monthNames[b.getMonth()];case"MMM":return c.abbreviatedMonthNames[b.getMonth()];case"MM":return d(b.getMonth()+1);case"M":return b.getMonth()+1;case"t":return b.h()<12?c.amDesignator.substring(0,1):c.pmDesignator.substring(0,1);case"tt":return b.h()<12?c.amDesignator:c.pmDesignator;case"S":return f(b.getDate());default:return a}}):this._toString()}}(),function(){var a=Date,b=a.prototype,c=a.CultureInfo,d=Number.prototype;b._orient=1,b._nth=null,b._is=!1,b._same=!1,b._isSecond=!1,d._dateElement="day",b.next=function(){return this._orient=1,this},a.next=function(){return a.today().next()},b.last=b.prev=b.previous=function(){return this._orient=-1,this},a.last=a.prev=a.previous=function(){return a.today().last()},b.is=function(){return this._is=!0,this},b.same=function(){return this._same=!0,this._isSecond=!1,this},b.today=function(){return this.same().day()},b.weekday=function(){return this._is?(this._is=!1,!this.is().sat()&&!this.is().sun()):!1},b.at=function(b){return typeof b=="string"?a.parse(this.toString("d")+" "+b):this.set(b)},d.fromNow=d.after=function(a){var b={};return b[this._dateElement]=this,(a?a.clone():new Date).add(b)},d.ago=d.before=function(a){var b={};return b[this._dateElement]=this*-1,(a?a.clone():new Date).add(b)};var e="sunday monday tuesday wednesday thursday friday saturday".split(/\s/),f="january february march april may june july august september october november december".split(/\s/),g="Millisecond Second Minute Hour Day Week Month Year".split(/\s/),h="Milliseconds Seconds Minutes Hours Date Week Month FullYear".split(/\s/),i="final first second third fourth fifth".split(/\s/),j;b.toObject=function(){var a={};for(var b=0;b<g.length;b++)a[g[b].toLowerCase()]=this["get"+h[b]]();return a},a.fromObject=function(a){return a.week=null,Date.today().set(a)};var k=function(b){return function(){if(this._is)return this._is=!1,this.getDay()==b;if(this._nth!==null){this._isSecond&&this.addSeconds(this._orient*-1),this._isSecond=!1;var c=this._nth;this._nth=null;var d=this.clone().moveToLastDayOfMonth();this.moveToNthOccurrence(b,c);if(this>d)throw new RangeError(a.getDayName(b)+" does not occur "+c+" times in the month of "+a.getMonthName(d.getMonth())+" "+d.getFullYear()+".");return this}return this.moveToDayOfWeek(b,this._orient)}},l=function(b){return function(){var d=a.today(),e=b-d.getDay();return b===0&&c.firstDayOfWeek===1&&d.getDay()!==0&&(e+=7),d.addDays(e)}};for(var m=0;m<e.length;m++)a[e[m].toUpperCase()]=a[e[m].toUpperCase().substring(0,3)]=m,a[e[m]]=a[e[m].substring(0,3)]=l(m),b[e[m]]=b[e[m].substring(0,3)]=k(m);var n=function(a){return function(){return this._is?(this._is=!1,this.getMonth()===a):this.moveToMonth(a,this._orient)}},o=function(b){return function(){return a.today().set({month:b,day:1})}};for(var p=0;p<f.length;p++)a[f[p].toUpperCase()]=a[f[p].toUpperCase().substring(0,3)]=p,a[f[p]]=a[f[p].substring(0,3)]=o(p),b[f[p]]=b[f[p].substring(0,3)]=n(p);var q=function(a){return function(){if(this._isSecond)return this._isSecond=!1,this;if(this._same){this._same=this._is=!1;var b=this.toObject(),c=(arguments[0]||new Date).toObject(),d="",e=a.toLowerCase();for(var f=g.length-1;f>-1;f--){d=g[f].toLowerCase();if(b[d]!=c[d])return!1;if(e==d)break}return!0}return a.substring(a.length-1)!="s"&&(a+="s"),this["add"+a](this._orient)}},r=function(a){return function(){return this._dateElement=a,this}};for(var s=0;s<g.length;s++)j=g[s].toLowerCase(),b[j]=b[j+"s"]=q(g[s]),d[j]=d[j+"s"]=r(j);b._ss=q("Second");var t=function(a){return function(b){return this._same?this._ss(arguments[0]):b||b===0?this.moveToNthOccurrence(b,a):(this._nth=a,a!==2||b!==undefined&&b!==null?this:(this._isSecond=!0,this.addSeconds(this._orient)))}};for(var u=0;u<i.length;u++)b[i[u]]=u===0?t(-1):t(u)}(),function(){Date.Parsing={Exception:function(a){this.message="Parse error at '"+a.substring(0,10)+" ...'"}};var a=Date.Parsing,b=a.Operators={rtoken:function(b){return function(c){var d=c.match(b);if(d)return[d[0],c.substring(d[0].length)];throw new a.Exception(c)}},token:function(a){return function(a){return b.rtoken(new RegExp("^s*"+a+"s*"))(a)}},stoken:function(a){return b.rtoken(new RegExp("^"+a))},until:function(a){return function(b){var c=[],d=null;while(b.length){try{d=a.call(this,b)}catch(e){c.push(d[0]),b=d[1];continue}break}return[c,b]}},many:function(a){return function(b){var c=[],d=null;while(b.length){try{d=a.call(this,b)}catch(e){return[c,b]}c.push(d[0]),b=d[1]}return[c,b]}},optional:function(a){return function(b){var c=null;try{c=a.call(this,b)}catch(d){return[null,b]}return[c[0],c[1]]}},not:function(b){return function(c){try{b.call(this,c)}catch(d){return[null,c]}throw new a.Exception(c)}},ignore:function(a){return a?function(b){var c=null;return c=a.call(this,b),[null,c[1]]}:null},product:function(){var a=arguments[0],c=Array.prototype.slice.call(arguments,1),d=[];for(var e=0;e<a.length;e++)d.push(b.each(a[e],c));return d},cache:function(b){var c={},d=null;return function(e){try{d=c[e]=c[e]||b.call(this,e)}catch(f){d=c[e]=f}if(d instanceof a.Exception)throw d;return d}},any:function(){var b=arguments;return function(c){var d=null;for(var e=0;e<b.length;e++){if(b[e]==null)continue;try{d=b[e].call(this,c)}catch(f){d=null}if(d)return d}throw new a.Exception(c)}},each:function(){var b=arguments;return function(c){var d=[],e=null;for(var f=0;f<b.length;f++){if(b[f]==null)continue;try{e=b[f].call(this,c)}catch(g){throw new a.Exception(c)}d.push(e[0]),c=e[1]}return[d,c]}},all:function(){var a=arguments,b=b;return b.each(b.optional(a))},sequence:function(c,d,e){return d=d||b.rtoken(/^\s*/),e=e||null,c.length==1?c[0]:function(b){var f=null,g=null,h=[];for(var i=0;i<c.length;i++){try{f=c[i].call(this,b)}catch(j){break}h.push(f[0]);try{g=d.call(this,f[1])}catch(k){g=null;break}b=g[1]}if(!f)throw new a.Exception(b);if(g)throw new a.Exception(g[1]);if(e)try{f=e.call(this,f[1])}catch(l){throw new a.Exception(f[1])}return[h,f?f[1]:b]}},between:function(a,c,d){d=d||a;var e=b.each(b.ignore(a),c,b.ignore(d));return function(a){var b=e.call(this,a);return[[b[0][0],r[0][2]],b[1]]}},list:function(a,c,d){return c=c||b.rtoken(/^\s*/),d=d||null,a instanceof Array?b.each(b.product(a.slice(0,-1),b.ignore(c)),a.slice(-1),b.ignore(d)):b.each(b.many(b.each(a,b.ignore(c))),px,b.ignore(d))},set:function(c,d,e){return d=d||b.rtoken(/^\s*/),e=e||null,function(f){var g=null,h=null,i=null,j=null,k=[[],f],l=!1;for(var m=0;m<c.length;m++){i=null,h=null,g=null,l=c.length==1;try{g=c[m].call(this,f)}catch(n){continue}j=[[g[0]],g[1]];if(g[1].length>0&&!l)try{i=d.call(this,g[1])}catch(o){l=!0}else l=!0;!l&&i[1].length===0&&(l=!0);if(!l){var p=[];for(var q=0;q<c.length;q++)m!=q&&p.push(c[q]);h=b.set(p,d).call(this,i[1]),h[0].length>0&&(j[0]=j[0].concat(h[0]),j[1]=h[1])}j[1].length<k[1].length&&(k=j);if(k[1].length===0)break}if(k[0].length===0)return k;if(e){try{i=e.call(this,k[1])}catch(r){throw new a.Exception(k[1])}k[1]=i[1]}return k}},forward:function(a,b){return function(c){return a[b].call(this,c)}},replace:function(a,b){return function(c){var d=a.call(this,c);return[b,d[1]]}},process:function(a,b){return function(c){var d=a.call(this,c);return[b.call(this,d[0]),d[1]]}},min:function(b,c){return function(d){var e=c.call(this,d);if(e[0].length<b)throw new a.Exception(d);return e}}},c=function(a){return function(){var b=null,c=[];arguments.length>1?b=Array.prototype.slice.call(arguments):arguments[0]instanceof Array&&(b=arguments[0]);if(!b)return a.apply(null,arguments);for(var d=0,e=b.shift();d<e.length;d++)return b.unshift(e[d]),c.push(a.apply(null,b)),b.shift(),c}},d="optional not ignore cache".split(/\s/);for(var e=0;e<d.length;e++)b[d[e]]=c(b[d[e]]);var f=function(a){return function(){return arguments[0]instanceof Array?a.apply(null,arguments[0]):a.apply(null,arguments)}},g="each any all".split(/\s/);for(var h=0;h<g.length;h++)b[g[h]]=f(b[g[h]])}(),function(){var a=Date,b=a.prototype,c=a.CultureInfo,d=function(a){var b=[];for(var c=0;c<a.length;c++)a[c]instanceof Array?b=b.concat(d(a[c])):a[c]&&b.push(a[c]);return b};a.Grammar={},a.Translator={hour:function(a){return function(){this.hour=Number(a)}},minute:function(a){return function(){this.minute=Number(a)}},second:function(a){return function(){this.second=Number(a)}},meridian:function(a){return function(){this.meridian=a.slice(0,1).toLowerCase()}},timezone:function(a){return function(){var b=a.replace(/[^\d\+\-]/g,"");b.length?this.timezoneOffset=Number(b):this.timezone=a.toLowerCase()}},day:function(a){var b=a[0];return function(){this.day=Number(b.match(/\d+/)[0])}},month:function(a){return function(){this.month=a.length==3?"jan feb mar apr may jun jul aug sep oct nov dec".indexOf(a)/4:Number(a)-1}},year:function(a){return function(){var b=Number(a);this.year=a.length>2?b:b+(b+2e3<c.twoDigitYearMax?2e3:1900)}},rday:function(a){return function(){switch(a){case"yesterday":this.days=-1;break;case"tomorrow":this.days=1;break;case"today":this.days=0;break;case"now":this.days=0,this.now=!0}}},finishExact:function(b){b=b instanceof Array?b:[b];for(var c=0;c<b.length;c++)b[c]&&b[c].call(this);var d=new Date;(this.hour||this.minute)&&!this.month&&!this.year&&!this.day&&(this.day=d.getDate()),this.year||(this.year=d.getFullYear()),!this.month&&this.month!==0&&(this.month=d.getMonth()),this.day||(this.day=1),this.hour||(this.hour=0),this.minute||(this.minute=0),this.second||(this.second=0),this.meridian&&this.hour&&(this.meridian=="p"&&this.hour<12?this.hour=this.hour+12:this.meridian=="a"&&this.hour==12&&(this.hour=0));if(this.day>a.getDaysInMonth(this.year,this.month))throw new RangeError(this.day+" is not a valid value for days.");var e=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second);return this.timezone?e.set({timezone:this.timezone}):this.timezoneOffset&&e.set({timezoneOffset:this.timezoneOffset}),e},finish:function(b){b=b instanceof Array?d(b):[b];if(b.length===0)return null;for(var c=0;c<b.length;c++)typeof b[c]=="function"&&b[c].call(this);var e=a.today();if(this.now&&!this.unit&&!this.operator)return new Date;this.now&&(e=new Date);var f=!!(this.days&&this.days!==null||this.orient||this.operator),g,h,i;i=this.orient=="past"||this.operator=="subtract"?-1:1,!this.now&&"hour minute second".indexOf(this.unit)!=-1&&e.setTimeToNow(),(this.month||this.month===0)&&"year day hour minute second".indexOf(this.unit)!=-1&&(this.value=this.month+1,this.month=null,f=!0);if(!f&&this.weekday&&!this.day&&!this.days){var j=Date[this.weekday]();this.day=j.getDate(),this.month||(this.month=j.getMonth()),this.year=j.getFullYear()}f&&this.weekday&&this.unit!="month"&&(this.unit="day",g=a.getDayNumberFromName(this.weekday)-e.getDay(),h=7,this.days=g?(g+i*h)%h:i*h),this.month&&this.unit=="day"&&this.operator&&(this.value=this.month+1,this.month=null),this.value!=null&&this.month!=null&&this.year!=null&&(this.day=this.value*1),this.month&&!this.day&&this.value&&(e.set({day:this.value*1}),f||(this.day=this.value*1)),!this.month&&this.value&&this.unit=="month"&&!this.now&&(this.month=this.value,f=!0),f&&(this.month||this.month===0)&&this.unit!="year"&&(this.unit="month",g=this.month-e.getMonth(),h=12,this.months=g?(g+i*h)%h:i*h,this.month=null),this.unit||(this.unit="day");if(!this.value&&this.operator&&this.operator!==null&&this[this.unit+"s"]&&this[this.unit+"s"]!==null)this[this.unit+"s"]=this[this.unit+"s"]+(this.operator=="add"?1:-1)+(this.value||0)*i;else if(this[this.unit+"s"]==null||this.operator!=null)this.value||(this.value=1),this[this.unit+"s"]=this.value*i;this.meridian&&this.hour&&(this.meridian=="p"&&this.hour<12?this.hour=this.hour+12:this.meridian=="a"&&this.hour==12&&(this.hour=0));if(this.weekday&&!this.day&&!this.days){var j=Date[this.weekday]();this.day=j.getDate(),j.getMonth()!==e.getMonth()&&(this.month=j.getMonth())}return(this.month||this.month===0)&&!this.day&&(this.day=1),!this.orient&&!this.operator&&this.unit=="week"&&this.value&&!this.day&&!this.month?Date.today().setWeek(this.value):(f&&this.timezone&&this.day&&this.days&&(this.day=this.days),f?e.add(this):e.set(this))}};var e=a.Parsing.Operators,f=a.Grammar,g=a.Translator,h;f.datePartDelimiter=e.rtoken(/^([\s\-\.\,\/\x27]+)/),f.timePartDelimiter=e.stoken(":"),f.whiteSpace=e.rtoken(/^\s*/),f.generalDelimiter=e.rtoken(/^(([\s\,]|at|@|on)+)/);var i={};f.ctoken=function(a){var b=i[a];if(!b){var d=c.regexPatterns,f=a.split(/\s+/),g=[];for(var h=0;h<f.length;h++)g.push(e.replace(e.rtoken(d[f[h]]),f[h]));b=i[a]=e.any.apply(null,g)}return b},f.ctoken2=function(a){return e.rtoken(c.regexPatterns[a])},f.h=e.cache(e.process(e.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),g.hour)),f.hh=e.cache(e.process(e.rtoken(/^(0[0-9]|1[0-2])/),g.hour)),f.H=e.cache(e.process(e.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),g.hour)),f.HH=e.cache(e.process(e.rtoken(/^([0-1][0-9]|2[0-3])/),g.hour)),f.m=e.cache(e.process(e.rtoken(/^([0-5][0-9]|[0-9])/),g.minute)),f.mm=e.cache(e.process(e.rtoken(/^[0-5][0-9]/),g.minute)),f.s=e.cache(e.process(e.rtoken(/^([0-5][0-9]|[0-9])/),g.second)),f.ss=e.cache(e.process(e.rtoken(/^[0-5][0-9]/),g.second)),f.hms=e.cache(e.sequence([f.H,f.m,f.s],f.timePartDelimiter)),f.t=e.cache(e.process(f.ctoken2("shortMeridian"),g.meridian)),f.tt=e.cache(e.process(f.ctoken2("longMeridian"),g.meridian)),f.z=e.cache(e.process(e.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),g.timezone)),f.zz=e.cache(e.process(e.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),g.timezone)),f.zzz=e.cache(e.process(f.ctoken2("timezone"),g.timezone)),f.timeSuffix=e.each(e.ignore(f.whiteSpace),e.set([f.tt,f.zzz])),f.time=e.each(e.optional(e.ignore(e.stoken("T"))),f.hms,f.timeSuffix),f.d=e.cache(e.process(e.each(e.rtoken(/^([0-2]\d|3[0-1]|\d)/),e.optional(f.ctoken2("ordinalSuffix"))),g.day)),f.dd=e.cache(e.process(e.each(e.rtoken(/^([0-2]\d|3[0-1])/),e.optional(f.ctoken2("ordinalSuffix"))),g.day)),f.ddd=f.dddd=e.cache(e.process(f.ctoken("sun mon tue wed thu fri sat"),function(a){return function(){this.weekday=a}})),f.M=e.cache(e.process(e.rtoken(/^(1[0-2]|0\d|\d)/),g.month)),f.MM=e.cache(e.process(e.rtoken(/^(1[0-2]|0\d)/),g.month)),f.MMM=f.MMMM=e.cache(e.process(f.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),g.month)),f.y=e.cache(e.process(e.rtoken(/^(\d\d?)/),g.year)),f.yy=e.cache(e.process(e.rtoken(/^(\d\d)/),g.year)),f.yyy=e.cache(e.process(e.rtoken(/^(\d\d?\d?\d?)/),g.year)),f.yyyy=e.cache(e.process(e.rtoken(/^(\d\d\d\d)/),g.year)),h=function(){return e.each(e.any.apply(null,arguments),e.not(f.ctoken2("timeContext")))},f.day=h(f.d,f.dd),f.month=h(f.M,f.MMM),f.year=h(f.yyyy,f.yy),f.orientation=e.process(f.ctoken("past future"),function(a){return function(){this.orient=a}}),f.operator=e.process(f.ctoken("add subtract"),function(a){return function(){this.operator=a}}),f.rday=e.process(f.ctoken("yesterday tomorrow today now"),g.rday),f.unit=e.process(f.ctoken("second minute hour day week month year"),function(a){return function(){this.unit=a}}),f.value=e.process(e.rtoken(/^\d\d?(st|nd|rd|th)?/),function(a){return function(){this.value=a.replace(/\D/g,"")}}),f.expression=e.set([f.rday,f.operator,f.value,f.unit,f.orientation,f.ddd,f.MMM]),h=function(){return e.set(arguments,f.datePartDelimiter)},f.mdy=h(f.ddd,f.month,f.day,f.year),f.ymd=h(f.ddd,f.year,f.month,f.day),f.dmy=h(f.ddd,f.day,f.month,f.year),f.date=function(a){return(f[c.dateElementOrder]||f.mdy).call(this,a)},f.format=e.process(e.many(e.any(e.process(e.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(b){if(f[b])return f[b];throw a.Parsing.Exception(b)}),e.process(e.rtoken(/^[^dMyhHmstz]+/),function(a){return e.ignore(e.stoken(a))}))),function(a){return e.process(e.each.apply(null,a),g.finishExact)});var j={},k=function(a){return j[a]=j[a]||f.format(a)[0]};f.formats=function(a){if(a instanceof Array){var b=[];for(var c=0;c<a.length;c++)b.push(k(a[c]));return e.any.apply(null,b)}return k(a)},f._formats=f.formats(['"yyyy-MM-ddTHH:mm:ssZ"',"yyyy-MM-ddTHH:mm:ssZ","yyyy-MM-ddTHH:mm:ssz","yyyy-MM-ddTHH:mm:ss","yyyy-MM-ddTHH:mmZ","yyyy-MM-ddTHH:mmz","yyyy-MM-ddTHH:mm","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","MMddyyyy","ddMMyyyy","Mddyyyy","ddMyyyy","Mdyyyy","dMyyyy","yyyy","Mdyy","dMyy","d"]),f._start=e.process(e.set([f.date,f.time,f.expression],f.generalDelimiter,f.whiteSpace),g.finish),f.start=function(a){try{var b=f._formats.call({},a);if(b[1].length===0)return b}catch(c){}return f._start.call({},a)},a._parse=a.parse,a.parse=function(b){var c=null;if(!b)return null;if(b instanceof Date)return b;try{c=a.Grammar.start.call({},b.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1"))}catch(d){return null}return c[1].length===0?c[0]:null},a.getParseFunction=function(b){var c=a.Grammar.formats(b);return function(a){var b=null;try{b=c.call({},a)}catch(d){return null}return b[1].length===0?b[0]:null}},a.parseExact=function(b,c){return a.getParseFunction(c)(b)}}(),Date.parseDate=Date.parse,Date.parse=p,Date.prototype.format=function(a){var b="",c=Date.replaceChars;for(var d=0;d<a.length;d++){var e=a.charAt(d);c[e]?b+=c[e].call(this):e=="\\"?b+=a.charAt(++d):b+=e}return b},Date.prototype.formatGMT=function(a){var b=new Date(this.getTime()+this.getTimezoneOffset()*6e4);return b.format(a)},Date.replaceChars={shortMonths
:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longMonths:["January","February","March","April","May","June","July","August","September","October","November","December"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longDays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],readableFormats:[[60,"just now"],[90,"1 minute"],[3600,"minutes",60],[5400,"1 hour"],[86400,"hours",3600],[129600,"1 day"],[604800,"days",86400],[907200,"1 week"],[2628e3,"weeks",604800]],d:function(){return(this.getDate()<10?"0":"")+this.getDate()},D:function(){return Date.replaceChars.shortDays[this.getDay()]},j:function(){return this.getDate()},l:function(){return Date.replaceChars.longDays[this.getDay()]},N:function(){return this.getDay()+1},S:function(){return this.getDate()%10==1&&this.getDate()!=11?"st":this.getDate()%10==2&&this.getDate()!=12?"nd":this.getDate()%10==3&&this.getDate()!=13?"rd":"th"},w:function(){return this.getDay()},z:function(){return"Not Yet Supported"},W:function(){return"Not Yet Supported"},F:function(){return Date.replaceChars.longMonths[this.getMonth()]},m:function(){return(this.getMonth()<9?"0":"")+(this.getMonth()+1)},M:function(){return Date.replaceChars.shortMonths[this.getMonth()]},n:function(){return this.getMonth()+1},t:function(){return"Not Yet Supported"},L:function(){return this.getFullYear()%4==0&&this.getFullYear()%100!=0||this.getFullYear()%400==0?"1":"0"},o:function(){return"Not Supported"},Y:function(){return this.getFullYear()},y:function(){return(""+this.getFullYear()).substr(2)},a:function(){return this.getHours()<12?"am":"pm"},A:function(){return this.getHours()<12?"AM":"PM"},B:function(){return"Not Yet Supported"},g:function(){return this.getHours()%12||12},G:function(){return this.getHours()},h:function(){return((this.getHours()%12||12)<10?"0":"")+(this.getHours()%12||12)},H:function(){return(this.getHours()<10?"0":"")+this.getHours()},i:function(){return(this.getMinutes()<10?"0":"")+this.getMinutes()},s:function(){return(this.getSeconds()<10?"0":"")+this.getSeconds()},e:function(){return"Not Yet Supported"},I:function(){return"Not Supported"},O:function(){return(-this.getTimezoneOffset()<0?"-":"+")+(Math.abs(this.getTimezoneOffset()/60)<10?"0":"")+Math.abs(this.getTimezoneOffset()/60)+"00"},P:function(){return(-this.getTimezoneOffset()<0?"-":"+")+(Math.abs(this.getTimezoneOffset()/60)<10?"0":"")+Math.abs(this.getTimezoneOffset()/60)+":"+(Math.abs(this.getTimezoneOffset()%60)<10?"0":"")+Math.abs(this.getTimezoneOffset()%60)},T:function(){var a=this.getMonth();this.setMonth(0);var b=this.toTimeString().replace(/^.+ \(?([^\)]+)\)?$/,"$1");return this.setMonth(a),b},Z:function(){return-this.getTimezoneOffset()*60},c:function(){return this.format("Y-m-d")+"T"+this.format("H:i:sP")},r:function(){return this.toString()},U:function(){return this.getTime()/1e3}},Date.prototype.readable=function(a){a=a||"m/d/Y";var b=Date.replaceChars.readableFormats,c=new Date,d=(c-this)/1e3,e=" ago",f=0,g;d<0&&(d=Math.abs(d),e="");while(g=b[f++])if(d<g[0])return g.length==2?g[1]+(f>1?e:""):Math.round(d/g[2])+" "+g[1]+e;return d>47304e5?Math.round(d/47304e5)+" Centuries"+e:this.format(a)},Date.prototype.readableDay=function(a){a=a||"m/d/Y";var b=Date.replaceChars.readableFormats,c=this.getTime(),d=Date.today().getTime(),e=864e5,f=e*7,g=Date.today().add(-1).month().getTime();if(c>d){if(c==d+e)return"tomorrow"}else{if(c==d)return"today";if(c==d-e)return"yesterday";if(c>d-f)return(d-c)/e+" days ago";if(c==d-f)return"1 week ago";if(c>d-e*30&&(d-c)%f==0)return(d-c)/f+" weeks ago";if(c==Date.today().add(-1).month().getTime())return"1 month ago"}return this.format(a)},require.addModuleClosure("screens/dashboard",function(a,b,c){}),require.addModuleClosure("screens/login",function(a,b,c){var d=a("data"),e=a("screens"),f=a("cookie");e.bind("open:login",function(){$("#login :text:visible:first").focus(),$("#login :checkbox[name=rememberme]").attr("checked",!!f.get("rememberme")),d.auth().then(function(){e.go("dashboard")})}),$("#loginform").submit(function(a){a.preventDefault();var b=$(this),c=b.find("input[name=username]").val(),f=b.find("input[name=password]").val(),g=b.find("input[name=rememberme]").attr("checked");d.login(c,f,g).then(function(){$("#login :text, #login :password").val(""),$("#login :checkbox").attr("checked",!1),e.go("dashboard")},function(){alert("Username or password incorrect")})}),$("#registerform").submit(function(a){a.preventDefault();var b=$(this);d.register(b.find("input[name=key]").val(),b.find("input[name=secret]").val(),b.find("input[name=username]").val(),b.find("input[name=password]").val()).then(function(){$("#login :text, #login :password").val(""),$("#login :checkbox").attr("checked",!1),e.go("dashboard")},function(){alert("Key or secret incorrect")})})}),require.addModuleClosure("screens/logout",function(a,b,c){var d=a("data"),e=a("screens");e.bind("open:logout",function(){d.logout(),e.go("login")})}),require.addModuleClosure("screens/site",function(a,b,c){a("jstree");var d=$("#pages-screen");d.find(".sidebar").jstree({animation:0,strings:{loading:"Loading ...",new_node:"New page"},plugins:[]})}),require.addModuleClosure("cookie",function(a,b,c){var d=b.extend({set:function(a,b,c,d,e){document.cookie=a+"="+encodeURI(b)+(c?";expires="+(typeof c=="number"?new Date(c):c).toGMTString():"")+(d?";path="+d:";path=/")+(e?";secure":"")},get:function(a){var b=d.open();return b[a]},remove:function(a,b){d.set(a,"",new Date(0),b)},open:function(){var a={},b=document.cookie.split("; ");for(var c=0;c<b.length;c++){var d=b[c].split("=");a[d[0]]=decodeURI(d[1])}return a}})}),require.addModuleClosure("screens",function(a,b,c){var d=a("class").Class,e=a("backbone"),f=a("promise").when,g=e.View,h=new d({extend:g,templateName:"{name}.html",constructor:function(a,b){this.el=$(a),this.$("> *").hide(),this.screens={},this.titles={};if(b)for(var c in b){if(!b.hasOwnProperty(c))continue;this.screens[c]=$(b[c])}},at:function(a){var b=a.split("/"),c=b.shift(),d=b.shift();if(this.screens.hasOwnProperty(c)&&(c=this.screens[c]).filter(":visible").length)if(!d||c.find(".screens > ."+d+":visible").length)return!0;return!1},go:function(a){location.hash="#/"+a},open:function(a,b){var c=a.split("/").shift();if(!this.screens.hasOwnProperty(c)){var d=this;this.load(c).then(function(){d._open(a,b)})}else this._open(a,b);return this},load:function(b){var c=this.templateName.replace(/\{\s*name\s*\}/g,b),d=this,e=$('<div class="screen loading"></div>').attr("id",b+"-screen").appendTo(this.el);return d.screens[b]=e,d.trigger("created:"+b,e),d.trigger("created",b,e),f($.ajax({url:c,dataType:"html"})).then(function(c){var f=c.indexOf("<body");if(f!==-1){var g=(c.match(/<title>([^<]+)<\/title>/)||{1:"Static Site CMS"})[1],h=c.indexOf(">",f)+1,i=c.lastIndexOf("</body>");d.titles[b]=g;var j=c.slice(f,h).match(/ class="([^"]+)"/);j&&e.data("bodyClasses",j[1]),c=c.slice(h,i)}c=c.replace(/<script.+?<\/script>/g,""),e.html(c).removeClass("loading").hide().find(".screens > :not(:first-child)").hide(),d.trigger("load:"+b,e),d.trigger("load",b,e);try{a("screens/"+b)}catch(k){}return e})},_open:function(a,b){var c=a.split("/"),d=this,e=c.shift(),f=c.shift(),g=this.screens[e],h=f?g.find(".screens > ."+f+"-screen"):g.find(".screens > :first");this.titles.hasOwnProperty(e)&&(document.title=this.titles[e]);var i=!1;if(!g.filter(":visible").length){this.$("> :visible").hide().trigger("hide").each(function(){var a=$(this),b=a.attr("id").replace("-screen",""),c=a.data("bodyData");c&&$("body").removeClass(c),d.trigger("close:"+b,a),d.trigger("close",b,a)});var j=g.data("bodyClasses");j&&$("body").addClass(j),g.show().trigger("show",[b]),this.trigger("open:"+e,g),this.trigger("open",e,g),i=!0}h.length&&(i||!h.filter(":visible").length)&&(h.filter(":visible").length||(h.siblings(":visible").hide().each(function(){var a=$(this),b=a.attr("class").replace(/(\S+)-screen/,"$1");b=a.parent().closest(".screen").attr("id").replace("-screen","")+"/"+b,d.trigger("close:"+b,a),d.trigger("close",b,a)}),h.show()),this.trigger("open:"+a,h),this.trigger("open",a,h))}}),i=c.exports=new h("#screens");i.bind("close",function(a){$("body").removeClass(a.split("/").shift())}),i.bind("open",function(a){$("body").addClass(a.split("/").shift())});var j=e.history=new e.History;j.route(/.*/,function(a){a.slice(0,1)==="/"?i.open(a.slice(1)):a==""&&i.go("dashboard")}),j.start()}),require.addModuleClosure("data",function(a,b,c){function n(){return(new Date).getTime()+2592e6}var d=a("cookie"),e=a("crypto").sha1,f=a("crypto").aes,g=a("crypto").uuid,h=a("promise").when,i=a("backbone");Deferred=a("promise").Deferred,s3=a("s3").s3;var j,k=location.pathname.replace(/^\/([^\/]+).*/,"$1"),l="/"+k+"/admin/",m=b.extend(i.Events,{collections:{},get:function(a){return j.get("api/"+a)},put:function(a,b){return j.put("api/"+a,b)},destory:function(a){return j.destory("api/"+a)},refresh:function(a){var b=new Deferred,c=b.promise;return j.list("api/").then(function(b){var d=/^api\/(\w+)\/(\w+)$/,e={};b.contents.forEach(function(b){var f=b.key.match(d);if(!f)return;var g=f[2],h=f[1];if(!m.collections.hasOwnProperty(h))return;var i=m.collections[h];e[h]||(e[h]={}),e[h][g]=!0;if(i.get(g)&&i.get(g).etag==b.etag)return;c=c.then(j.get(b.key).then(function(c){c=JSON.parse(c),c.id=g,i.get(g)?i.get(g).set(c,a).etag=b.etag:i.add(c,a).get(g).etag=b.etag},function(a){console.error(a)}))});for(var f in e){var g=[],h=e[f],i=m.collections[f];i.each(function(a){h[a.id]||g.push(a)}),i.remove(g,a)}},b.fail),c.then(function(){return m})},auth:function(){var a=d.get("session"),b=d.get("rememberme");return b&&b!="true"?(b=b.split(":"),this.login(b[0],b[1],!0,!0)):a?(a=a.split(":"),this.login(a[0],a[1],!1,!0)):(new Deferred).fail().promise},login:function(a,b,c,g){var h=new Deferred;return g||(a=e(a),b=e(b)),c?d.set("rememberme",a+":"+b,n(),l,!0):d.remove("rememberme",l),d.set("session",a+":"+b,null,l,!0),$.get("../api/auth/"+a).then(function(c){var d=f.decrypt(c,b,256).split(":");d.length==3&&d[0]==a?(s3.auth(d[1],d[2]),j=s3.bucket(k),j.list("api/auth/"+a).then(function(){h.fulfill(),m.trigger("login")},function(a){h.fail(a)})):h.fail(new Error("Incorrect Password"))},function(){h.fail(new Error("Incorrect Username"))}),h.promise},logout:function(){d.get("rememberme")&&d.set("rememberme","true",n(),l,!0),d.remove("session",l),s3.auth(null,null),m.trigger("logout")},register:function(a,b,c,d){s3.auth(a,b),j=s3.bucket(k),c=e(c),d=e(d);var g=f.encrypt([c,a,b].join(":"),d,256);return j.put("api/auth/"+c,g,{acl:"public-read"})},parseUrl:function(a,b){return this.addQueryParams(base+a,b)},addQueryParams:function(a,b){var c=[];for(var d in b){if(!b.hasOwnProperty(d))continue;c.push(d+"="+encodeURIComponent(b[d]))}return c.length&&(a+=(a.indexOf("?")!=-1?"&":"?")+c.join("&")),a}})}),require.addModuleClosure("class",function(a,b,c){function d(a,b){arguments.length==0&&(a={});var c=a.hasOwnProperty("implement")?a.implement:null,d=a.hasOwnProperty("extend")?a.extend:Object,f=a.hasOwnProperty("constructor")?a.constructor:a.constructor=function(){d.apply(this,arguments)};delete a.extend,delete a.implement;var g;if(c instanceof Array)for(var h=0,i=c.length;h<i;h++)g=typeof c[h]=="function"?c[h].prototype:c[h],e(f.prototype,g);else c&&(g=typeof c=="function"?c.prototype:c,e(f.prototype,g));return f.prototype=Object.create(d.prototype),e(f.prototype,a),b&&e(f,b),f}function e(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}d.convert=function(a,b){if(a.__proto__)a.__proto__=b.prototype,b.call(a);else{var c=new b;for(var d in a)c[d]=a[d];a=c}return a},typeof b!="undefined"&&(b.Class=d,b.copy=e)}),require.addModuleClosure("backbone",function(a,b,c){((function(){var c;typeof b!="undefined"?c=b:c=this.Backbone={},c.VERSION="0.3.3";var d=this._;!d&&typeof a!="undefined"&&(d=a("underscore")._);var e=this.jQuery||this.Zepto;c.emulateHTTP=!1,c.emulateJSON=!1,c.Events={bind:function(a,b){var c=this._callbacks||(this._callbacks={}),d=this._callbacks[a]||(this._callbacks[a]=[]);return d.push(b),this},unbind:function(a,b){var c;if(!a)this._callbacks={};else if(c=this._callbacks)if(!b)c[a]=[];else{var d=c[a];if(!d)return this;for(var e=0,f=d.length;e<f;e++)if(b===d[e]){d.splice(e,1);break}}return this},trigger:function(a){var b,c,d,e;if(!(c=this._callbacks))return this;if(c[a]){b=c[a].slice(0);for(d=0,e=b.length;d<e;d++)b[d].apply(this,Array.prototype.slice.call(arguments,1))}if(c.all){b=c.all.slice(0);for(d=0,e=b.length;d<e;d++)b[d].apply(this,arguments)}return this}},c.Model=function(a,b){var c;a||(a={});if(c=this.defaults)d.isFunction(c)&&(c=c()),a=d.extend({},c,a);this.attributes={},this._escapedAttributes={},this.cid=d.uniqueId("c"),this.set(a,{silent:!0}),this._changed=!1,this._previousAttributes=d.clone(this.attributes),b&&b.collection&&(this.collection=b.collection),this.initialize(a,b)},d.extend(c.Model.prototype,c.Events,{_previousAttributes:null,_changed:!1,idAttribute:"id",initialize:function(){},toJSON:function(){return d.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(a){var b;if(b=this._escapedAttributes[a])return b;var c=this.attributes[a];return this._escapedAttributes[a]=v(c==null?"":""+c)},has:function(a){return this.attributes[a]!=null},set:function(a,b){b||(b={});if(!a)return this;a.attributes&&(a=a.attributes);var c=this.attributes,e=this._escapedAttributes;if(!b.silent&&this.validate&&!this._performValidation(a,b))return!1;this.idAttribute in a&&(this.id=a[this.idAttribute]);for(var f in a){var g=a[f];d.isEqual(c[f],g)||(c[f]=g,delete e[f],this._changed=!0,b.silent||this.trigger("change:"+f,this,g,b))}return!b.silent&&this._changed&&this.change(b),this},unset:function(a,b){if(a in this.attributes){b||(b={});var c=this.attributes[a],d={};return d[a]=void 0,!b.silent&&this.validate&&!this._performValidation(d,b)?!1:(delete this.attributes[a],delete this._escapedAttributes[a],a==this.idAttribute&&delete this.id,this._changed=!0,b.silent||(this.trigger("change:"+a,this,void 0,b),this.change(b)),this)}return this},clear:function(a){a||(a={});var b=this.attributes,c={};for(attr in b)c[attr]=void 0;if(!a.silent&&this.validate&&!this._performValidation(c,a))return!1;this.attributes={},this._escapedAttributes={},this._changed=!0;if(!a.silent){for(attr in b)this.trigger("change:"+attr,this,void 0,a);this.change(a)}return this},fetch:function(a){a||(a={});var b=this,d=a.success;return a.success=function(c){if(!b.set(b.parse(c),a))return!1;d&&d(b,c)},a.error=u(a.error,b,a),(this.sync||c.sync).call(this,"read",this,a),this},save:function(a,b){b||(b={});if(a&&!this.set(a,b))return!1;var d=this,e=b.success;b.success=function(a){if(!d.set(d.parse(a),b))return!1;e&&e(d,a)},b.error=u(b.error,d,b);var f=this.isNew()?"create":"update";return(this.sync||c.sync).call(this,f,this,b),this},destroy:function(a){a||(a={});var b=this,d=a.success;return a.success=function(c){b.trigger("destroy",b,b.collection,a),d&&d(b,c)},a.error=u(a.error,b,a),(this.sync||c.sync).call(this,"delete",this,a),this},url:function(){var a=s(this.collection)||this.urlRoot||t();return this.isNew()?a:a+(a.charAt(a.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this)},isNew:function(){return!this.id},change:function(a){this.trigger("change",this,a),this._previousAttributes=d.clone(this.attributes),this._changed=!1},hasChanged:function(a){return a?this._previousAttributes[a]!=this.attributes[a]:this._changed},changedAttributes:function(a){a||(a=this.attributes);var b=this._previousAttributes,c=!1;for(var e in a)d.isEqual(b[e],a[e])||(c=c||{},c[e]=a[e]);return c},previous:function(a){return!a||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return d.clone(this._previousAttributes)},_performValidation:function(a,b){var c=this.validate(a);return c?(b.error?b.error(this,c):this.trigger("error",this,c,b),!1):!0}}),c.Collection=function(a,b){b||(b={}),b.comparator&&(this.comparator=b.comparator,delete b.comparator),d.bindAll(this,"_onModelEvent","_removeReference"),this._reset(),a&&this.refresh(a,{silent:!0}),this.initialize(a,b)},d.extend(c.Collection.prototype,c.Events,{model:c.Model,initialize:function(){},toJSON:function(){return this.map(function(a){return a.toJSON()})},add:function(a,b){if(d.isArray(a))for(var c=0,e=a.length;c<e;c++)this._add(a[c],b);else this._add(a,b);return this},remove:function(a,b){if(d.isArray(a))for(var c=0,e=a.length;c<e;c++)this._remove(a[c],b);else this._remove(a,b);return this},get:function(a){return a==null?null:this._byId[a.id!=null?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},sort:function(a){a||(a={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return this.models=this.sortBy(this.comparator),a.silent||this.trigger("refresh",this,a),this},pluck:function(a){return d.map(this.models,function(b){return b.get(a)})},refresh:function(a,b){return a||(a=[]),b||(b={}),this.each(this._removeReference),this._reset(),this.add(a,{silent:!0}),b.silent||this.trigger("refresh",this,b),this},fetch:function(a){a||(a={});var b=this,d=a.success;return a.success=function(c){b[a.add?"add":"refresh"](b.parse(c),a),d&&d(b,c)},a.error=u(a.error,b,a),(this.sync||c.sync).call(this,"read",this,a),this},create:function(a,b){var d=this;b||(b={});if(a instanceof c.Model)a.collection=d;else{var e=a;a=new this.model(null,{collection:d});if(!a.set(e))return!1}var f=b.success;return b.success=function(a,b){d.add(a),f&&f(a,b)},a.save(null,b)},parse:function(a){return a},chain:function(){return d(this.models).chain()},_reset:function(a){this.length=0,this.models=[],this._byId={},this._byCid={}},_add:function(a,b){b||(b={}),a instanceof c.Model||(a=new this.model(a,{collection:this}));var d=this.getByCid(a);if(d)throw new Error(["Can't add the same model to a set twice",d.id]);this._byId[a.id]=a,this._byCid[a.cid]=a,a.collection||(a.collection=this);var e=this.comparator?this.sortedIndex(a,this.comparator):this.length;return this.models.splice(e,0,a),a.bind("all",this._onModelEvent),this.length++,b.silent||a.trigger("add",a,this,b),a},_remove:function(a,b){return b||(b={}),a=this.getByCid(a)||this.get(a),a?(delete this._byId[a.id],delete this._byCid[a.cid],this.models.splice(this.indexOf(a),1),this.length--,b.silent||a.trigger("remove",a,this,b),this._removeReference(a),a):null},_removeReference:function(a){this==a.collection&&delete a.collection,a.unbind("all",this._onModelEvent)},_onModelEvent:function(a,b,c,d){if(a!="add"&&a!="remove"||c==this)a=="destroy"&&this._remove(b,d),a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],this._byId[b.id]=b),this.trigger.apply(this,arguments);else return}});var f=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","invoke","max","min","sortBy","sortedIndex","toArray","size","first","rest","last","without","indexOf","lastIndexOf","isEmpty"];d.each(f,function(a){c.Collection.prototype[a]=function(){return d[a].apply(d,[this.models].concat(d.toArray(arguments)))}}),c.Controller=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize(a)};var g=/:([\w\d]+)/g,h=/\*([\w\d]+)/g,i=/[-[\]{}()+?.,\\^$|#\s]/g;d.extend(c.Controller.prototype,c.Events,{initialize:function(){},route:function(a,b,e){c.history||(c.history=new c.History),d.isRegExp(a)||(a=this._routeToRegExp(a)),c.history.route(a,d.bind(function(c){var d=this._extractParameters(a,c);e.apply(this,d),this.trigger.apply(this,["route:"+b].concat(d))},this))},saveLocation:function(a){c.history.saveLocation(a)},_bindRoutes:function(){if(!this.routes)return;var a=[];for(var b in this.routes)a.unshift([b,this.routes[b]]);for(var c=0,d=a.length;c<d;c++)this.route(a[c][0],a[c][1],this[a[c][1]])},_routeToRegExp:function(a){return a=a.replace(i,"\\$&").replace(g,"([^/]*)").replace(h,"(.*?)"),new RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}}),c.History=function(){this.handlers=[],this.fragment=this.getFragment(),d.bindAll(this,"checkUrl")};var j=/^#*/,k=!1;d.extend(c.History.prototype,{interval:50,getFragment:function(a){return(a||window.location).hash.replace(j,"")},start:function(){if(k)throw new Error("Backbone.history has already been started");var a=document.documentMode,b=e.browser.msie&&(!a||a<=7);return b&&(this.iframe=e('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow),"onhashchange"in window&&!b?e(window).bind("hashchange",this.checkUrl):setInterval(this.checkUrl,this.interval),k=!0,this.loadUrl()},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();a==this.fragment&&this.iframe&&(a=this.getFragment(this.iframe.location));if(a==this.fragment||a==decodeURIComponent(this.fragment))return!1;this.iframe&&(window.location.hash=this.iframe.location.hash=a),this.loadUrl()},loadUrl:function(){var a=this.fragment=this.getFragment(),b=d.any(this.handlers,function(b){if(b.route.test(a))return b.callback(a),!0});return b},saveLocation:function(a){a=(a||"").replace(j,"");if(this.fragment==a)return;window.location.hash=this.fragment=a,this.iframe&&a!=this.getFragment(this.iframe.location)&&(this.iframe.document.open().close(),this.iframe.location.hash=a)}}),c.View=function(a){this.cid=d.uniqueId("view"),this._configure(a||{}),this._ensureElement(),this.delegateEvents(),this.initialize(a)};var l=function(a){return e(a,this.el)},m=/^(\w+)\s*(.*)$/,n=["model","collection","el","id","attributes","className","tagName"];d.extend(c.View.prototype,c.Events,{tagName:"div",$:l,initialize:function(){},render:function(){return this},remove:function(){return e(this.el).remove(),this},make:function(a,b,c){var d=document.createElement(a);return b&&e(d).attr(b),c&&e(d).html(c),d},delegateEvents:function(a){if(!a&&!(a=this.events))return;e(this.el).unbind(".delegateEvents"+this.cid);for(var b in a){var c=a[b],f=b.match(m),g=f[1],h=f[2],i=d.bind(this[c],this);g+=".delegateEvents"+this.cid,h===""?e(this.el).bind(g,i):e(this.el).delegate(h,g,i)}},_configure:function(a){this.options&&(a=d.extend({},this.options,a));for(var b=0,c=n.length;b<c;b++){var e=n[b];a[e]&&(this[e]=a[e])}this.options=a},_ensureElement:function(){if(!this.el){var a=this.attributes||{};this.id&&(a.id=this.id),this.className&&(a["class"]=this.className),this.el=this.make(this.tagName,a)}else d.isString(this.el)&&(this.el=e(this.el).get(0))}});var o=function(a,b){var c=r(this,a,b);return c.extend=o,c};c.Model.extend=c.Collection.extend=c.Controller.extend=c.View.extend=o;var p={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};c.sync=function(a,b,f){var g=p[a],h=d.extend({type:g,contentType:"application/json",dataType:"json",processData:!1},f);h.url||(h.url=s(b)||t()),!h.data&&b&&(a=="create"||a=="update")&&(h.data=JSON.stringify(b.toJSON())),c.emulateJSON&&(h.contentType="application/x-www-form-urlencoded",h.processData=!0,h.data=h.data?{model:h.data}:{}),c.emulateHTTP&&(g==="PUT"||g==="DELETE")&&(c.emulateJSON&&(h.data._method=g),h.type="POST",h.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",g)}),e.ajax(h)};var q=function(){},r=function(a,b,c){var e;return b&&b.hasOwnProperty("constructor")?e=b.constructor:e=function(){return a.apply(this,arguments)},d.extend(e,a),q.prototype=a.prototype,e.prototype=new q,b&&d.extend(e.prototype,b),c&&d.extend(e,c),e.prototype.constructor=e,e.__super__=a.prototype,e},s=function(a){return!a||!a.url?null:d.isFunction(a.url)?a.url():a.url},t=function(){throw new Error("A 'url' property or function must be specified")},u=function(a,b,c){return function(d){a?a(b,d,c):b.trigger("error",b,d,c)}},v=function(a){return a.replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}})).call(this)}),require.addModuleClosure("promise",function(a,b,c){function d(){}function e(a){var b=new f;if(arguments.length<=1)return b.fulfill(a).promise;var c=Array.prototype.slice.call(arguments),d=c.length,e=function(a){return function(e){c[a]=e,--d==0&&b.fulfill.apply(null,c)}};for(var g=0,h=c.length;g<h;g++)a=c[g],a&&typeof a.then=="function"?a.then(e(g),b.fail):--d;return d==0&&b.fulfill.apply(null,c),b.promise}function f(a){this.status="unfulfilled",this.progressHandlers=[],this.handlers=[],a=this.promise=a||new f.Promise;var b=a.cancel,c=this;b&&(a.cancel=function(){var d=b.apply(a,arguments);c.fail(d)}),a.then=this.then=this.then.bind(this),this.fulfill=this.fulfill.bind(this),this.fail=this.fail.bind(this),this.progress=this.progress.bind(this)}d.prototype={then:function(a,b,c){throw new TypeError("The Promise base class is abstract, this function must be implemented by the Promise implementation")},fulfilled:function(a){return this.then(a)},failed:function(a){return this.then(null,a)},progress:function(a){return this.then(null,null,a)},apply:function(a,b){return this.then(function(c){return c instanceof Array?a.apply(b,c):a.call(b,c)})},cancel:function(){return"Promise canceled"},get:function(a){return this.then(function(b){return b[a]})},set:function(a,b){return this.then(function(c){return c[a]=b,c})},put:function(a,b){return this.then(function(c){return c[a]=b})},run:function(a){return this.then(function(b){return b[a].apply(b,Array.prototype.slice.call(arguments,1)),b})},call:function(a){return this.then(function(b){return b[a].apply(b,Array.prototype.slice.call(arguments,1))})}},function(){function a(a,c){if(this.status!="unfulfilled")return;clearTimeout(this._timeout),this.status=a,this.results=c;var d=this.handlers;for(var e=0,f=d.length;e<f;e++)b.call(this,d[e])}function b(a){var b=this.results,c=a[this.status],d=a.nextDeferred;if(!c){d[this.status.slice(0,-2)].apply(null,b);return}var e=c.apply(null,b);e&&typeof e.then=="function"?e.then(d.fulfill,d.fail):e instanceof Error?d.fail(e):d.fulfill(e)}f.prototype={constructor:f,then:function(a,c,d){d&&this.progressHandlers.push(d);var e=new f,g={fulfilled:a,failed:c,nextDeferred:e};return this.finished()?b.call(this,g):this.handlers.push(g),e.promise},finished:function(){return this.status!="unfulfilled"},fulfill:function(b){return a.call(this,"fulfilled",Array.prototype.slice.call(arguments)),this},fail:function(b){return a.call(this,"failed",Array.prototype.slice.call(arguments)),this},progress:function(a){var b=this.progressHandlers;for(var c=0,d=b.length;c<d;c++)b[c].apply(null,arguments);return this},timeout:function(a,b){clearTimeout(this._timeout);var c=this;this._timeout=setTimeout(function(){c.fail(b||new Error("Operation timed out"))},a)}},f.Promise=d}(),Function.prototype.bind||(Function.prototype.bind=function(a){var b=Array.prototype.slice,c=b.call(arguments,1),d=this,e=function(){},f=function(){return d.apply(this instanceof e?this:a||{},c.concat(b.call(arguments)))};return e.prototype=d.prototype,f.prototype=new e,f}),typeof b!="undefined"&&(b.Deferred=f,b.Promise=d,b.when=e)}),require.addModuleClosure("crypto",function(e,f,g){function q(a){return G(y(E(a),a.length*p))}function r(a){return H(y(E(a),a.length*p))}function s(a){return F(y(E(a),a.length*p))}function t(a,b){return G(B(a,b))}function u(a,b){return H(B(a,b))}function v(a,b){return F(B(a,b))}function w(){return q("abc")=="a9993e364706816aba3e25717850c26c9cd0d89d"}function y(a,b){a[b>>5]|=128<<24-b%32,a[(b+64>>9<<4)+15]=b;var c=Array(80),d=1732584193,e=-271733879,f=-1732584194,g=271733878,h=-1009589776;for(var i=0;i<a.length;i+=16){var j=d,k=e,l=f,m=g,n=h;for(var o=0;o<80;o++){o<16?c[o]=a[i+o]:c[o]=D(c[o-3]^c[o-8]^c[o-14]^c[o-16],1);var p=C(C(D(d,5),z(o,e,f,g)),C(C(h,c[o]),A(o)));h=g,g=f,f=D(e,30),e=d,d=p}d=C(d,j),e=C(e,k),f=C(f,l),g=C(g,m),h=C(h,n)}return Array(d,e,f,g,h)}function z(a,b,c,d){return a<20?b&c|~b&d:a<40?b^c^d:a<60?b&c|b&d|c&d:b^c^d}function A(a){return a<20?1518500249:a<40?1859775393:a<60?-1894007588:-899497514}function B(a,b){var c=E(a);c.length>16&&(c=y(c,a.length*p));var d=Array(16),e=Array(16);for(var f=0;f<16;f++)d[f]=c[f]^909522486,e[f]=c[f]^1549556828;var g=y(d.concat(E(b)),512+b.length*p);return y(e.concat(g),672)}function C(a,b){var c=(a&65535)+(b&65535),d=(a>>16)+(b>>16)+(c>>16);return d<<16|c&65535}function D(a,b){return a<<b|a>>>32-b}function E(a){var b=Array(),c=(1<<p)-1;for(var d=0;d<a.length*p;d+=p)b[d>>5]|=(a.charCodeAt(d/p)&c)<<32-p-d%32;return b}function F(a){var b="",c=(1<<p)-1;for(var d=0;d<a.length*32;d+=p)b+=String.fromCharCode(a[d>>5]>>>32-p-d%32&c);return b}function G(a){var b=n?"0123456789ABCDEF":"0123456789abcdef",c="";for(var d=0;d<a.length*4;d++)c+=b.charAt(a[d>>2]>>(3-d%4)*8+4&15)+b.charAt(a[d>>2]>>(3-d%4)*8&15);return c}function H(a){var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c="";for(var d=0;d<a.length*4;d+=3){var e=(a[d>>2]>>8*(3-d%4)&255)<<16|(a[d+1>>2]>>8*(3-(d+1)%4)&255)<<8|a[d+2>>2]>>8*(3-(d+2)%4)&255;for(var f=0;f<4;f++)d*8+f*6>a.length*32?c+=o:c+=b.charAt(e>>6*(3-f)&63)}return c}function J(a){str="";for(j=0;j<=3;j++)str+=I.charAt(a>>j*8+4&15)+I.charAt(a>>j*8&15);return str}function K(a){nblk=(a.length+8>>6)+1,blks=new Array(nblk*16);for(i=0;i<nblk*16;i++)blks[i]=0;for(i=0;i<a.length;i++)blks[i>>2]|=a.charCodeAt(i)<<i%4*8;return blks[i>>2]|=128<<i%4*8,blks[nblk*16-2]=a.length*8,blks}function L(a,b){var c=(a&65535)+(b&65535),d=(a>>16)+(b>>16)+(c>>16);return d<<16|c&65535}function D(a,b){return a<<b|a>>>32-b}function M(a,b,c,d,e,f){return L(D(L(L(b,a),L(d,f)),e),c)}function N(a,b,c,d,e,f,g){return M(b&c|~b&d,a,b,e,f,g)}function O(a,b,c,d,e,f,g){return M(b&d|c&~d,a,b,e,f,g)}function P(a,b,c,d,e,f,g){return M(b^c^d,a,b,e,f,g)}function Q(a,b,c,d,e,f,g){return M(c^(b|~d),a,b,e,f,g)}function R(e){x=K(e),a=1732584193,b=-271733879,c=-1732584194,d=271733878;for(i=0;i<x.length;i+=16)olda=a,oldb=b,oldc=c,oldd=d,a=N(a,b,c,d,x[i+0],7,-680876936),d=N(d,a,b,c,x[i+1],12,-389564586),c=N(c,d,a,b,x[i+2],17,606105819),b=N(b,c,d,a,x[i+3],22,-1044525330),a=N(a,b,c,d,x[i+4],7,-176418897),d=N(d,a,b,c,x[i+5],12,1200080426),c=N(c,d,a,b,x[i+6],17,-1473231341),b=N(b,c,d,a,x[i+7],22,-45705983),a=N(a,b,c,d,x[i+8],7,1770035416),d=N(d,a,b,c,x[i+9],12,-1958414417),c=N(c,d,a,b,x[i+10],17,-42063),b=N(b,c,d,a,x[i+11],22,-1990404162),a=N(a,b,c,d,x[i+12],7,1804603682),d=N(d,a,b,c,x[i+13],12,-40341101),c=N(c,d,a,b,x[i+14],17,-1502002290),b=N(b,c,d,a,x[i+15],22,1236535329),a=O(a,b,c,d,x[i+1],5,-165796510),d=O(d,a,b,c,x[i+6],9,-1069501632),c=O(c,d,a,b,x[i+11],14,643717713),b=O(b,c,d,a,x[i+0],20,-373897302),a=O(a,b,c,d,x[i+5],5,-701558691),d=O(d,a,b,c,x[i+10],9,38016083),c=O(c,d,a,b,x[i+15],14,-660478335),b=O(b,c,d,a,x[i+4],20,-405537848),a=O(a,b,c,d,x[i+9],5,568446438),d=O(d,a,b,c,x[i+14],9,-1019803690),c=O(c,d,a,b,x[i+3],14,-187363961),b=O(b,c,d,a,x[i+8],20,1163531501),a=O(a,b,c,d,x[i+13],5,-1444681467),d=O(d,a,b,c,x[i+2],9,-51403784),c=O(c,d,a,b,x[i+7],14,1735328473),b=O(b,c,d,a,x[i+12],20,-1926607734),a=P(a,b,c,d,x[i+5],4,-378558),d=P(d,a,b,c,x[i+8],11,-2022574463),c=P(c,d,a,b,x[i+11],16,1839030562),b=P(b,c,d,a,x[i+14],23,-35309556),a=P(a,b,c,d,x[i+1],4,-1530992060),d=P(d,a,b,c,x[i+4],11,1272893353),c=P(c,d,a,b,x[i+7],16,-155497632),b=P(b,c,d,a,x[i+10],23,-1094730640),a=P(a,b,c,d,x[i+13],4,681279174),d=P(d,a,b,c,x[i+0],11,-358537222),c=P(c,d,a,b,x[i+3],16,-722521979),b=P(b,c,d,a,x[i+6],23,76029189),a=P(a,b,c,d,x[i+9],4,-640364487),d=P(d,a,b,c,x[i+12],11,-421815835),c=P(c,d,a,b,x[i+15],16,530742520),b=P(b,c,d,a,x[i+2],23,-995338651),a=Q(a,b,c,d,x[i+0],6,-198630844),d=Q(d,a,b,c,x[i+7],10,1126891415),c=Q(c,d,a,b,x[i+14],15,-1416354905),b=Q(b,c,d,a,x[i+5],21,-57434055),a=Q(a,b,c,d,x[i+12],6,1700485571),d=Q(d,a,b,c,x[i+3],10,-1894986606),c=Q(c,d,a,b,x[i+10],15,-1051523),b=Q(b,c,d,a,x[i+1],21,-2054922799),a=Q(a,b,c,d,x[i+8],6,1873313359),d=Q(d,a,b,c,x[i+15],10,-30611744),c=Q(c,d,a,b,x[i+6],15,-1560198380),b=Q(b,c,d,a,x[i+13],21,1309151649),a=Q(a,b,c,d,x[i+4],6,-145523070),d=Q(d,a,b,c,x[i+11],10,-1120210379),c=Q(c,d,a,b,x[i+2],15,718787259),b=Q(b,c,d,a,x[i+9],21,-343485551),a=L(a,olda),b=L(b,oldb),c=L(c,oldc),d=L(d,oldd);return J(a)+J(b)+J(c)+J(d)}function S(a){a=R(a);var b="";for(var c=0;c<32;c+=2)b+=String.fromCharCode(parseInt(a.slice(c,c+2),16));return l.encode(b)}function T(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=Math.random()*16|0,c=a=="x"?b:b&3|8;return c.toString(16)})}var h={};h.cipher=function(a,b){var c=4,d=b.length/c-1,e=[[],[],[],[]];for(var f=0;f<4*c;f++)e[f%4][Math.floor(f/4)]=a[f];e=h.addRoundKey(e,b,0,c);for(var g=1;g<d;g++)e=h.subBytes(e,c),e=h.shiftRows(e,c),e=h.mixColumns(e,c),e=h.addRoundKey(e,b,g,c);e=h.subBytes(e,c),e=h.shiftRows(e,c),e=h.addRoundKey(e,b,d,c);var i=new Array(4*c);for(var f=0;f<4*c;f++)i[f]=e[f%4][Math.floor
(f/4)];return i},h.keyExpansion=function(a){var b=4,c=a.length/4,d=c+6,e=new Array(b*(d+1)),f=new Array(4);for(var g=0;g<c;g++){var i=[a[4*g],a[4*g+1],a[4*g+2],a[4*g+3]];e[g]=i}for(var g=c;g<b*(d+1);g++){e[g]=new Array(4);for(var j=0;j<4;j++)f[j]=e[g-1][j];if(g%c==0){f=h.subWord(h.rotWord(f));for(var j=0;j<4;j++)f[j]^=h.rCon[g/c][j]}else c>6&&g%c==4&&(f=h.subWord(f));for(var j=0;j<4;j++)e[g][j]=e[g-c][j]^f[j]}return e},h.subBytes=function(a,b){for(var c=0;c<4;c++)for(var d=0;d<b;d++)a[c][d]=h.sBox[a[c][d]];return a},h.shiftRows=function(a,b){var c=new Array(4);for(var d=1;d<4;d++){for(var e=0;e<4;e++)c[e]=a[d][(e+d)%b];for(var e=0;e<4;e++)a[d][e]=c[e]}return a},h.mixColumns=function(a,b){for(var c=0;c<4;c++){var d=new Array(4),e=new Array(4);for(var f=0;f<4;f++)d[f]=a[f][c],e[f]=a[f][c]&128?a[f][c]<<1^283:a[f][c]<<1;a[0][c]=e[0]^d[1]^e[1]^d[2]^d[3],a[1][c]=d[0]^e[1]^d[2]^e[2]^d[3],a[2][c]=d[0]^d[1]^e[2]^d[3]^e[3],a[3][c]=d[0]^e[0]^d[1]^d[2]^e[3]}return a},h.addRoundKey=function(a,b,c,d){for(var e=0;e<4;e++)for(var f=0;f<d;f++)a[e][f]^=b[c*4+f][e];return a},h.subWord=function(a){for(var b=0;b<4;b++)a[b]=h.sBox[a[b]];return a},h.rotWord=function(a){var b=a[0];for(var c=0;c<3;c++)a[c]=a[c+1];return a[3]=b,a},h.sBox=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],h.rCon=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]],h.Ctr={},h.Ctr.encrypt=function(a,b,c){var d=16;if(c!=128&&c!=192&&c!=256)return"";a=m.encode(a),b=m.encode(b);var e=c/8,f=new Array(e);for(var g=0;g<e;g++)f[g]=isNaN(b.charCodeAt(g))?0:b.charCodeAt(g);var i=h.cipher(f,h.keyExpansion(f));i=i.concat(i.slice(0,e-16));var j=new Array(d),k=(new Date).getTime(),n=k%1e3,o=Math.floor(k/1e3),p=Math.floor(Math.random()*65535);for(var g=0;g<2;g++)j[g]=n>>>g*8&255;for(var g=0;g<2;g++)j[g+2]=p>>>g*8&255;for(var g=0;g<4;g++)j[g+4]=o>>>g*8&255;var q="";for(var g=0;g<8;g++)q+=String.fromCharCode(j[g]);var r=h.keyExpansion(i),s=Math.ceil(a.length/d),t=new Array(s);for(var u=0;u<s;u++){for(var v=0;v<4;v++)j[15-v]=u>>>v*8&255;for(var v=0;v<4;v++)j[15-v-4]=u/4294967296>>>v*8;var w=h.cipher(j,r),x=u<s-1?d:(a.length-1)%d+1,y=new Array(x);for(var g=0;g<x;g++)y[g]=w[g]^a.charCodeAt(u*d+g),y[g]=String.fromCharCode(y[g]);t[u]=y.join("")}var z=q+t.join("");return z=l.encode(z),z},h.Ctr.decrypt=function(a,b,c){var d=16;if(c!=128&&c!=192&&c!=256)return"";a=l.decode(a),b=m.encode(b);var e=c/8,f=new Array(e);for(var g=0;g<e;g++)f[g]=isNaN(b.charCodeAt(g))?0:b.charCodeAt(g);var i=h.cipher(f,h.keyExpansion(f));i=i.concat(i.slice(0,e-16));var j=new Array(8);ctrTxt=a.slice(0,8);for(var g=0;g<8;g++)j[g]=ctrTxt.charCodeAt(g);var k=h.keyExpansion(i),n=Math.ceil((a.length-8)/d),o=new Array(n);for(var p=0;p<n;p++)o[p]=a.slice(8+p*d,8+p*d+d);a=o;var q=new Array(a.length);for(var p=0;p<n;p++){for(var r=0;r<4;r++)j[15-r]=p>>>r*8&255;for(var r=0;r<4;r++)j[15-r-4]=(p+1)/4294967296-1>>>r*8&255;var s=h.cipher(j,k),t=new Array(a[p].length);for(var g=0;g<a[p].length;g++)t[g]=s[g]^a[p].charCodeAt(g),t[g]=String.fromCharCode(t[g]);q[p]=t.join("")}var u=q.join("");return u=m.decode(u),u};var k={};k.hash=function(a,b){b=typeof b=="undefined"?!0:b,b&&(a=m.encode(a));var c=[1518500249,1859775393,2400959708,3395469782];a+=String.fromCharCode(128);var d=a.length/4+2,e=Math.ceil(d/16),f=new Array(e);for(var g=0;g<e;g++){f[g]=new Array(16);for(var h=0;h<16;h++)f[g][h]=a.charCodeAt(g*64+h*4)<<24|a.charCodeAt(g*64+h*4+1)<<16|a.charCodeAt(g*64+h*4+2)<<8|a.charCodeAt(g*64+h*4+3)}f[e-1][14]=(a.length-1)*8/Math.pow(2,32),f[e-1][14]=Math.floor(f[e-1][14]),f[e-1][15]=(a.length-1)*8&4294967295;var i=1732584193,j=4023233417,l=2562383102,n=271733878,o=3285377520,p=new Array(80),q,r,s,t,u;for(var g=0;g<e;g++){for(var v=0;v<16;v++)p[v]=f[g][v];for(var v=16;v<80;v++)p[v]=k.ROTL(p[v-3]^p[v-8]^p[v-14]^p[v-16],1);q=i,r=j,s=l,t=n,u=o;for(var v=0;v<80;v++){var w=Math.floor(v/20),x=k.ROTL(q,5)+k.f(w,r,s,t)+u+c[w]+p[v]&4294967295;u=t,t=s,s=k.ROTL(r,30),r=q,q=x}i=i+q&4294967295,j=j+r&4294967295,l=l+s&4294967295,n=n+t&4294967295,o=o+u&4294967295}return k.toHexStr(i)+k.toHexStr(j)+k.toHexStr(l)+k.toHexStr(n)+k.toHexStr(o)},k.f=function(a,b,c,d){switch(a){case 0:return b&c^~b&d;case 1:return b^c^d;case 2:return b&c^b&d^c&d;case 3:return b^c^d}},k.ROTL=function(a,b){return a<<b|a>>>32-b},k.toHexStr=function(a){var b="",c;for(var d=7;d>=0;d--)c=a>>>d*4&15,b+=c.toString(16);return b};var l={};l.code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l.encode=function(a,b){b=typeof b=="undefined"?!1:b;var c,d,e,f,g,h,i,j,k=[],m="",n,o,p,q=l.code;o=b?a.encodeUTF8():a,n=o.length%3;if(n>0)while(n++<3)m+="=",o+="\0";for(n=0;n<o.length;n+=3)c=o.charCodeAt(n),d=o.charCodeAt(n+1),e=o.charCodeAt(n+2),f=c<<16|d<<8|e,g=f>>18&63,h=f>>12&63,i=f>>6&63,j=f&63,k[n/3]=q.charAt(g)+q.charAt(h)+q.charAt(i)+q.charAt(j);return p=k.join(""),p=p.slice(0,p.length-m.length)+m,p},l.decode=function(a,b){b=typeof b=="undefined"?!1:b;var c,d,e,f,g,h,i,j,k=[],m,n,o=l.code;n=b?a.decodeUTF8():a;for(var p=0;p<n.length;p+=4)f=o.indexOf(n.charAt(p)),g=o.indexOf(n.charAt(p+1)),h=o.indexOf(n.charAt(p+2)),i=o.indexOf(n.charAt(p+3)),j=f<<18|g<<12|h<<6|i,c=j>>>16&255,d=j>>>8&255,e=j&255,k[p/4]=String.fromCharCode(c,d,e),i==64&&(k[p/4]=String.fromCharCode(c,d)),h==64&&(k[p/4]=String.fromCharCode(c));return m=k.join(""),b?m.decodeUTF8():m};var m={};m.encode=function(a){var b=a.replace(/[\u0080-\u07ff]/g,function(a){var b=a.charCodeAt(0);return String.fromCharCode(192|b>>6,128|b&63)});return b=b.replace(/[\u0800-\uffff]/g,function(a){var b=a.charCodeAt(0);return String.fromCharCode(224|b>>12,128|b>>6&63,128|b&63)}),b},m.decode=function(a){var b=a.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(a){var b=(a.charCodeAt(0)&15)<<12|(a.charCodeAt(1)&63)<<6|a.charCodeAt(2)&63;return String.fromCharCode(b)});return b=b.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(a){var b=(a.charCodeAt(0)&31)<<6|a.charCodeAt(1)&63;return String.fromCharCode(b)}),b};var n=0,o="=",p=8,I="0123456789abcdef";typeof f!="undefined"&&(f.aes=h.Ctr,f.sha1=k.hash,f.base64=l,f.utf8=m,f.hex_sha1=q,f.b64_sha1=r,f.str_sha1=s,f.hex_hmac_sha1=t,f.b64_hmac_sha1=u,f.str_hmac_sha1=v,f.md5=R,f.b64_md5_digest=S,f.uuid=T)}),require.addModuleClosure("s3",function(a,b,c){function n(a,b){var c=b instanceof Array?b:[];if(b&&b!==c)for(var d in b){if(!b.hasOwnProperty(d))continue;c.push(d+"="+encodeURIComponent(b[d]))}var e;return(e=a.indexOf("?"))!=-1&&(c=c.concat(a.slice(e+1).split("&")),a=a.slice(0,e)),c.length&&(c.sort(),a+="?"+c.join("&")),a}function p(a,b){if(a instanceof Array){var c=a;a=b.firstChild,b=c}if(!a.nodeType)return a;if(a.childNodes.length==1&&a.firstChild.nodeType==3)return a.firstChild.nodeValue;var d={},e={};b&&b.forEach(function(a){e[a]=!0,d[a]=[]});var f=a.childNodes;for(var g=0,h=f.length;g<h;g++){var i=f[g],j=i.nodeName.replace(/^[A-Z]+/,function(a){return a.toLowerCase()}),k=q(p(i));e[j]?d[j].push(k):d[j]=k}return d}function q(a){if(typeof a!="string")return a;var b;for(var c=0;c<r.length;c++){var d=r[c];if(b=a.match(d.exp))return d.cast(b)}return a}function t(){navigator.mimeTypes.forEach(function(a){if(!a.suffixes)return;var b=a.type;a.suffixes.split(",").forEach(function(a){s.hasOwnProperty(a)||(s[a]=b)})})}var d=a("class").Class,e=a("crypto").b64_md5_digest,f=a("crypto").utf8,g=a("crypto").b64_hmac_sha1,h=a("promise").when,i=a("underscore")._,j,k,l=b.s3={auth:function(a,b){j=a,k=b},bucket:function(a){return new m(a)},list:function(){return l.load("get",url)},get:function(a){return l.load("get",url+a)},put:function(a,b,c){return l.load("put",url+a,b,c)},destroy:function(a){return l.load("delete",url+a)},load:function(a){var b=a.headers||{},c=a.method.toLowerCase()||"get",d=n(a.url,a.params),i=d.split("?"),l=i.length>1?i.pop().split("&"):[];i=n(i[0],l.filter(o.test));var m=(new Date).formatGMT("D, d M Y H:i:s \\G\\M\\T"),p=a.data,q=a.contentType||"",r="",t=[];if(q||c=="put"&&p){if(!q){var u=d.split("?").shift().replace(/^.*\./,"").toLowerCase();q=b["Content-Type"]||s[u]||"application/octet-stream"}b["Content-Type"]=q,r=b["Content-MD5"]=e(p)}b["x-amz-date"]=m,t.push("x-amz-date:"+m),a.acl&&(b["x-amz-acl"]=a.acl,t.push("x-amz-acl:"+a.acl));if(a.meta){var v=a.meta;for(var w in v){if(!v.hasOwnProperty(w))continue;var x=w,y=v[w].replace(/\n/g," ");b["x-amz-meta-"+x]=y,t.push("x-amz-meta-"+x+":"+y)}}if(!a.anonymous){var z="";t.length&&(z=t.sort().join("\n")+"\n");var A=[c.toUpperCase(),r,q,"",z+i].join("\n"),B=g(k,f.encode(A));b.Authorization="AWS "+j+":"+B}return h($.ajax({type:c,url:d,headers:b,data:p})).failed(function(a){var b=$(a.responseText);return b.find("code").text()=="SignatureDoesNotMatch"&&console.error("Signature does not match, expected:\n",b.find("StringToSign").text().replace(/\n/g,"\\n"),"\nactual:\n",A.replace(/\n/g,"\\n")),new Error(b.find("code").text())})}},m=new d({constructor:function(a){this.name=a,this.url="/"+a+"/"},list:function(a,b){return url=this.url,b=i.extend(b||{},{method:"get",url:url}),a&&((b.params||(b.params={})).prefix=a),l.load(b).then(p.bind(null,["contents"]))},get:function(a,b){return a=this.url+a,b=i.extend(b||{},{method:"get",url:a}),l.load(b)},put:function(a,b,c){return a=this.url+a,c=i.extend(c||{},{method:"put",url:a,data:b}),l.load(c)},destroy:function(a,b){return a=this.url+a,b=i.extend(b||{},{method:"delete",url:a}),l.load(b)}}),o=/^(versioning|location|acl|torrent|versionid)/;o.test=o.test.bind(o);var r=[{exp:/^true|false$/,cast:function(a){return a=="true"}},{exp:/^[\d\.]+$/,cast:function(a){return parseFloat(a[0])}},{exp:/^[\d\.]+$/,cast:function(a){return parseFloat(a[0])}},{exp:/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})\.(\d{3})Z$/,cast:function(a){return new Date(Date.UTC(a[1],parseInt(a[2])+1,a[3],a[4],a[5],a[6],a[7]))}}],s=b.mimeTypes={323:"text/h323",acx:"application/internet-property-stream",ai:"application/postscript",aif:"audio/x-aiff",aifc:"audio/x-aiff",aiff:"audio/x-aiff",asf:"video/x-ms-asf",asr:"video/x-ms-asf",asx:"video/x-ms-asf",au:"audio/basic",avi:"video/x-msvideo",axs:"application/olescript",bas:"text/plain",bcpio:"application/x-bcpio",bin:"application/octet-stream",bmp:"image/bmp",c:"text/plain",cat:"application/vnd.ms-pkiseccat",cdf:"application/x-cdf",cer:"application/x-x509-ca-cert","class":"application/octet-stream",clp:"application/x-msclip",cmx:"image/x-cmx",cod:"image/cis-cod",cpio:"application/x-cpio",crd:"application/x-mscardfile",crl:"application/pkix-crl",crt:"application/x-x509-ca-cert",csh:"application/x-csh",css:"text/css",dcr:"application/x-director",der:"application/x-x509-ca-cert",dir:"application/x-director",dll:"application/x-msdownload",dms:"application/octet-stream",doc:"application/msword",dot:"application/msword",dvi:"application/x-dvi",dxr:"application/x-director",eps:"application/postscript",etx:"text/x-setext",evy:"application/envoy",exe:"application/octet-stream",fif:"application/fractals",flr:"x-world/x-vrml",gif:"image/gif",gtar:"application/x-gtar",gz:"application/x-gzip",h:"text/plain",hdf:"application/x-hdf",hlp:"application/winhlp",hqx:"application/mac-binhex40",hta:"application/hta",htc:"text/x-component",htm:"text/html",html:"text/html",htt:"text/webviewhtml",ico:"image/x-icon",ief:"image/ief",iii:"application/x-iphone",ins:"application/x-internet-signup",isp:"application/x-internet-signup",jfif:"image/pipeg",jpe:"image/jpeg",jpeg:"image/jpeg",jpg:"image/jpeg",js:"application/x-javascript",latex:"application/x-latex",lha:"application/octet-stream",lsf:"video/x-la-asf",lsx:"video/x-la-asf",lzh:"application/octet-stream",m13:"application/x-msmediaview",m14:"application/x-msmediaview",m3u:"audio/x-mpegurl",man:"application/x-troff-man",mdb:"application/x-msaccess",me:"application/x-troff-me",mht:"message/rfc822",mhtml:"message/rfc822",mid:"audio/mid",mny:"application/x-msmoney",mov:"video/quicktime",movie:"video/x-sgi-movie",mp2:"video/mpeg",mp3:"audio/mpeg",mpa:"video/mpeg",mpe:"video/mpeg",mpeg:"video/mpeg",mpg:"video/mpeg",mpp:"application/vnd.ms-project",mpv2:"video/mpeg",ms:"application/x-troff-ms",mvb:"application/x-msmediaview",nws:"message/rfc822",oda:"application/oda",p10:"application/pkcs10",p12:"application/x-pkcs12",p7b:"application/x-pkcs7-certificates",p7c:"application/x-pkcs7-mime",p7m:"application/x-pkcs7-mime",p7r:"application/x-pkcs7-certreqresp",p7s:"application/x-pkcs7-signature",pbm:"image/x-portable-bitmap",pdf:"application/pdf",pfx:"application/x-pkcs12",pgm:"image/x-portable-graymap",pko:"application/ynd.ms-pkipko",pma:"application/x-perfmon",pmc:"application/x-perfmon",pml:"application/x-perfmon",pmr:"application/x-perfmon",pmw:"application/x-perfmon",pnm:"image/x-portable-anymap","pot,":"application/vnd.ms-powerpoint",ppm:"image/x-portable-pixmap",pps:"application/vnd.ms-powerpoint",ppt:"application/vnd.ms-powerpoint",prf:"application/pics-rules",ps:"application/postscript",pub:"application/x-mspublisher",qt:"video/quicktime",ra:"audio/x-pn-realaudio",ram:"audio/x-pn-realaudio",ras:"image/x-cmu-raster",rgb:"image/x-rgb",rmi:"audio/mid",roff:"application/x-troff",rtf:"application/rtf",rtx:"text/richtext",scd:"application/x-msschedule",sct:"text/scriptlet",setpay:"application/set-payment-initiation",setreg:"application/set-registration-initiation",sh:"application/x-sh",shar:"application/x-shar",sit:"application/x-stuffit",snd:"audio/basic",spc:"application/x-pkcs7-certificates",spl:"application/futuresplash",src:"application/x-wais-source",sst:"application/vnd.ms-pkicertstore",stl:"application/vnd.ms-pkistl",stm:"text/html",svg:"image/svg+xml",sv4cpio:"application/x-sv4cpio",sv4crc:"application/x-sv4crc",swf:"application/x-shockwave-flash",t:"application/x-troff",tar:"application/x-tar",tcl:"application/x-tcl",tex:"application/x-tex",texi:"application/x-texinfo",texinfo:"application/x-texinfo",tgz:"application/x-compressed",tif:"image/tiff",tiff:"image/tiff",tr:"application/x-troff",trm:"application/x-msterminal",tsv:"text/tab-separated-values",txt:"text/plain",uls:"text/iuls",ustar:"application/x-ustar",vcf:"text/x-vcard",vrml:"x-world/x-vrml",wav:"audio/x-wav",wcm:"application/vnd.ms-works",wdb:"application/vnd.ms-works",wks:"application/vnd.ms-works",wmf:"application/x-msmetafile",wps:"application/vnd.ms-works",wri:"application/x-mswrite",wrl:"x-world/x-vrml",wrz:"x-world/x-vrml",xaf:"x-world/x-vrml",xbm:"image/x-xbitmap",xla:"application/vnd.ms-excel",xlc:"application/vnd.ms-excel",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlt:"application/vnd.ms-excel",xlw:"application/vnd.ms-excel",xof:"x-world/x-vrml",xpm:"image/x-xpixmap",xwd:"image/x-xwindowdump",z:"application/x-compress",zip:"application/zip"};try{t()}catch(u){}}),require.addModuleClosure("jstree",function(a,b,c){"use strict",function(a){a.vakata={},a.vakata.css={get_css:function(a,b,c){a=a.toLowerCase();var d=c.cssRules||c.rules,e=0;do{if(d.length&&e>d.length+5)return!1;if(d[e].selectorText&&d[e].selectorText.toLowerCase()==a)return b===!0?(c.removeRule&&c.removeRule(e),c.deleteRule&&c.deleteRule(e),!0):d[e]}while(d[++e]);return!1},add_css:function(b,c){return a.jstree.css.get_css(b,!1,c)?!1:(c.insertRule?c.insertRule(b+" { }",0):c.addRule(b,null,0),a.vakata.css.get_css(b))},remove_css:function(b,c){return a.vakata.css.get_css(b,!0,c)},add_sheet:function(a){var b;if(a.str)return b=document.createElement("style"),b.setAttribute("type","text/css"),b.styleSheet?(document.getElementsByTagName("head")[0].appendChild(b),b.styleSheet.cssText=a.str):(b.appendChild(document.createTextNode(a.str)),document.getElementsByTagName("head")[0].appendChild(b)),b.sheet||b.styleSheet;if(a.url){if(!document.createStyleSheet)return b=document.createElement("link"),b.rel="stylesheet",b.type="text/css",b.media="all",b.href=a.url,document.getElementsByTagName("head")[0].appendChild(b),b.styleSheet;try{b=document.createStyleSheet(a.url)}catch(c){}}}}}(jQuery),function(a){var b=[],c=-1,d={},e={},f=!1;a.fn.jstree=function(c){var e=typeof c=="string",f=Array.prototype.slice.call(arguments,1),g=this;return!e&&a.meta&&f.push(a.metadata.get(this).jstree),c=!e&&f.length?a.extend.apply(null,[!0,c].concat(f)):c,e&&c.substring(0,1)=="_"?g:(e?this.each(function(){var d=b[a.data(this,"jstree-instance-id")],e=d&&a.isFunction(d[c])?d[c].apply(d,f):d;if(typeof e!="undefined"&&(c.indexOf(!1)||e!==!0&&e!==!1))return g=e,!1}):this.each(function(){var e=a.data(this,"jstree-instance-id"),f=!1;typeof e!="undefined"&&b[e]&&b[e].destroy(),e=parseInt(b.push({}),10)-1,a.data(this,"jstree-instance-id",e),c||(c={}),c.plugins=a.isArray(c.plugins)?c.plugins:a.jstree.defaults.plugins,a.inArray("core",c.plugins)===-1&&c.plugins.unshift("core"),f=a.extend(!0,{},a.jstree.defaults,c),f.plugins=c.plugins,a.each(d,function(b,c){a.inArray(b,f.plugins)===-1&&(f[b]=null,delete f[b])}),b[e]=new a.jstree._instance(e,a(this).addClass("jstree jstree-"+e),f),a.each(b[e]._get_settings().plugins,function(a,c){b[e].data[c]={}}),a.each(b[e]._get_settings().plugins,function(a,c){d[c]&&d[c].__init.apply(b[e])}),b[e].init()}),g)},a.jstree={defaults:{plugins:[]},_focused:function(){return b[c]||null},_reference:function(c){if(b[c])return b[c];var d=a(c);return!d.length&&typeof c=="string"&&(d=a("#"+c)),d.length?b[d.closest(".jstree").data("jstree-instance-id")]||null:null},_instance:function(b,c,d){this.data={core:{}},this.get_settings=function(){return a.extend(!0,{},d)},this._get_settings=function(){return d},this.get_index=function(){return b},this.get_container=function(){return c},this._set_settings=function(b){d=a.extend(!0,{},d,b)}},_fn:{},plugin:function(b,c){c=a.extend({},{__init:a.noop,__destroy:a.noop,_fn:{},defaults:!1},c),d[b]=c,a.jstree.defaults[b]=c.defaults,a.each(c._fn,function(c,d){d.plugin=b,d.old=a.jstree._fn[c],a.jstree._fn[c]=function(){var b,e=d,f=Array.prototype.slice.call(arguments),g=new a.Event("before.jstree"),h=!1;do{if(e&&e.plugin&&a.inArray(e.plugin,this._get_settings().plugins)!==-1)break;e=e.old}while(e);if(!e)return;b=this.get_container().triggerHandler(g,{func:c,inst:this,args:f});if(b===!1)return;return typeof b!="undefined"&&(f=b),c.indexOf("_")===0?b=e.apply(this,f):b=e.apply(a.extend({},this,{__callback:function(a){this.get_container().triggerHandler(c+".jstree",{inst:this,args:f,rslt:a,rlbk:h})},__rollback:function(){return h=this.get_rollback(),h},__call_old:function(a){return e.old.apply(this,a?Array.prototype.slice.call(arguments,1):f)}}),f),b},a.jstree._fn[c].old=d.old,a.jstree._fn[c].plugin=b})},rollback:function(c){c&&(a.isArray(c)||(c=[c]),a.each(c,function(a,c){b[c.i].set_rollback(c.h,c.d)}))}},a.jstree._fn=a.jstree._instance.prototype={},a(function(){var b=navigator.userAgent.toLowerCase(),c=(b.match(/.+?(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],d=".jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; } .jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; } .jstree-rtl li { margin-left:0; margin-right:18px; } .jstree > ul > li { margin-left:0px; } .jstree-rtl > ul > li { margin-right:0px; } .jstree ins { display:inline-block; text-decoration:none; width:18px; height:18px; margin:0 0 0 0; padding:0; } .jstree a { display:inline-block; line-height:16px; height:16px; color:black; white-space:nowrap; text-decoration:none; padding:1px 2px; margin:0; } .jstree a:focus { outline: none; } .jstree a > ins { height:16px; width:16px; } .jstree a > .jstree-icon { margin-right:3px; } .jstree-rtl a > .jstree-icon { margin-left:3px; margin-right:0; } li.jstree-open > ul { display:block; } li.jstree-closed > ul { display:none; } ";/msie/.test(b)&&parseInt(c,10)==6&&(f=!0,d+=".jstree li { height:18px; margin-left:0; margin-right:0; } .jstree li li { margin-left:18px; } .jstree-rtl li li { margin-left:0px; margin-right:18px; } li.jstree-open ul { display:block; } li.jstree-closed ul { display:none !important; } .jstree li a { display:inline; border-width:0 !important; padding:0px 2px !important; } .jstree li a ins { height:16px; width:16px; margin-right:3px; } .jstree-rtl li a ins { margin-right:0px; margin-left:3px; } "),/msie/.test(b)&&parseInt(c,10)==7&&(d+=".jstree li a { border-width:0 !important; padding:0px 2px !important; } "),a.vakata.css.add_sheet({str:d})}),a.jstree.plugin("core",{__init:function(){this.data.core.to_open=a.map(a.makeArray(this.get_settings().core.initially_open),function(a){return"#"+a.toString().replace(/^#/,"").replace("\\/","/").replace("/","\\/")})},defaults:{html_titles:!1,animation:500,initially_open:[],rtl:!1,strings:{loading:"Loading ...",new_node:"New node"}},_fn:{init:function(){this.set_focus(),this._get_settings().core.rtl&&this.get_container().addClass("jstree-rtl").css("direction","rtl"),this.get_container().html("<ul><li class='jstree-last jstree-leaf'><ins>&#160;</ins><a class='jstree-loading' href='#'><ins class='jstree-icon'>&#160;</ins>"+this._get_settings().core.strings.loading+"</a></li></ul>"),this.data.core.li_height=this.get_container().find("ul li.jstree-closed, ul li.jstree-leaf").eq(0).height()||18,this.get_container().delegate("li > ins","click.jstree",a.proxy(function(b){var c=a(b.target);c.is("ins")&&b.pageY-c.offset().top<this.data.core.li_height&&this.toggle_node(c)},this)).bind("mousedown.jstree",a.proxy(function(){this.set_focus()},this)).bind("dblclick.jstree",function(a){var b;if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){b=window.getSelection();try{b.removeAllRanges(),b.collapse()}catch(c){}}}),this.__callback(),this.load_node(-1,function(){this.loaded(),this.reopen()})},destroy:function(){var e,f=this.get_index(),g=this._get_settings(),h=this;a.each(g.plugins,function(a,b){try{d[b].__destroy.apply(h)}catch(c){}}),this.__callback();if(this.is_focused())for(e in b)if(b.hasOwnProperty(e)&&e!=f){b[e].set_focus();break}f===c&&(c=-1),this.get_container().unbind(".jstree").undelegate(".jstree").removeData("jstree-instance-id").find("[class^='jstree']").andSelf().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"")}),b[f]=null,delete b[f]},save_opened:function(){var a=this;this.data.core.to_open=[],this.get_container().find(".jstree-open").each(function(){a.data.core.to_open.push("#"+this.id.toString().replace(/^#/,"").replace("\\/","/").replace("/","\\/"))}),this.__callback(a.data.core.to_open)},reopen:function(b){var c=this,d=!0,e=[],f=[];b||(this.data.core.reopen=!1,this.data.core.refreshing=!0),this.data.core.to_open.length&&(a.each(this.data.core.to_open,function(b,c){if(c=="#")return!0;a(c).length&&a(c).is(".jstree-closed")?e.push(c):f.push(c)}),e.length&&(this.data.core.to_open=f,a.each(e,function(a,b){c.open_node(b,function(){c.reopen(!0)},!0)}),d=!1)),d&&(this.data.core.reopen&&clearTimeout(this.data.core.reopen),this.data.core.reopen=setTimeout(function(){c.__callback({},c)},50),this.data.core.refreshing=!1)},refresh:function(a){var b=this;this.save_opened(),a||(a=-1),a=this._get_node(a),a||(a=-1),a!==-1&&a.children("UL").remove(),this.load_node(a,function(){b.__callback({obj:a}),b.reopen()})},loaded:function(){this.__callback()},set_focus:function(){var b=a.jstree._focused();b&&b!==this&&b.get_container().removeClass("jstree-focused"),b!==this&&(this.get_container().addClass("jstree-focused"),c=this.get_index()),this.__callback()},is_focused:function(){return c==this.get_index()},_get_node:function(b){var c=a(b,this.get_container());return c.is(".jstree")||b==-1?-1:(c=c.closest("li",this.get_container()),c.length?c:!1)},_get_next:function(a,b){return a=this._get_node(a),a===-1?this.get_container().find("> ul > li:first-child"):a.length?b?a.nextAll("li").size()>0?a.nextAll("li:eq(0)"):!1:a.hasClass("jstree-open")?a.find("li:eq(0)"):a.nextAll("li").size()>0?a.nextAll("li:eq(0)"):a.parentsUntil(".jstree","li").next("li").eq(0):!1},_get_prev:function(a,b){a=this._get_node(a);if(a===-1)return this.get_container().find("> ul > li:last-child");if(!a.length)return!1;if(b)return a.prevAll("li").length>0?a.prevAll("li:eq(0)"):!1;if(a.prev("li").length){a=a.prev("li").eq(0);while(a.hasClass("jstree-open"))a=a.children("ul:eq(0)").children("li:last");return a}var c=a.parentsUntil(".jstree","li:eq(0)");return c.length?c:!1},_get_parent:function(a){a=this._get_node(a);if(a==-1||!a.length)return!1;var b=a.parentsUntil(".jstree","li:eq(0)");return b.length?b:-1},_get_children:function(a){return a=this._get_node(a),a===-1?this.get_container().children("ul:eq(0)").children("li"):a.length?a.children("ul:eq(0)").children("li"):!1},get_path:function(a,b){var c=[],d=this;return a=this._get_node(a),a===-1||!a||!a.length?!1:(a.parentsUntil(".jstree","li").each(function(){c.push(b?this.id:d.get_text(this))}),c.reverse(),c.push(b?a.attr("id"):this.get_text(a)),c)},is_open:function(a){return a=this._get_node(a),a&&a!==-1&&a.hasClass("jstree-open")},is_closed:function(a){return a=this._get_node(a),a&&a!==-1&&a.hasClass("jstree-closed")},is_leaf:function(a){return a=this._get_node(a),a&&a!==-1&&a.hasClass("jstree-leaf")},open_node:function(a,b,c){a=this._get_node(a);if(!a.length)return!1;if(!a.hasClass("jstree-closed"))return b&&b.call(),!1;var d=c||f?0:this._get_settings().core.animation,e=this;this._is_loaded(a)?(d&&a.children("ul").css("display","none"),a.removeClass("jstree-closed").addClass("jstree-open").children("a").removeClass("jstree-loading"),d&&a.children("ul").stop(!0).slideDown(d,function(){this.style.display=""}),this.__callback({obj:a}),b&&b.call()):(a.children("a").addClass("jstree-loading"),this.load_node(a,function(){e.open_node(a,b,c)},b))},close_node:function(a,b){a=this._get_node(a);var c=b||f?0:this._get_settings().core.animation;if(!a.length||!a.hasClass("jstree-open"))return!1;c&&a.children("ul").attr("style","display:block !important"),a.removeClass("jstree-open").addClass("jstree-closed"),c&&a.children("ul").stop(!0).slideUp(c,function(){this.style.display=""}),this.__callback({obj:a})},toggle_node:function(a){a=this._get_node(a);if(a.hasClass("jstree-closed"))return this.open_node(a);if(a.hasClass("jstree-open"))return this.close_node(a)},open_all:function(a,b){a=a?this._get_node(a):this.get_container();if(!a||a===-1)a=this.get_container();b?a=a.find("li.jstree-closed"):(b=a,a.is(".jstree-closed")?a=a.find("li.jstree-closed").andSelf():a=a.find("li.jstree-closed"));var c=this;a.each(function(){var a=this;c._is_loaded(this)?c.open_node(this,!1,!0):c.open_node(this,function(){c.open_all(a,b)},!0)}),b.find("li.jstree-closed").length===0&&this.__callback({obj:b})},close_all:function(a){var b=this;a=a?this._get_node(a):this.get_container();if(!a||a===-1)a=this.get_container();a.find("li.jstree-open").andSelf().each(function(){b.close_node(this)}),this.__callback({obj:a})},clean_node:function(b){b=b&&b!=-1?a(b):this.get_container(),b=b.is("li")?b.find("li").andSelf():b.find("li"),b.removeClass("jstree-last").filter("li:last-child").addClass("jstree-last").end().filter(":has(li)").not(".jstree-open").removeClass("jstree-leaf").addClass("jstree-closed"),b.not(".jstree-open, .jstree-closed").addClass("jstree-leaf").children("ul").remove(),this.__callback({obj:b})},get_rollback:function(){return this.__callback(),{i:this.get_index(),h:this.get_container().children("ul").clone(!0),d:this.data}},set_rollback:function(a,b){this.get_container().empty().append(a),this.data=b,this.__callback()},load_node:function(a,b,c){this.__callback({obj:a})},_is_loaded:function(a){return!0},create_node:function(b,c,d,e,f){b=this._get_node(b),c=typeof c=="undefined"?"last":c;var g=a("<li>"),h=this._get_settings().core,i;if(b!==-1&&!b.length)return!1;if(!f&&!this._is_loaded(b))return this.load_node(b,function(){this.create_node(b,c,d,e,!0)}),!1;this.__rollback(),typeof d=="string"&&(d={data:d}),d||(d={}),d.attr&&g.attr(d.attr),d.state&&g.addClass("jstree-"+d.state),d.data||(d.data=h.strings.new_node),a.isArray(d.data)||(i=d.data,d.data=[],d.data.push(i)),a.each(d.data,function(b,c){i=a("<a>"),a.isFunction(c)&&(c=c.call(this,d)),typeof c=="string"?i.attr("href","#")[h.html_titles?"html":"text"](c):(c.attr||(c.attr={}),c.attr.href||(c.attr.href="#"),i.attr(c.attr)[h.html_titles?"html":"text"](c.title),c.language&&i.addClass(c.language)),i.prepend("<ins class='jstree-icon'>&#160;</ins>"),c.icon&&(c.icon.indexOf("/")===-1?i.children("ins").addClass(c.icon):i.children("ins").css("background","url('"+c.icon+"') center center no-repeat")),g.append(i)}),g.prepend("<ins class='jstree-icon'>&#160;</ins>"),b===-1&&(b=this.get_container(),c==="before"&&(c="first"),c==="after"&&(c="last"));switch(c){case"before":b.before(g),i=this._get_parent(b);break;case"after":b.after(g),i=this._get_parent(b);break;case"inside":case"first":b.children("ul").length||b.append("<ul>"),b.children("ul").prepend(g),i=b;break;case"last":b.children("ul").length||b.append("<ul>"),b.children("ul").append(g),i=b;break;default:b.children("ul").length||b.append("<ul>"),c||(c=0),i=b.children("ul").children("li").eq(c),i.length?i.before(g):b.children("ul").append(g),i=b}if(i===-1||i.get(0)===this.get_container().get(0))i=-1;return this.clean_node(i),this.__callback({obj:g,parent:i}),e&&e.call(this,g),g},get_text:function(a){a=this._get_node(a);if(!a.length)return!1;var b=this._get_settings().core.html_titles;return a=a.children("a:eq(0)"),b?(a=a.clone(),a.children("INS").remove(),a.html()):(a=a.contents().filter(function(){return this.nodeType==3})[0],a.nodeValue)},set_text:function(a,b){a=this._get_node(a);if(!a.length)return!1;a=a.children("a:eq(0)");if(this._get_settings().core.html_titles){var c=a.children("INS").clone();return a.html(b).prepend(c),this.__callback({obj:a,name:b}),!0}return a=a.contents().filter(function(){return this.nodeType==3})[0],this.__callback({obj:a,name:b}),a.nodeValue=b},rename_node:function(a,b){a=this._get_node(a),this.__rollback(),a&&a.length&&this.set_text.apply(this,Array.prototype.slice.call(arguments))&&this.__callback({obj:a,name:b})},delete_node:function(a){a=this._get_node(a);if(!a.length)return!1;this.__rollback();var b=this._get_parent(a),c=this._get_prev(a);return a=a.remove(),b!==-1&&b.find("> ul > li").length===0&&b.removeClass("jstree-open jstree-closed").addClass("jstree-leaf"),this.clean_node(b),this.__callback({obj:a,prev:c}),a},prepare_move:function(b,c,d,f,g){var h={};h.ot=a.jstree._reference(h.o)||this,h.o=h.ot._get_node(b),h.r=c===-1?-1:this._get_node(c),h.p=typeof h=="undefined"?"last":d;if(!g&&e.o&&e.o[0]===h.o[0]&&e.r[0]===h.r[0]&&e.p===h.p){this.__callback(e),f&&f.call(this,e);return}h.ot=a.jstree._reference(h.o)||this,h.rt=c===-1?h.ot:a.jstree._reference(h.r)||this;if(h.r===-1){h.cr=-1;switch(h.p){case"first":case"before":case"inside":h.cp=0;break;case"after":case"last":h.cp=h.rt.get_container().find(" > ul > li").length;break;default:h.cp=h.p}}else{if(!/^(before|after)$/.test(h.p)&&!this._is_loaded(h.r))return this.load_node(h.r,function(){this.prepare_move(b,c,d,f,!0)});switch(h.p){case"before":h.cp=h.r.index(),h.cr=h.rt._get_parent(h.r);break;case"after":h.cp=h.r.index()+1,h.cr=h.rt._get_parent(h.r);break;case"inside":case"first":h.cp=0,h.cr=h.r;break;case"last":h.cp=h.r.find(" > ul > li").length,h.cr=h.r;break;default:h.cp=h.p,h.cr=h.r}}h.np=h.cr==-1?h.rt.get_container():h.cr,h.op=h.ot._get_parent(h.o),h.or=h.np.find(" > ul > li:nth-child("+(h.cp+1)+")"),e=h,this.__callback(e),f&&f.call(this,e)},check_move:function(){var a=e,b=!0;return a.or[0]===a.o[0]?!1:(a.o.each(function(){if(a.r.parentsUntil(".jstree").andSelf().filter("li").index(this)!==-1)return b=!1,!1}),b)},move_node:function(b,c,d,f,g,h){if(!g)return this.prepare_move(b,c,d,function(a){this.move_node(a,!1,!1,f,!0,h)});if(!h&&!this.check_move())return!1;this.__rollback();var i=!1;f?(i=b.o.clone(),i.find("*[id]").andSelf().each(function(){this.id&&(this.id="copy_"+this.id)})):i=b.o,b.or.length?b.or.before(i):(b.np.children("ul").length||a("<ul>").appendTo(b.np),b.np.children("ul:eq(0)").append(i));try{b.ot.clean_node
(b.op),b.rt.clean_node(b.np),b.op.find("> ul > li").length||b.op.removeClass("jstree-open jstree-closed").addClass("jstree-leaf").children("ul").remove()}catch(j){}return f&&(e.cy=!0,e.oc=i),this.__callback(e),e},_get_move:function(){return e}}})}(jQuery),function(a){a.jstree.plugin("ui",{__init:function(){this.data.ui.selected=a(),this.data.ui.last_selected=!1,this.data.ui.hovered=null,this.data.ui.to_select=this.get_settings().ui.initially_select,this.get_container().delegate("a","click.jstree",a.proxy(function(a){a.preventDefault(),this.select_node(a.currentTarget,!0,a)},this)).delegate("a","mouseenter.jstree",a.proxy(function(a){this.hover_node(a.target)},this)).delegate("a","mouseleave.jstree",a.proxy(function(a){this.dehover_node(a.target)},this)).bind("reopen.jstree",a.proxy(function(){this.reselect()},this)).bind("get_rollback.jstree",a.proxy(function(){this.dehover_node(),this.save_selected()},this)).bind("set_rollback.jstree",a.proxy(function(){this.reselect()},this)).bind("close_node.jstree",a.proxy(function(b,c){var d=this._get_settings().ui,e=this._get_node(c.rslt.obj),f=e&&e.length?e.children("ul").find(".jstree-clicked"):a(),g=this;if(d.selected_parent_close===!1||!f.length)return;f.each(function(){g.deselect_node(this),d.selected_parent_close==="select_parent"&&g.select_node(e)})},this)).bind("delete_node.jstree",a.proxy(function(a,b){var c=this._get_settings().ui.select_prev_on_delete,d=this._get_node(b.rslt.obj),e=d&&d.length?d.find(".jstree-clicked"):[],f=this;e.each(function(){f.deselect_node(this)}),c&&e.length&&this.select_node(b.rslt.prev)},this)).bind("move_node.jstree",a.proxy(function(a,b){b.rslt.cy&&b.rslt.oc.find(".jstree-clicked").removeClass("jstree-clicked")},this))},defaults:{select_limit:-1,select_multiple_modifier:"ctrl",selected_parent_close:"select_parent",select_prev_on_delete:!0,disable_selecting_children:!1,initially_select:[]},_fn:{_get_node:function(b,c){if(typeof b=="undefined"||b===null)return c?this.data.ui.selected:this.data.ui.last_selected;var d=a(b,this.get_container());return d.is(".jstree")||b==-1?-1:(d=d.closest("li",this.get_container()),d.length?d:!1)},save_selected:function(){var a=this;this.data.ui.to_select=[],this.data.ui.selected.each(function(){a.data.ui.to_select.push("#"+this.id.toString().replace(/^#/,"").replace("\\/","/").replace("/","\\/"))}),this.__callback(this.data.ui.to_select)},reselect:function(){var b=this,c=this.data.ui.to_select;c=a.map(a.makeArray(c),function(a){return"#"+a.toString().replace(/^#/,"").replace("\\/","/").replace("/","\\/")}),this.deselect_all(),a.each(c,function(a,c){c&&c!=="#"&&b.select_node(c)}),this.__callback()},refresh:function(a){return this.save_selected(),this.__call_old()},hover_node:function(a){a=this._get_node(a);if(!a.length)return!1;a.hasClass("jstree-hovered")||this.dehover_node(),this.data.ui.hovered=a.children("a").addClass("jstree-hovered").parent(),this.__callback({obj:a})},dehover_node:function(){var a=this.data.ui.hovered,b;if(!a||!a.length)return!1;b=a.children("a").removeClass("jstree-hovered").parent(),this.data.ui.hovered[0]===b[0]&&(this.data.ui.hovered=null),this.__callback({obj:a})},select_node:function(a,b,c){a=this._get_node(a);if(a==-1||!a||!a.length)return!1;var d=this._get_settings().ui,e=d.select_multiple_modifier=="on"||d.select_multiple_modifier!==!1&&c&&c[d.select_multiple_modifier+"Key"],f=this.is_selected(a),g=!0;if(b){if(d.disable_selecting_children&&e&&a.parents("li",this.get_container()).children(".jstree-clicked").length)return!1;g=!1;switch(!0){case f&&!e:this.deselect_all(),f=!1,g=!0;break;case!f&&!e:if(d.select_limit==-1||d.select_limit>0)this.deselect_all(),g=!0;break;case f&&e:this.deselect_node(a);break;case!f&&e:if(d.select_limit==-1||this.data.ui.selected.length+1<=d.select_limit)g=!0}}g&&!f&&(a.children("a").addClass("jstree-clicked"),this.data.ui.selected=this.data.ui.selected.add(a),this.data.ui.last_selected=a,this.__callback({obj:a}))},deselect_node:function(a){a=this._get_node(a);if(!a.length)return!1;this.is_selected(a)&&(a.children("a").removeClass("jstree-clicked"),this.data.ui.selected=this.data.ui.selected.not(a),this.data.ui.last_selected.get(0)===a.get(0)&&(this.data.ui.last_selected=this.data.ui.selected.eq(0)),this.__callback({obj:a}))},toggle_select:function(a){a=this._get_node(a);if(!a.length)return!1;this.is_selected(a)?this.deselect_node(a):this.select_node(a)},is_selected:function(a){return this.data.ui.selected.index(this._get_node(a))>=0},get_selected:function(b){return b?a(b).find(".jstree-clicked").parent():this.data.ui.selected},deselect_all:function(b){b?a(b).find(".jstree-clicked").removeClass("jstree-clicked"):this.get_container().find(".jstree-clicked").removeClass("jstree-clicked"),this.data.ui.selected=a([]),this.data.ui.last_selected=!1,this.__callback()}}}),a.jstree.defaults.plugins.push("ui")}(jQuery),function(a){a.jstree.plugin("crrm",{__init:function(){this.get_container().bind("move_node.jstree",a.proxy(function(a,b){if(this._get_settings().crrm.move.open_onmove){var c=this;b.rslt.np.parentsUntil(".jstree").andSelf().filter(".jstree-closed").each(function(){c.open_node(this,!1,!0)})}},this))},defaults:{input_width_limit:200,move:{always_copy:!1,open_onmove:!0,default_position:"last",check_move:function(a){return!0}}},_fn:{_show_input:function(b,c){b=this._get_node(b);var d=this._get_settings().core.rtl,e=this._get_settings().crrm.input_width_limit,f=b.children("ins").width(),g=b.find("> a:visible > ins").width()*b.find("> a:visible > ins").length,h=this.get_text(b),i=a("<div>",{css:{position:"absolute",top:"-200px",left:d?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),j=b.css("position","relative").append(a("<input>",{value:h,css:{padding:"0",border:"1px solid silver",position:"absolute",left:d?"auto":f+g+4+"px",right:d?f+g+4+"px":"auto",top:"0px",height:this.data.core.li_height-2+"px",lineHeight:this.data.core.li_height-2+"px",width:"150px"},blur:a.proxy(function(){var a=b.children("input"),d=a.val();d===""&&(d=h),a.remove(),this.set_text(b,h),this.rename_node(b,d),c.call(this,b,d,h),b.css("position","")},this),keyup:function(a){var b=a.keyCode||a.which;if(b==27){this.value=h,this.blur();return}if(b==13){this.blur();return}j.width(Math.min(i.text("pW"+this.value).width(),e))}})).children("input");this.set_text(b,""),i.css({fontFamily:j.css("fontFamily")||"",fontSize:j.css("fontSize")||"",fontWeight:j.css("fontWeight")||"",fontStyle:j.css("fontStyle")||"",fontStretch:j.css("fontStretch")||"",fontVariant:j.css("fontVariant")||"",letterSpacing:j.css("letterSpacing")||"",wordSpacing:j.css("wordSpacing")||""}),j.width(Math.min(i.text("pW"+j[0].value).width(),e))[0].select()},rename:function(a){a=this._get_node(a),this.__rollback();var b=this.__callback;this._show_input(a,function(a,c,d){b.call(this,{obj:a,new_name:c,old_name:d})})},create:function(b,c,d,e,f){var g,h=this;return b=this._get_node(b),b||(b=-1),this.__rollback(),g=this.create_node(b,c,d,function(b){var c=this._get_parent(b),d=a(b).index();e&&e.call(this,b),c.length&&c.hasClass("jstree-closed")&&this.open_node(c,!1,!0),f?h.__callback({obj:b,name:this.get_text(b),parent:c,position:d}):this._show_input(b,function(a,b,e){h.__callback({obj:a,name:b,parent:c,position:d})})}),g},remove:function(a){a=this._get_node(a,!0),this.__rollback(),this.delete_node(a),this.__callback({obj:a})},check_move:function(){if(!this.__call_old())return!1;var a=this._get_settings().crrm.move;return a.check_move.call(this,this._get_move())?!0:!1},move_node:function(a,b,c,d,e,f){var g=this._get_settings().crrm.move;if(!e)return c||(c=g.default_position),c==="inside"&&!g.default_position.match(/^(before|after)$/)&&(c=g.default_position),this.__call_old(!0,a,b,c,d,!1,f);if(g.always_copy===!0||g.always_copy==="multitree"&&a.rt.get_index()!==a.ot.get_index())d=!0;this.__call_old(!0,a,b,c,d,!0,f)},cut:function(a){a=this._get_node(a),this.data.crrm.cp_nodes=!1,this.data.crrm.ct_nodes=!1;if(!a||!a.length)return!1;this.data.crrm.ct_nodes=a},copy:function(a){a=this._get_node(a),this.data.crrm.cp_nodes=!1,this.data.crrm.ct_nodes=!1;if(!a||!a.length)return!1;this.data.crrm.cp_nodes=a},paste:function(a){a=this._get_node(a);if(!a||!a.length)return!1;if(!this.data.crrm.ct_nodes&&!this.data.crrm.cp_nodes)return!1;this.data.crrm.ct_nodes&&this.move_node(this.data.crrm.ct_nodes,a),this.data.crrm.cp_nodes&&this.move_node(this.data.crrm.cp_nodes,a,!1,!0),this.data.crrm.cp_nodes=!1,this.data.crrm.ct_nodes=!1}}}),a.jstree.defaults.plugins.push("crrm")}(jQuery),function(a){var b=[];a.jstree._themes=!1,a.jstree.plugin("themes",{__init:function(){this.get_container().bind("init.jstree",a.proxy(function(){var a=this._get_settings().themes;this.data.themes.dots=a.dots,this.data.themes.icons=a.icons,this.set_theme(a.theme,a.url)},this)).bind("loaded.jstree",a.proxy(function(){this.data.themes.dots?this.show_dots():this.hide_dots(),this.data.themes.icons?this.show_icons():this.hide_icons()},this))},defaults:{theme:"default",url:!1,dots:!0,icons:!0},_fn:{set_theme:function(c,d){if(!c)return!1;d||(d=a.jstree._themes+c+"/style.css"),a.inArray(d,b)==-1&&(a.vakata.css.add_sheet({url:d,rel:"jstree"}),b.push(d)),this.data.themes.theme!=c&&(this.get_container().removeClass("jstree-"+this.data.themes.theme),this.data.themes.theme=c),this.get_container().addClass("jstree-"+c),this.data.themes.dots?this.show_dots():this.hide_dots(),this.data.themes.icons?this.show_icons():this.hide_icons(),this.__callback()},get_theme:function(){return this.data.themes.theme},show_dots:function(){this.data.themes.dots=!0,this.get_container().children("ul").removeClass("jstree-no-dots")},hide_dots:function(){this.data.themes.dots=!1,this.get_container().children("ul").addClass("jstree-no-dots")},toggle_dots:function(){this.data.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this.data.themes.icons=!0,this.get_container().children("ul").removeClass("jstree-no-icons")},hide_icons:function(){this.data.themes.icons=!1,this.get_container().children("ul").addClass("jstree-no-icons")},toggle_icons:function(){this.data.themes.icons?this.hide_icons():this.show_icons()}}}),a(function(){a.jstree._themes===!1&&a("script").each(function(){if(this.src.toString().match(/jquery\.jstree[^\/]*?\.js(\?.*)?$/))return a.jstree._themes=this.src.toString().replace(/jquery\.jstree[^\/]*?\.js(\?.*)?$/,"")+"themes/",!1}),a.jstree._themes===!1&&(a.jstree._themes="themes/")}),a.jstree.defaults.plugins.push("themes")}(jQuery),function(a){function c(b,c){var d=a.jstree._focused(),e;if(d&&d.data&&d.data.hotkeys&&d.data.hotkeys.enabled){e=d._get_settings().hotkeys[b];if(e)return e.call(d,c)}}var b=[];a.jstree.plugin("hotkeys",{__init:function(){if(typeof a.hotkeys=="undefined")throw"jsTree hotkeys: jQuery hotkeys plugin not included.";if(!this.data.ui)throw"jsTree hotkeys: jsTree UI plugin not included.";a.each(this._get_settings().hotkeys,function(d,e){a.inArray(d,b)==-1&&(a(document).bind("keydown",d,function(a){return c(d,a)}),b.push(d))}),this.enable_hotkeys()},defaults:{up:function(){var a=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_prev(a)),!1},down:function(){var a=this.data.ui.hovered||this.data.ui.last_selected||-1;return this.hover_node(this._get_next(a)),!1},left:function(){var a=this.data.ui.hovered||this.data.ui.last_selected;return a&&(a.hasClass("jstree-open")?this.close_node(a):this.hover_node(this._get_prev(a))),!1},right:function(){var a=this.data.ui.hovered||this.data.ui.last_selected;return a&&a.length&&(a.hasClass("jstree-closed")?this.open_node(a):this.hover_node(this._get_next(a))),!1},space:function(){return this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").click(),!1},"ctrl+space":function(a){return a.type="click",this.data.ui.hovered&&this.data.ui.hovered.children("a:eq(0)").trigger(a),!1},f2:function(){this.rename(this.data.ui.hovered||this.data.ui.last_selected)},del:function(){this.remove(this.data.ui.hovered||this._get_node(null))}},_fn:{enable_hotkeys:function(){this.data.hotkeys.enabled=!0},disable_hotkeys:function(){this.data.hotkeys.enabled=!1}}})}(jQuery),function(a){a.jstree.plugin("json_data",{defaults:{data:!1,ajax:!1,correct_state:!0,progressive_render:!1},_fn:{load_node:function(a,b,c){var d=this;this.load_node_json(a,function(){d.__callback({obj:a}),b.call(this)},c)},_is_loaded:function(b){var c=this._get_settings().json_data,d;return b=this._get_node(b),b&&b!==-1&&c.progressive_render&&!b.is(".jstree-open, .jstree-leaf")&&b.children("ul").children("li").length===0&&b.data("jstree-children")?(d=this._parse_json(b.data("jstree-children")),d&&(b.append(d),a.removeData(b,"jstree-children")),this.clean_node(b),!0):b==-1||!b||!c.ajax||b.is(".jstree-open, .jstree-leaf")||b.children("ul").children("li").size()>0},load_node_json:function(b,c,d){var e=this.get_settings().json_data,f,g=function(){},h=function(){};b=this._get_node(b);if(b&&b!==-1){if(b.data("jstree-is-loading"))return;b.data("jstree-is-loading",!0)}switch(!0){case!e.data&&!e.ajax:throw"Neither data nor ajax settings supplied.";case!!e.data&&!e.ajax||!!e.data&&!!e.ajax&&(!b||b===-1):if(!b||b==-1)f=this._parse_json(e.data),f?(this.get_container().children("ul").empty().append(f.children()),this.clean_node()):e.correct_state&&this.get_container().children("ul").empty();c&&c.call(this);break;case!e.data&&!!e.ajax||!!e.data&&!!e.ajax&&b&&b!==-1:g=function(a,c,f){var g=this.get_settings().json_data.ajax.error;g&&g.call(this,a,c,f),b!=-1&&b.length?(b.children(".jstree-loading").removeClass("jstree-loading"),b.data("jstree-is-loading",!1),c==="success"&&e.correct_state&&b.removeClass("jstree-open jstree-closed").addClass("jstree-leaf")):c==="success"&&e.correct_state&&this.get_container().children("ul").empty(),d&&d.call(this)},h=function(d,f,h){var i=this.get_settings().json_data.ajax.success;i&&(d=i.call(this,d,f,h)||d);if(d===""||!a.isArray(d)&&!a.isPlainObject(d))return g.call(this,h,f,"");d=this._parse_json(d),d?(b===-1||!b?this.get_container().children("ul").empty().append(d.children()):(b.append(d).children(".jstree-loading").removeClass("jstree-loading"),b.data("jstree-is-loading",!1)),this.clean_node(b),c&&c.call(this)):b===-1||!b?e.correct_state&&(this.get_container().children("ul").empty(),c&&c.call(this)):(b.children(".jstree-loading").removeClass("jstree-loading"),b.data("jstree-is-loading",!1),e.correct_state&&(b.removeClass("jstree-open jstree-closed").addClass("jstree-leaf"),c&&c.call(this)))},e.ajax.context=this,e.ajax.error=g,e.ajax.success=h,e.ajax.dataType||(e.ajax.dataType="json"),a.isFunction(e.ajax.url)&&(e.ajax.url=e.ajax.url.call(this,b)),a.isFunction(e.ajax.data)&&(e.ajax.data=e.ajax.data.call(this,b)),a.ajax(e.ajax)}},_parse_json:function(b,c){var d=!1,e=this._get_settings(),f=e.json_data,g=e.core.html_titles,h,i,j,k,l;if(!b)return d;a.isFunction(b)&&(b=b.call(this));if(a.isArray(b)){d=a();if(!b.length)return!1;for(i=0,j=b.length;i<j;i++)h=this._parse_json(b[i],!0),h.length&&(d=d.add(h))}else{typeof b=="string"&&(b={data:b});if(!b.data&&b.data!=="")return d;d=a("<li>"),b.attr&&d.attr(b.attr),b.metadata&&d.data("jstree",b.metadata),b.state&&d.addClass("jstree-"+b.state),a.isArray(b.data)||(h=b.data,b.data=[],b.data.push(h)),a.each(b.data,function(c,e){h=a("<a>"),a.isFunction(e)&&(e=e.call(this,b)),typeof e=="string"?h.attr("href","#")[g?"html":"text"](e):(e.attr||(e.attr={}),e.attr.href||(e.attr.href="#"),h.attr(e.attr)[g?"html":"text"](e.title),e.language&&h.addClass(e.language)),h.prepend("<ins class='jstree-icon'>&#160;</ins>"),!e.icon&&b.icon&&(e.icon=b.icon),e.icon&&(e.icon.indexOf("/")===-1?h.children("ins").addClass(e.icon):h.children("ins").css("background","url('"+e.icon+"') center center no-repeat")),d.append(h)}),d.prepend("<ins class='jstree-icon'>&#160;</ins>"),b.children&&(f.progressive_render&&b.state!=="open"?d.addClass("jstree-closed").data("jstree-children",b.children):(a.isFunction(b.children)&&(b.children=b.children.call(this,b)),a.isArray(b.children)&&b.children.length&&(h=this._parse_json(b.children,!0),h.length&&(l=a("<ul>"),l.append(h),d.append(l)))))}return c||(k=a("<ul>"),k.append(d),d=k),d},get_json:function(b,c,d,e){var f=[],g=this._get_settings(),h=this,i,j,k,l,m,n;b=this._get_node(b);if(!b||b===-1)b=this.get_container().find("> ul > li");return c=a.isArray(c)?c:["id","class"],!e&&this.data.types&&c.push(g.types.type_attr),d=a.isArray(d)?d:[],b.each(function(){k=a(this),i={data:[]},c.length&&(i.attr={}),a.each(c,function(a,b){j=k.attr(b),j&&j.length&&j.replace(/jstree[^ ]*|$/ig,"").length&&(i.attr[b]=j.replace(/jstree[^ ]*|$/ig,""))}),k.hasClass("jstree-open")&&(i.state="open"),k.hasClass("jstree-closed")&&(i.state="closed"),l=k.children("a"),l.each(function(){m=a(this),d.length||a.inArray("languages",g.plugins)!==-1||m.children("ins").get(0).style.backgroundImage.length||m.children("ins").get(0).className&&m.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").length?(n=!1,a.inArray("languages",g.plugins)!==-1&&a.isArray(g.languages)&&g.languages.length&&a.each(g.languages,function(a,b){if(m.hasClass(b))return n=b,!1}),j={attr:{},title:h.get_text(m,n)},a.each(d,function(a,b){i.attr[b]=(m.attr(b)||"").replace(/jstree[^ ]*|$/ig,"")}),a.each(g.languages,function(a,b){if(m.hasClass(b))return j.language=b,!0}),m.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length&&(j.icon=m.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"")),m.children("ins").get(0).style.backgroundImage.length&&(j.icon=m.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")",""))):j=h.get_text(m),l.length>1?i.data.push(j):i.data=j}),k=k.find("> ul > li"),k.length&&(i.children=h.get_json(k,c,d,!0)),f.push(i)}),f}}})}(jQuery),function(a){a.jstree.plugin("languages",{__init:function(){this._load_css()},defaults:[],_fn:{set_lang:function(b){var c=this._get_settings().languages,d=!1,e=".jstree-"+this.get_index()+" a";if(!a.isArray(c)||c.length===0)return!1;if(a.inArray(b,c)==-1){if(!c[b])return!1;b=c[b]}return b==this.data.languages.current_language?!0:(d=a.vakata.css.get_css(e+"."+this.data.languages.current_language,!1,this.data.languages.language_css),d!==!1&&(d.style.display="none"),d=a.vakata.css.get_css(e+"."+b,!1,this.data.languages.language_css),d!==!1&&(d.style.display=""),this.data.languages.current_language=b,this.__callback(b),!0)},get_lang:function(){return this.data.languages.current_language},get_text:function(b,c){b=this._get_node(b)||this.data.ui.last_selected;if(!b.size())return!1;var d=this._get_settings().languages,e=this._get_settings().core.html_titles;return a.isArray(d)&&d.length?(c=c&&a.inArray(c,d)!=-1?c:this.data.languages.current_language,b=b.children("a."+c)):b=b.children("a:eq(0)"),e?(b=b.clone(),b.children("INS").remove(),b.html()):(b=b.contents().filter(function(){return this.nodeType==3})[0],b.nodeValue)},set_text:function(b,c,d){b=this._get_node(b)||this.data.ui.last_selected;if(!b.size())return!1;var e=this._get_settings().languages,f=this._get_settings().core.html_titles,g;return a.isArray(e)&&e.length?(d=d&&a.inArray(d,e)!=-1?d:this.data.languages.current_language,b=b.children("a."+d)):b=b.children("a:eq(0)"),f?(g=b.children("INS").clone(),b.html(c).prepend(g),this.__callback({obj:b,name:c,lang:d}),!0):(b=b.contents().filter(function(){return this.nodeType==3})[0],this.__callback({obj:b,name:c,lang:d}),b.nodeValue=c)},_load_css:function(){var b=this._get_settings().languages,c="/* languages css */",d=".jstree-"+this.get_index()+" a",e;if(a.isArray(b)&&b.length){this.data.languages.current_language=b[0];for(e=0;e<b.length;e++)c+=d+"."+b[e]+" {",b[e]!=this.data.languages.current_language&&(c+=" display:none; "),c+=" } ";this.data.languages.language_css=a.vakata.css.add_sheet({str:c})}},create_node:function(b,c,d,e){var f=this.__call_old(!0,b,c,d,function(b){var c=this._get_settings().languages,d=b.children("a"),f;if(a.isArray(c)&&c.length){for(f=0;f<c.length;f++)d.is("."+c[f])||b.append(d.eq(0).clone().removeClass(c.join(" ")).addClass(c[f]));d.not("."+c.join(", .")).remove()}e&&e.call(this,b)});return f}}})}(jQuery),function(a){a.jstree.plugin("cookies",{__init:function(){if(typeof a.cookie=="undefined")throw"jsTree cookie: jQuery cookie plugin not included.";var b=this._get_settings().cookies,c;!b.save_opened||(c=a.cookie(b.save_opened),c&&c.length&&(this.data.core.to_open=c.split(","))),!b.save_selected||(c=a.cookie(b.save_selected),c&&c.length&&this.data.ui&&(this.data.ui.to_select=c.split(","))),this.get_container().one((this.data.ui?"reselect":"reopen")+".jstree",a.proxy(function(){this.get_container().bind("open_node.jstree close_node.jstree select_node.jstree deselect_node.jstree",a.proxy(function(a){this._get_settings().cookies.auto_save&&this.save_cookie((a.handleObj.namespace+a.handleObj.type).replace("jstree",""))},this))},this))},defaults:{save_opened:"jstree_open",save_selected:"jstree_select",auto_save:!0,cookie_options:{}},_fn:{save_cookie:function(b){if(this.data.core.refreshing)return;var c=this._get_settings().cookies;if(!b){c.save_opened&&(this.save_opened(),a.cookie(c.save_opened,this.data.core.to_open.join(","),c.cookie_options)),c.save_selected&&this.data.ui&&(this.save_selected(),a.cookie(c.save_selected,this.data.ui.to_select.join(","),c.cookie_options));return}switch(b){case"open_node":case"close_node":!c.save_opened||(this.save_opened(),a.cookie(c.save_opened,this.data.core.to_open.join(","),c.cookie_options));break;case"select_node":case"deselect_node":!!c.save_selected&&this.data.ui&&(this.save_selected(),a.cookie(c.save_selected,this.data.ui.to_select.join(","),c.cookie_options))}}}}),a.jstree.defaults.plugins.push("cookies")}(jQuery),function(a){a.jstree.plugin("sort",{__init:function(){this.get_container().bind("load_node.jstree",a.proxy(function(a,b){var c=this._get_node(b.rslt.obj);c=c===-1?this.get_container().children("ul"):c.children("ul"),this.sort(c)},this)).bind("rename_node.jstree",a.proxy(function(a,b){this.sort(b.rslt.obj.parent())},this)).bind("move_node.jstree",a.proxy(function(a,b){var c=b.rslt.np==-1?this.get_container():b.rslt.np;this.sort(c.children("ul"))},this))},defaults:function(a,b){return this.get_text(a)>this.get_text(b)?1:-1},_fn:{sort:function(b){var c=this._get_settings().sort,d=this;b.append(a.makeArray(b.children("li")).sort(a.proxy(c,d))),b.find("> li > ul").each(function(){d.sort(a(this))}),this.clean_node(b)}}})}(jQuery),function(a){var b=!1,c=!1,d=!1,e=!1,f=!1,g=!1,h=!1;a.vakata.dnd={is_down:!1,is_drag:!1,helper:!1,scroll_spd:10,init_x:0,init_y:0,threshold:5,user_data:{},drag_start:function(b,c,d){a.vakata.dnd.is_drag&&a.vakata.drag_stop({});try{b.currentTarget.unselectable="on",b.currentTarget.onselectstart=function(){return!1},b.currentTarget.style&&(b.currentTarget.style.MozUserSelect="none")}catch(e){}return a.vakata.dnd.init_x=b.pageX,a.vakata.dnd.init_y=b.pageY,a.vakata.dnd.user_data=c,a.vakata.dnd.is_down=!0,a.vakata.dnd.helper=a("<div id='vakata-dragged'>").html(d).css("opacity","0.75"),a(document).bind("mousemove",a.vakata.dnd.drag),a(document).bind("mouseup",a.vakata.dnd.drag_stop),!1},drag:function(b){if(!a.vakata.dnd.is_down)return;if(!a.vakata.dnd.is_drag)if(Math.abs(b.pageX-a.vakata.dnd.init_x)>5||Math.abs(b.pageY-a.vakata.dnd.init_y)>5)a.vakata.dnd.helper.appendTo("body"),a.vakata.dnd.is_drag=!0,a(document).triggerHandler("drag_start.vakata",{event:b,data:a.vakata.dnd.user_data});else return;if(b.type==="mousemove"){var c=a(document),d=c.scrollTop(),i=c.scrollLeft();b.pageY-d<20?(f&&g==="down"&&(clearInterval(f),f=!1),f||(g="up",f=setInterval(function(){a(document).scrollTop(a(document).scrollTop()-a.vakata.dnd.scroll_spd)},150))):f&&g==="up"&&(clearInterval(f),f=!1),a(window).height()-(b.pageY-d)<20?(f&&g==="up"&&(clearInterval(f),f=!1),f||(g="down",f=setInterval(function(){a(document).scrollTop(a(document).scrollTop()+a.vakata.dnd.scroll_spd)},150))):f&&g==="down"&&(clearInterval(f),f=!1),b.pageX-i<20?(e&&h==="right"&&(clearInterval(e),e=!1),e||(h="left",e=setInterval(function(){a(document).scrollLeft(a(document).scrollLeft()-a.vakata.dnd.scroll_spd)},150))):e&&h==="left"&&(clearInterval(e),e=!1),a(window).width()-(b.pageX-i)<20?(e&&h==="left"&&(clearInterval(e),e=!1),e||(h="right",e=setInterval(function(){a(document).scrollLeft(a(document).scrollLeft()+a.vakata.dnd.scroll_spd)},150))):e&&h==="right"&&(clearInterval(e),e=!1)}a.vakata.dnd.helper.css({left:b.pageX+5+"px",top:b.pageY+10+"px"}),a(document).triggerHandler("drag.vakata",{event:b,data:a.vakata.dnd.user_data})},drag_stop:function(b){a(document).unbind("mousemove",a.vakata.dnd.drag),a(document).unbind("mouseup",a.vakata.dnd.drag_stop),a(document).triggerHandler("drag_stop.vakata",{event:b,data:a.vakata.dnd.user_data}),a.vakata.dnd.helper.remove(),a.vakata.dnd.init_x=0,a.vakata.dnd.init_y=0,a.vakata.dnd.user_data={},a.vakata.dnd.is_down=!1,a.vakata.dnd.is_drag=!1}},a(function(){var b="#vakata-dragged { display:block; margin:0 0 0 0; padding:4px 4px 4px 24px; position:absolute; top:-2000px; line-height:16px; z-index:10000; } ";a.vakata.css.add_sheet({str:b})}),a.jstree.plugin("dnd",{__init:function(){this.data.dnd={active:!1,after:!1,inside:!1,before:!1,off:!1,prepared:!1,w:0,to1:!1,to2:!1,cof:!1,cw:!1,ch:!1,i1:!1,i2:!1},this.get_container().bind("mouseenter.jstree",a.proxy(function(){a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&this.data.themes&&(d.attr("class","jstree-"+this.data.themes.theme),a.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme))},this)).bind("mouseleave.jstree",a.proxy(function(){a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i2&&clearInterval(this.data.dnd.i2))},this)).bind("mousemove.jstree",a.proxy(function(b){if(a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree){var c=this.get_container()[0];b.pageX+24>this.data.dnd.cof.left+this.data.dnd.cw?(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i1=setInterval(a.proxy(function(){this.scrollLeft+=a.vakata.dnd.scroll_spd},c),100)):b.pageX-24<this.data.dnd.cof.left?(this.data.dnd.i1&&clearInterval(this.data.dnd.i1),this.data.dnd.i1=setInterval(a.proxy(function(){this.scrollLeft-=a.vakata.dnd.scroll_spd},c),100)):this.data.dnd.i1&&clearInterval(this.data.dnd.i1),b.pageY+24>this.data.dnd.cof.top+this.data.dnd.ch?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval(a.proxy(function(){this.scrollTop+=a.vakata.dnd.scroll_spd},c),100)):b.pageY-24<this.data.dnd.cof.top?(this.data.dnd.i2&&clearInterval(this.data.dnd.i2),this.data.dnd.i2=setInterval(a.proxy(function(){this.scrollTop-=a.vakata.dnd.scroll_spd},c),100)):this.data.dnd.i2&&clearInterval(this.data.dnd.i2)}},this)).delegate("a","mousedown.jstree",a.proxy(function(a){if(a.which===1)return this.start_drag(a.currentTarget,a),!1},this)).delegate("a","mouseenter.jstree",a.proxy(function(b){a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&this.dnd_enter(b.currentTarget)},this)).delegate("a","mousemove.jstree",a.proxy(function(b){a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&(typeof this.data.dnd.off.top=="undefined"&&(this.data.dnd.off=a(b.target).offset()),this.data.dnd.w=(b.pageY-(this.data.dnd.off.top||0))%this.data.core.li_height,this.data.dnd.w<0&&(this.data.dnd.w+=this.data.core.li_height),this.dnd_show())},this)).delegate("a","mouseleave.jstree",a.proxy(function(b){a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&(this.data.dnd.after=!1,this.data.dnd.before=!1,this.data.dnd.inside=!1,a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid"),d.hide(),c&&c[0]===b.target.parentNode&&(this.data.dnd.to1&&(clearTimeout(this.data.dnd.to1),this.data.dnd.to1=!1),this.data.dnd.to2&&(clearTimeout(this.data.dnd.to2),this.data.dnd.to2=!1)))},this)).delegate("a","mouseup.jstree",a.proxy(function(b){a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&this.dnd_finish(b)},this)),a(document).bind("drag_stop.vakata",a.proxy(function(){this.data.dnd.after=!1,this.data.dnd.before=!1,this.data.dnd.inside=!1,this.data.dnd.off=!1,this.data.dnd.prepared=!1,this.data.dnd.w=!1,this.data.dnd.to1=!1,this.data.dnd.to2=!1,this.data.dnd.active=!1,this.data.dnd.foreign=!1,d&&d.css({top:"-2000px"})},this)).bind("drag_start.vakata",a.proxy(function(b,c){if(c.data.jstree){var d=a(c.event.target);d.closest(".jstree").hasClass("jstree-"+this.get_index())&&this.dnd_enter(d)}},this));var e=this._get_settings().dnd;e.drag_target&&a(document).delegate(e.drag_target,"mousedown.jstree",a.proxy(function(c){b=c.target,a.vakata.dnd.drag_start(c,{jstree:!0,obj:c.target},"<ins class='jstree-icon'></ins>"+a(c.target).text()),this.data.themes&&(d.attr("class","jstree-"+this.data.themes.theme),a.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)),a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");var e=this.get_container();return this.data.dnd.cof=e.offset(),this.data.dnd.cw=parseInt(e.width(),10),this.data.dnd.ch=parseInt(e.height(),10),this.data.dnd.foreign=!0,!1},this)),e.drop_target&&a(document).delegate(e.drop_target,"mouseenter.jstree",a.proxy(function(c){this.data.dnd.active&&this._get_settings().dnd.drop_check.call(this,{o:b,r:a(c.target)})&&a.vakata.dnd.helper.children("ins").attr("class","jstree-ok")},this)).delegate(e.drop_target,"mouseleave.jstree",a.proxy(function(b){this.data.dnd.active&&a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")},this)).delegate(e.drop_target,"mouseup.jstree",a.proxy(function(c){this.data.dnd.active&&a.vakata.dnd.helper.children("ins").hasClass("jstree-ok")&&this._get_settings().dnd.drop_finish.call(this,{o:b,r:a(c.target)})},this))},defaults:{copy_modifier:"ctrl",check_timeout:200,open_timeout:500,drop_target:".jstree-drop",drop_check:function(a){return!0},drop_finish:a.noop,drag_target:".jstree-draggable",drag_finish:a.noop,drag_check:function(a){return{after:!1,before:!1,inside:!0}}},_fn:{dnd_prepare:function(){if(!c||!c.length)return;this.data.dnd.off=c.offset(),this._get_settings().core.rtl&&(this.data.dnd.off.right=this.data.dnd.off.left+c.width());if(this.data.dnd.foreign){var a=this._get_settings().dnd.drag_check.call(this,{o:b,r:c});return this.data.dnd.after=a.after,this.data.dnd.before=a.before,this.data.dnd.inside=a.inside,this.data.dnd.prepared=!0,this.dnd_show()}return this.prepare_move(b,c,"before"),this.data.dnd.before=this.check_move(),this.prepare_move(b,c,"after"),this.data.dnd.after=this.check_move(),this._is_loaded(c)?(this.prepare_move(b,c,"inside"),this.data.dnd.inside=this.check_move()):this.data.dnd.inside=!1,this.data.dnd.prepared=!0,this.dnd_show()},dnd_show:function(){if(!this.data.dnd.prepared)return;var b=["before","inside","after"],c=!1,e=this._get_settings().core.rtl,f;this.data.dnd.w<this.data.core.li_height/3?b=["before","inside","after"]:this.data.dnd.w<=this.data.core.li_height*2/3?b=this.data.dnd.w<this.data.core.li_height/2?["inside","before","after"]:["inside","after","before"]:b=["after","inside","before"],a.each(b,a.proxy(function(b,d){if(this.data.dnd[d])return a.vakata.dnd.helper.children("ins").attr("class","jstree-ok"),c=d,!1},this)),c===!1&&a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid"),f=e?this.data.dnd.off.right-18:this.data.dnd.off.left+10;switch(c){case"before":d.css({left:f+"px",top:this.data.dnd.off.top-6+"px"}).show();break;case"after":d.css({left:f+"px",top:this.data.dnd.off.top+this.data.core.li_height-7+"px"}).show();break;case"inside":d.css({left:f+(e?-4:4)+"px",top:this.data.dnd.off.top+this.data.core.li_height/2-5+"px"}).show();break;default:d.hide()}return c},dnd_open:function(){this.data.dnd.to2=!1,this.open_node(c,a.proxy(this.dnd_prepare,this),!0)},dnd_finish:function(a){this.data.dnd.foreign?(this.data.dnd.after||this.data.dnd.before||this.data.dnd.inside)&&this._get_settings().dnd.drag_finish.call(this,{o:b,r:c}):(this.dnd_prepare(),this.move_node(b,c,this.dnd_show(),a[this._get_settings().dnd.copy_modifier+"Key"])),b=!1,c=!1,d.hide()},dnd_enter:function(b){var d=this._get_settings().dnd;this.data.dnd.prepared=!1,c=this._get_node(b),d.check_timeout?(this.data.dnd.to1&&clearTimeout(this.data.dnd.to1),this.data.dnd.to1=setTimeout(a.proxy(this.dnd_prepare,this),d.check_timeout)):this.dnd_prepare(),d.open_timeout?(this.data.dnd.to2&&clearTimeout(this.data.dnd.to2),c&&c.length&&c.hasClass("jstree-closed")&&(this.data.dnd.to2=setTimeout(a.proxy(this.dnd_open,this),d.open_timeout))):c&&c.length&&c.hasClass("jstree-closed")&&this.dnd_open()},start_drag:function(c,e){b=this._get_node(c),this.data.ui&&this.is_selected(b)&&(b=this._get_node(null,!0)),a.vakata.dnd.drag_start(e,{jstree:!0,obj:b},"<ins class='jstree-icon'></ins>"+(b.length>1?"Multiple selection"
:this.get_text(b))),this.data.themes&&(d.attr("class","jstree-"+this.data.themes.theme),a.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme));var f=this.get_container();this.data.dnd.cof=f.children("ul").offset(),this.data.dnd.cw=parseInt(f.width(),10),this.data.dnd.ch=parseInt(f.height(),10),this.data.dnd.active=!0}}}),a(function(){var b="#vakata-dragged ins { display:block; text-decoration:none; width:16px; height:16px; margin:0 0 0 0; padding:0; position:absolute; top:4px; left:4px; } #vakata-dragged .jstree-ok { background:green; } #vakata-dragged .jstree-invalid { background:red; } #jstree-marker { padding:0; margin:0; line-height:12px; font-size:1px; overflow:hidden; height:12px; width:8px; position:absolute; top:-30px; z-index:10000; background-repeat:no-repeat; display:none; background-color:silver; } ";a.vakata.css.add_sheet({str:b}),d=a("<div>").attr({id:"jstree-marker"}).hide().appendTo("body"),a(document).bind("drag_start.vakata",function(a,b){b.data.jstree&&d.show()}),a(document).bind("drag_stop.vakata",function(a,b){b.data.jstree&&d.hide()})})}(jQuery),function(a){a.jstree.plugin("checkbox",{__init:function(){this.select_node=this.deselect_node=this.deselect_all=a.noop,this.get_selected=this.get_checked,this.get_container().bind("open_node.jstree create_node.jstree clean_node.jstree",a.proxy(function(a,b){this._prepare_checkboxes(b.rslt.obj)},this)).bind("loaded.jstree",a.proxy(function(a){this._prepare_checkboxes()},this)).delegate("a","click.jstree",a.proxy(function(a){this._get_node(a.target).hasClass("jstree-checked")?this.uncheck_node(a.target):this.check_node(a.target),this.data.ui&&this.save_selected(),this.data.cookies&&this.save_cookie("select_node"),a.preventDefault()},this))},__destroy:function(){this.get_container().find(".jstree-checkbox").remove()},_fn:{_prepare_checkboxes:function(b){b=!b||b==-1?this.get_container():this._get_node(b);var c,d=this,e;b.each(function(){e=a(this),c=e.is("li")&&e.hasClass("jstree-checked")?"jstree-checked":"jstree-unchecked",e.find("a").not(":has(.jstree-checkbox)").prepend("<ins class='jstree-checkbox'>&#160;</ins>").parent().not(".jstree-checked, .jstree-unchecked").addClass(c)}),b.is("li")?this._repair_state(b):b.find("> ul > li").each(function(){d._repair_state(this)})},change_state:function(b,c){b=this._get_node(b),c=c===!1||c===!0?c:b.hasClass("jstree-checked"),c?b.find("li").andSelf().removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked"):(b.find("li").andSelf().removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked"),this.data.ui&&(this.data.ui.last_selected=b),this.data.checkbox.last_selected=b),b.parentsUntil(".jstree","li").each(function(){var b=a(this);if(c){if(b.children("ul").children(".jstree-checked, .jstree-undetermined").length)return b.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),!1;b.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked")}else{if(b.children("ul").children(".jstree-unchecked, .jstree-undetermined").length)return b.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"),!1;b.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked")}}),this.data.ui&&(this.data.ui.selected=this.get_checked()),this.__callback(b)},check_node:function(a){this.change_state(a,!1)},uncheck_node:function(a){this.change_state(a,!0)},check_all:function(){var a=this;this.get_container().children("ul").children("li").each(function(){a.check_node(this,!1)})},uncheck_all:function(){var a=this;this.get_container().children("ul").children("li").each(function(){a.change_state(this,!0)})},is_checked:function(a){return a=this._get_node(a),a.length?a.is(".jstree-checked"):!1},get_checked:function(a){return a=!a||a===-1?this.get_container():this._get_node(a),a.find("> ul > .jstree-checked, .jstree-undetermined > ul > .jstree-checked")},get_unchecked:function(a){return a=!a||a===-1?this.get_container():this._get_node(a),a.find("> ul > .jstree-unchecked, .jstree-undetermined > ul > .jstree-unchecked")},show_checkboxes:function(){this.get_container().children("ul").removeClass("jstree-no-checkboxes")},hide_checkboxes:function(){this.get_container().children("ul").addClass("jstree-no-checkboxes")},_repair_state:function(a){a=this._get_node(a);if(!a.length)return;var b=a.find("> ul > .jstree-checked").length,c=a.find("> ul > .jstree-undetermined").length,d=a.find("> ul > li").length;d===0?a.hasClass("jstree-undetermined")&&this.check_node(a):b===0&&c===0?this.uncheck_node(a):b===d?this.check_node(a):a.parentsUntil(".jstree","li").removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined")},reselect:function(){if(this.data.ui){var b=this,c=this.data.ui.to_select;c=a.map(a.makeArray(c),function(a){return"#"+a.toString().replace(/^#/,"").replace("\\/","/").replace("/","\\/")}),this.deselect_all(),a.each(c,function(a,c){b.check_node(c)}),this.__callback()}}}})}(jQuery),function(a){a.vakata.xslt=function(b,c,d){var e="",f,g,h,i;return document.recalc?(f=document.createElement("xml"),g=document.createElement("xml"),f.innerHTML=b,g.innerHTML=c,a("body").append(f).append(g),setTimeout(function(a,b,c){return function(){c.call(null,a.transformNode(b.XMLDocument)),setTimeout(function(a,b){return function(){jQuery("body").remove(a).remove(b)}}(a,b),200)}}(f,g,d),100),!0):typeof window.DOMParser!="undefined"&&typeof window.XMLHttpRequest!="undefined"&&typeof window.XSLTProcessor!="undefined"?(h=new XSLTProcessor,i=a.isFunction(h.transformDocument)?typeof window.XMLSerializer!="undefined":!0,i?(b=(new DOMParser).parseFromString(b,"text/xml"),c=(new DOMParser).parseFromString(c,"text/xml"),a.isFunction(h.transformDocument)?(e=document.implementation.createDocument("","",null),h.transformDocument(b,c,e,null),d.call(null,XMLSerializer().serializeToString(e)),!0):(h.importStylesheet(c),e=h.transformToFragment(b,document),d.call(null,a("<div>").append(e).html()),!0)):!1):!1};var b={nest:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/html" /><xsl:template match="/">\t<xsl:call-template name="nodes">\t\t<xsl:with-param name="node" select="/root" />\t</xsl:call-template></xsl:template><xsl:template name="nodes">\t<xsl:param name="node" />\t<ul>\t<xsl:for-each select="$node/item">\t\t<xsl:variable name="children" select="count(./item) &gt; 0" />\t\t<li>\t\t\t<xsl:attribute name="class">\t\t\t\t<xsl:if test="position() = last()">jstree-last </xsl:if>\t\t\t\t<xsl:choose>\t\t\t\t\t<xsl:when test="@state = \'open\'">jstree-open </xsl:when>\t\t\t\t\t<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>\t\t\t\t\t<xsl:otherwise>jstree-leaf </xsl:otherwise>\t\t\t\t</xsl:choose>\t\t\t\t<xsl:value-of select="@class" />\t\t\t</xsl:attribute>\t\t\t<xsl:for-each select="@*">\t\t\t\t<xsl:if test="name() != \'class\' and name() != \'state\' and name() != \'hasChildren\'">\t\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t\t\t</xsl:if>\t\t\t</xsl:for-each>\t<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>\t\t\t<xsl:for-each select="content/name">\t\t\t\t<a>\t\t\t\t<xsl:attribute name="href">\t\t\t\t\t<xsl:choose>\t\t\t\t\t<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>\t\t\t\t\t<xsl:otherwise>#</xsl:otherwise>\t\t\t\t\t</xsl:choose>\t\t\t\t</xsl:attribute>\t\t\t\t<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>\t\t\t\t<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>\t\t\t\t<xsl:for-each select="@*">\t\t\t\t\t<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">\t\t\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t\t\t\t</xsl:if>\t\t\t\t</xsl:for-each>\t\t\t\t\t<ins>\t\t\t\t\t\t<xsl:attribute name="class">jstree-icon \t\t\t\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>\t\t\t\t\t\t</xsl:attribute>\t\t\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>\t\t\t\t\t\t<xsl:text>&#xa0;</xsl:text>\t\t\t\t\t</ins>\t\t\t\t\t<xsl:value-of select="current()" />\t\t\t\t</a>\t\t\t</xsl:for-each>\t\t\t<xsl:if test="$children or @hasChildren"><xsl:call-template name="nodes"><xsl:with-param name="node" select="current()" /></xsl:call-template></xsl:if>\t\t</li>\t</xsl:for-each>\t</ul></xsl:template></xsl:stylesheet>',flat:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/xml" /><xsl:template match="/">\t<ul>\t<xsl:for-each select="//item[not(@parent_id) or @parent_id=0 or not(@parent_id = //item/@id)]">\t\t<xsl:call-template name="nodes">\t\t\t<xsl:with-param name="node" select="." />\t\t\t<xsl:with-param name="is_last" select="number(position() = last())" />\t\t</xsl:call-template>\t</xsl:for-each>\t</ul></xsl:template><xsl:template name="nodes">\t<xsl:param name="node" />\t<xsl:param name="is_last" />\t<xsl:variable name="children" select="count(//item[@parent_id=$node/attribute::id]) &gt; 0" />\t<li>\t<xsl:attribute name="class">\t\t<xsl:if test="$is_last = true()">jstree-last </xsl:if>\t\t<xsl:choose>\t\t\t<xsl:when test="@state = \'open\'">jstree-open </xsl:when>\t\t\t<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>\t\t\t<xsl:otherwise>jstree-leaf </xsl:otherwise>\t\t</xsl:choose>\t\t<xsl:value-of select="@class" />\t</xsl:attribute>\t<xsl:for-each select="@*">\t\t<xsl:if test="name() != \'parent_id\' and name() != \'hasChildren\' and name() != \'class\' and name() != \'state\'">\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t</xsl:if>\t</xsl:for-each>\t<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>\t<xsl:for-each select="content/name">\t\t<a>\t\t<xsl:attribute name="href">\t\t\t<xsl:choose>\t\t\t<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>\t\t\t<xsl:otherwise>#</xsl:otherwise>\t\t\t</xsl:choose>\t\t</xsl:attribute>\t\t<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>\t\t<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>\t\t<xsl:for-each select="@*">\t\t\t<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>\t\t\t</xsl:if>\t\t</xsl:for-each>\t\t\t<ins>\t\t\t\t<xsl:attribute name="class">jstree-icon \t\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>\t\t\t\t</xsl:attribute>\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>\t\t\t\t<xsl:text>&#xa0;</xsl:text>\t\t\t</ins>\t\t\t<xsl:value-of select="current()" />\t\t</a>\t</xsl:for-each>\t<xsl:if test="$children">\t\t<ul>\t\t<xsl:for-each select="//item[@parent_id=$node/attribute::id]">\t\t\t<xsl:call-template name="nodes">\t\t\t\t<xsl:with-param name="node" select="." />\t\t\t\t<xsl:with-param name="is_last" select="number(position() = last())" />\t\t\t</xsl:call-template>\t\t</xsl:for-each>\t\t</ul>\t</xsl:if>\t</li></xsl:template></xsl:stylesheet>'};a.jstree.plugin("xml_data",{defaults:{data:!1,ajax:!1,xsl:"flat",clean_node:!1,correct_state:!0},_fn:{load_node:function(a,b,c){var d=this;this.load_node_xml(a,function(){d.__callback({obj:a}),b.call(this)},c)},_is_loaded:function(a){var b=this._get_settings().xml_data;return a=this._get_node(a),a==-1||!a||!b.ajax||a.is(".jstree-open, .jstree-leaf")||a.children("ul").children("li").size()>0},load_node_xml:function(b,c,d){var e=this.get_settings().xml_data,f=function(){},g=function(){};b=this._get_node(b);if(b&&b!==-1){if(b.data("jstree-is-loading"))return;b.data("jstree-is-loading",!0)}switch(!0){case!e.data&&!e.ajax:throw"Neither data nor ajax settings supplied.";case!!e.data&&!e.ajax||!!e.data&&!!e.ajax&&(!b||b===-1):(!b||b==-1)&&this.parse_xml(e.data,a.proxy(function(d){d?(d=d.replace(/ ?xmlns="[^"]*"/ig,""),d.length>10&&(d=a(d),this.get_container().children("ul").empty().append(d.children()),e.clean_node&&this.clean_node(b),c&&c.call(this))):e.correct_state&&(this.get_container().children("ul").empty(),c&&c.call(this))},this));break;case!e.data&&!!e.ajax||!!e.data&&!!e.ajax&&b&&b!==-1:f=function(a,c,f){var g=this.get_settings().xml_data.ajax.error;g&&g.call(this,a,c,f),b!==-1&&b.length?(b.children(".jstree-loading").removeClass("jstree-loading"),b.data("jstree-is-loading",!1),c==="success"&&e.correct_state&&b.removeClass("jstree-open jstree-closed").addClass("jstree-leaf")):c==="success"&&e.correct_state&&this.get_container().children("ul").empty(),d&&d.call(this)},g=function(d,g,h){d=h.responseText;var i=this.get_settings().xml_data.ajax.success;i&&(d=i.call(this,d,g,h)||d);if(d=="")return f.call(this,h,g,"");this.parse_xml(d,a.proxy(function(d){d&&(d=d.replace(/ ?xmlns="[^"]*"/ig,""),d.length>10?(d=a(d),b===-1||!b?this.get_container().children("ul").empty().append(d.children()):(b.children(".jstree-loading").removeClass("jstree-loading"),b.append(d),b.data("jstree-is-loading",!1)),e.clean_node&&this.clean_node(b),c&&c.call(this)):b&&b!==-1?(b.children(".jstree-loading").removeClass("jstree-loading"),b.data("jstree-is-loading",!1),e.correct_state&&(b.removeClass("jstree-open jstree-closed").addClass("jstree-leaf"),c&&c.call(this))):e.correct_state&&(this.get_container().children("ul").empty(),c&&c.call(this)))},this))},e.ajax.context=this,e.ajax.error=f,e.ajax.success=g,e.ajax.dataType||(e.ajax.dataType="xml"),a.isFunction(e.ajax.url)&&(e.ajax.url=e.ajax.url.call(this,b)),a.isFunction(e.ajax.data)&&(e.ajax.data=e.ajax.data.call(this,b)),a.ajax(e.ajax)}},parse_xml:function(c,d){var e=this._get_settings().xml_data;a.vakata.xslt(c,b[e.xsl],d)},get_xml:function(b,c,d,e,f){var g="",h=this._get_settings(),i=this,j,k,l,m,n;b||(b="flat"),f||(f=0),c=this._get_node(c);if(!c||c===-1)c=this.get_container().find("> ul > li");return d=a.isArray(d)?d:["id","class"],!f&&this.data.types&&a.inArray(h.types.type_attr,d)===-1&&d.push(h.types.type_attr),e=a.isArray(e)?e:[],f||(g+="<root>"),c.each(function(){g+="<item",l=a(this),a.each(d,function(a,b){g+=" "+b+'="'+(l.attr(b)||"").replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"")+'"'}),l.hasClass("jstree-open")&&(g+=' state="open"'),l.hasClass("jstree-closed")&&(g+=' state="closed"'),b==="flat"&&(g+=' parent_id="'+f+'"'),g+=">",g+="<content>",m=l.children("a"),m.each(function(){j=a(this),n=!1,g+="<name",a.inArray("languages",h.plugins)!==-1&&a.each(h.languages,function(a,b){if(j.hasClass(b))return g+=' lang="'+b+'"',n=b,!1}),e.length&&a.each(e,function(a,b){g+=" "+b+'="'+(j.attr(b)||"").replace(/jstree[^ ]*|$/ig,"")+'"'}),j.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length&&(g+=' icon="'+j.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"")+'"'),j.children("ins").get(0).style.backgroundImage.length&&(g+=' icon="'+j.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","")+'"'),g+=">",g+="<![CDATA["+i.get_text(j,n)+"]]>",g+="</name>"}),g+="</content>",k=l[0].id,l=l.find("> ul > li"),l.length?k=i.get_xml(b,l,d,e,k):k="",b=="nest"&&(g+=k),g+="</item>",b=="flat"&&(g+=k)}),f||(g+="</root>"),g}}})}(jQuery),function(a){a.expr[":"].jstree_contains=function(a,b,c){return(a.textContent||a.innerText||"").toLowerCase().indexOf(c[3].toLowerCase())>=0},a.jstree.plugin("search",{__init:function(){this.data.search.str="",this.data.search.result=a()},defaults:{ajax:!1,case_insensitive:!1},_fn:{search:function(b,c){if(b==="")return;var d=this.get_settings().search,e=this,f=function(){},g=function(){};this.data.search.str=b;if(!c&&d.ajax!==!1&&this.get_container().find(".jstree-closed:eq(0)").length>0){this.search.supress_callback=!0,f=function(){},g=function(a,b,c){var d=this.get_settings().search.ajax.success;d&&(a=d.call(this,a,b,c)||a),this.data.search.to_open=a,this._search_open()},d.ajax.context=this,d.ajax.error=f,d.ajax.success=g,a.isFunction(d.ajax.url)&&(d.ajax.url=d.ajax.url.call(this,b)),a.isFunction(d.ajax.data)&&(d.ajax.data=d.ajax.data.call(this,b)),d.ajax.data||(d.ajax.data={search_string:b});if(!d.ajax.dataType||/^json/.exec(d.ajax.dataType))d.ajax.dataType="json";a.ajax(d.ajax);return}this.data.search.result.length&&this.clear_search(),this.data.search.result=this.get_container().find("a"+(this.data.languages?"."+this.get_lang():"")+":"+(d.case_insensitive?"jstree_contains":"contains")+"("+this.data.search.str+")"),this.data.search.result.addClass("jstree-search").parents(".jstree-closed").each(function(){e.open_node(this,!1,!0)}),this.__callback({nodes:this.data.search.result,str:b})},clear_search:function(b){this.data.search.result.removeClass("jstree-search"),this.__callback(this.data.search.result),this.data.search.result=a()},_search_open:function(b){var c=this,d=!0,e=[],f=[];this.data.search.to_open.length&&(a.each(this.data.search.to_open,function(b,c){if(c=="#")return!0;a(c).length&&a(c).is(".jstree-closed")?e.push(c):f.push(c)}),e.length&&(this.data.search.to_open=f,a.each(e,function(a,b){c.open_node(b,function(){c._search_open(!0)})}),d=!1)),d&&this.search(this.data.search.str,!0)}}})}(jQuery),function(a){a.vakata.context={cnt:a("<div id='vakata-contextmenu'>"),vis:!1,tgt:!1,par:!1,func:!1,data:!1,show:function(b,c,d,e,f,g){var h=a.vakata.context.parse(b),i,j;if(!h)return;a.vakata.context.vis=!0,a.vakata.context.tgt=c,a.vakata.context.par=g||c||null,a.vakata.context.data=f||null,a.vakata.context.cnt.html(h).css({visibility:"hidden",display:"block",left:0,top:0}),i=a.vakata.context.cnt.height(),j=a.vakata.context.cnt.width(),d+j>a(document).width()&&(d=a(document).width()-(j+5),a.vakata.context.cnt.find("li > ul").addClass("right")),e+i>a(document).height()&&(e-=i+c[0].offsetHeight,a.vakata.context.cnt.find("li > ul").addClass("bottom")),a.vakata.context.cnt.css({left:d,top:e}).find("li:has(ul)").bind("mouseenter",function(b){var c=a(document).width(),d=a(document).height(),e=a(this).children("ul").show();c!==a(document).width()&&e.toggleClass("right"),d!==a(document).height()&&e.toggleClass("bottom")}).bind("mouseleave",function(b){a(this).children("ul").hide()}).end().css({visibility:"visible"}).show(),a(document).triggerHandler("context_show.vakata")},hide:function(){a.vakata.context.vis=!1,a.vakata.context.cnt.attr("class","").hide(),a(document).triggerHandler("context_hide.vakata")},parse:function(b,c){if(!b)return!1;var d="",e=!1,f=!0;return c||(a.vakata.context.func={}),d+="<ul>",a.each(b,function(b,c){if(!c)return!0;a.vakata.context.func[b]=c.action,!f&&c.separator_before&&(d+="<li class='vakata-separator vakata-separator-before'></li>"),f=!1,d+="<li class='"+(c._class||"")+(c._disabled?" jstree-contextmenu-disabled ":"")+"'><ins ",c.icon&&c.icon.indexOf("/")===-1&&(d+=" class='"+c.icon+"' "),c.icon&&c.icon.indexOf("/")!==-1&&(d+=" style='background:url("+c.icon+") center center no-repeat;' "),d+=">&#160;</ins><a href='#' rel='"+b+"'>",c.submenu&&(d+="<span style='float:right;'>&raquo;</span>"),d+=c.label+"</a>",c.submenu&&(e=a.vakata.context.parse(c.submenu,!0),e&&(d+=e)),d+="</li>",c.separator_after&&(d+="<li class='vakata-separator vakata-separator-after'></li>",f=!0)}),d=d.replace(/<li class\='vakata-separator vakata-separator-after'\><\/li\>$/,""),d+="</ul>",d.length>10?d:!1},exec:function(b){return a.isFunction(a.vakata.context.func[b])?(a.vakata.context.func[b].call(a.vakata.context.data,a.vakata.context.par),!0):!1}},a(function(){var b="#vakata-contextmenu { display:none; position:absolute; margin:0; padding:0; min-width:180px; background:#ebebeb; border:1px solid silver; z-index:10000; *width:180px; } #vakata-contextmenu ul { min-width:180px; *width:180px; } #vakata-contextmenu ul, #vakata-contextmenu li { margin:0; padding:0; list-style-type:none; display:block; } #vakata-contextmenu li { line-height:20px; min-height:20px; position:relative; padding:0px; } #vakata-contextmenu li a { padding:1px 6px; line-height:17px; display:block; text-decoration:none; margin:1px 1px 0 1px; } #vakata-contextmenu li ins { float:left; width:16px; height:16px; text-decoration:none; margin-right:2px; } #vakata-contextmenu li a:hover, #vakata-contextmenu li.vakata-hover > a { background:gray; color:white; } #vakata-contextmenu li ul { display:none; position:absolute; top:-2px; left:100%; background:#ebebeb; border:1px solid gray; } #vakata-contextmenu .right { right:100%; left:auto; } #vakata-contextmenu .bottom { bottom:-1px; top:auto; } #vakata-contextmenu li.vakata-separator { min-height:0; height:1px; line-height:1px; font-size:1px; overflow:hidden; margin:0 2px; background:silver; /* border-top:1px solid #fefefe; */ padding:0; } ";a.vakata.css.add_sheet({str:b}),a.vakata.context.cnt.delegate("a","click",function(a){a.preventDefault()}).delegate("a","mouseup",function(b){!a(this).parent().hasClass("jstree-contextmenu-disabled")&&a.vakata.context.exec(a(this).attr("rel"))?a.vakata.context.hide():a(this).blur()}).delegate("a","mouseover",function(){a.vakata.context.cnt.find(".vakata-hover").removeClass("vakata-hover")}).appendTo("body"),a(document).bind("mousedown",function(b){a.vakata.context.vis&&!a.contains(a.vakata.context.cnt[0],b.target)&&a.vakata.context.hide()}),typeof a.hotkeys!="undefined"&&a(document).bind("keydown","up",function(b){if(a.vakata.context.vis){var c=a.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").prevAll("li:not(.vakata-separator)").first();c.length||(c=a.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").last()),c.addClass("vakata-hover"),b.stopImmediatePropagation(),b.preventDefault()}}).bind("keydown","down",function(b){if(a.vakata.context.vis){var c=a.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").nextAll("li:not(.vakata-separator)").first();c.length||(c=a.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").first()),c.addClass("vakata-hover"),b.stopImmediatePropagation(),b.preventDefault()}}).bind("keydown","right",function(b){a.vakata.context.vis&&(a.vakata.context.cnt.find(".vakata-hover").children("ul").show().children("li:not(.vakata-separator)").removeClass("vakata-hover").first().addClass("vakata-hover"),b.stopImmediatePropagation(),b.preventDefault())}).bind("keydown","left",function(b){a.vakata.context.vis&&(a.vakata.context.cnt.find(".vakata-hover").children("ul").hide().children(".vakata-separator").removeClass("vakata-hover"),b.stopImmediatePropagation(),b.preventDefault())}).bind("keydown","esc",function(b){a.vakata.context.hide(),b.preventDefault()}).bind("keydown","space",function(b){a.vakata.context.cnt.find(".vakata-hover").last().children("a").click(),b.preventDefault()})}),a.jstree.plugin("contextmenu",{__init:function(){this.get_container().delegate("a","contextmenu.jstree",a.proxy(function(a){a.preventDefault(),this.show_contextmenu(a.currentTarget,a.pageX,a.pageY)},this)).bind("destroy.jstree",a.proxy(function(){this.data.contextmenu&&a.vakata.context.hide()},this)),a(document).bind("context_hide.vakata",a.proxy(function(){this.data.contextmenu=!1},this))},defaults:{select_node:!1,show_at_node:!0,items:{create:{separator_before:!1,separator_after:!0,label:"Create",action:function(a){this.create(a)}},rename:{separator_before:!1,separator_after:!1,label:"Rename",action:function(a){this.rename(a)}},remove:{separator_before:!1,icon:!1,separator_after:!1,label:"Delete",action:function(a){this.remove(a)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(a){this.cut(a)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(a){this.copy(a)}},paste:{separator_before:!1,icon:!1,separator_after:!1,label:"Paste",action:function(a){this.paste(a)}}}}}},_fn:{show_contextmenu:function(b,c,d){b=this._get_node(b);var e=this.get_settings().contextmenu,f=b.children("a:visible:eq(0)"),g=!1;e.select_node&&this.data.ui&&!this.is_selected(b)&&(this.deselect_all(),this.select_node(b,!0));if(e.show_at_node||typeof c=="undefined"||typeof d=="undefined")g=f.offset(),c=g.left,d=g.top+this.data.core.li_height;a.isFunction(e.items)&&(e.items=e.items.call(this,b)),this.data.contextmenu=!0,a.vakata.context.show(e.items,f,c,d,this,b),this.data.themes&&a.vakata.context.cnt.attr("class","jstree-"+this.data.themes.theme+"-context")}}})}(jQuery),function(a){a.jstree.plugin("types",{__init:function(){var b=this._get_settings().types;this.data.types.attach_to=[],this.get_container().bind("init.jstree",a.proxy(function(){var c=b.types,d=b.type_attr,e="",f=this;a.each(c,function(b,c){a.each(c,function(a,b){/^(max_depth|max_children|icon|valid_children)$/.test(a)||f.data.types.attach_to.push(a)});if(!c.icon)return!0;if(c.icon.image||c.icon.position)b=="default"?e+=".jstree-"+f.get_index()+" a > .jstree-icon { ":e+=".jstree-"+f.get_index()+" li["+d+"="+b+"] > a > .jstree-icon { ",c.icon.image&&(e+=" background-image:url("+c.icon.image+"); "),c.icon.position?e+=" background-position:"+c.icon.position+"; ":e+=" background-position:0 0; ",e+="} "}),e!=""&&a.vakata.css.add_sheet({str:e})},this)).bind("before.jstree",a.proxy(function(b,c){if(a.inArray(c.func,this.data.types.attach_to)!==-1){var d=this._get_settings().types.types,e=this._get_type(c.args[0]);if((d[e]&&typeof d[e][c.func]!="undefined"||d["default"]&&typeof d["default"][c.func]!="undefined")&&!this._check(c.func,c.args[0]))return b.stopImmediatePropagation(),!1}},this))},defaults:{max_children:-1,max_depth:-1,valid_children:"all",type_attr:"rel",types:{"default":{max_children:-1,max_depth:-1,valid_children:"all"}}},_fn:{_get_type:function(a){return a=this._get_node(a),!a||!a.length?!1:a.attr(this._get_settings().types.type_attr)||"default"},set_type:function(a,b){return b=this._get_node(b),!b.length||!a?!1:b.attr(this._get_settings().types.type_attr,a)},_check:function(b,c,d){var e=!1,f=this._get_type(c),g=0,h=this,i=this._get_settings().types;if(c===-1){if(!i[b])return;e=i[b]}else{if(f===!1)return;!i.types[f]||!i.types[f][b]?!!i.types["default"]&&!!i.types["default"][b]&&(e=i.types["default"][b]):e=i.types[f][b]}return a.isFunction(e)&&(e=e.call(this,c)),b==="max_depth"&&c!==-1&&d!==!1&&i.max_depth!==-2&&e!==0&&this._get_node(c).children("a:eq(0)").parentsUntil(".jstree","li").each(function(a){if(i.max_depth!==-1&&i.max_depth-(a+1)<=0)return e=0,!1;g=a===0?e:h._check(b,this,!1);if(g!==-1&&g-(a+1)<=0)return e=0,!1;g>=0&&(g-(a+1)<e||e<0)&&(e=g-(a+1)),i.max_depth>=0&&(i.max_depth-(a+1)<e||e<0)&&(e=i.max_depth-(a+1))}),e},check_move:function(){if(!this.__call_old())return!1;var b=this._get_move(),c=b.rt._get_settings().types,d=b.rt._check("max_children",b.cr),e=b.rt._check("max_depth",b.cr),f=b.rt._check("valid_children",b.cr),g=0,h=1,i;if(f==="none")return!1;if(a.isArray(f)&&b.ot&&b.ot._get_type){b.o.each(function(){if(a.inArray(b.ot._get_type(this),f)===-1)return h=!1,!1});if(h===!1)return!1}if(c.max_children!==-2&&d!==-1){g=b.cr===-1?this.get_container().children("> ul > li").not(b.o).length:b.cr.children("> ul > li").not(b.o).length;if(g+b.o.length>d)return!1}if(c.max_depth!==-2&&e!==-1){h=0;if(e===0)return!1;if(typeof b.o.d=="undefined"){i=b.o;while(i.length>0)i=i.find("> ul > li"),h++;b.o.d=h}if(e-b.o.d<0)return!1}return!0},create_node:function(b,c,d,e,f,g){if(!g&&(f||this._is_loaded(b))){var h=c&&c.match(/^before|after$/i)&&b!==-1?this._get_parent(b):this._get_node(b),i=this._get_settings().types,j=this._check("max_children",h),k=this._check("max_depth",h),l=this._check("valid_children",h),m;d||(d={});if(l==="none")return!1;if(a.isArray(l))if(!d.attr||!d.attr[i.type_attr])d.attr||(d.attr={}),d.attr[i.type_attr]=l[0];else if(a.inArray(d.attr[i.type_attr],l)===-1)return!1;if(i.max_children!==-2&&j!==-1){m=h===-1?this.get_container().children("> ul > li").length:h.children("> ul > li").length;if(m+1>j)return!1}if(i.max_depth!==-2&&k!==-1&&k-1<0)return!1}return this.__call_old(!0,b,c,d,e,f,g)}}})}(jQuery),function(a){a.jstree.plugin("html_data",{__init:function(){this.data.html_data.original_container_html=this.get_container().find(" > ul > li").clone(!0),this.data.html_data.original_container_html.find("li").andSelf().contents().filter(function(){return this.nodeType==3}).remove()},defaults:{data:!1,ajax:!1,correct_state:!0},_fn:{load_node:function(a,b,c){var d=this;this.load_node_html(a,function(){d.__callback({obj:a}),b.call(this)},c)},_is_loaded:function(a){return a=this._get_node(a),a==-1||!a||!this._get_settings().html_data.ajax||a.is(".jstree-open, .jstree-leaf")||a.children("ul").children("li").size()>0},load_node_html:function(b,c,d){var e,f=this.get_settings().html_data,g=function(){},h=function(){};b=this._get_node(b);if(b&&b!==-1){if(b.data("jstree-is-loading"))return;b.data("jstree-is-loading",!0)}switch(!0){case!f.data&&!f.ajax:if(!b||b==-1)this.get_container().children("ul").empty().append(this.data.html_data.original_container_html).find("li, a").filter(function(){return this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node();c&&c.call(this);break;case!!f.data&&!f.ajax||!!f.data&&!!f.ajax&&(!b||b===-1):if(!b||b==-1)e=a(f.data),e.is("ul")||(e=a("<ul>").append(e)),this.get_container().children("ul").empty().append(e.children()).find("li, a").filter(function(){return this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),this.clean_node();c&&c.call(this);break;case!f.data&&!!f.ajax||!!f.data&&!!f.ajax&&b&&b!==-1:b=this._get_node(b),g=function(a,c,e){var g=this.get_settings().html_data.ajax.error;g&&g.call(this,a,c,e),b!=-1&&b.length?(b.children(".jstree-loading").removeClass("jstree-loading"),b.data("jstree-is-loading",!1),c==="success"&&f.correct_state&&b.removeClass("jstree-open jstree-closed").addClass("jstree-leaf")):c==="success"&&f.correct_state&&this.get_container().children("ul").empty(),d&&d.call(this)},h=function(d,e,h){var i=this.get_settings().html_data.ajax.success;i&&(d=i.call(this,d,e,h)||d);if(d=="")return g.call(this,h,e,"");d?(d=a(d),d.is("ul")||(d=a("<ul>").append(d)),b==-1||!b?this.get_container().children("ul").empty().append(d.children()).find("li, a").filter(function(){return this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"):(b.children(".jstree-loading").removeClass("jstree-loading"),b.append(d).find("li, a").filter(function(){return this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"),b.data("jstree-is-loading",!1)),this.clean_node(b),c&&c.call(this)):b&&b!==-1?(b.children(".jstree-loading").removeClass("jstree-loading"),b.data("jstree-is-loading",!1),f.correct_state&&(b.removeClass("jstree-open jstree-closed").addClass("jstree-leaf"),c&&c.call(this))):f.correct_state&&(this.get_container().children("ul").empty(),c&&c.call(this))},f.ajax.context=this,f.ajax.error=g,f.ajax.success=h,f.ajax.dataType||(f.ajax.dataType="html"),a.isFunction(f.ajax.url)&&(f.ajax.url=f.ajax.url.call(this,b)),a.isFunction(f.ajax.data)&&(f.ajax.data=f.ajax.data.call(this,b)),a.ajax(f.ajax)}}}}),a.jstree.defaults.plugins.push("html_data")}(jQuery),function(a){a.jstree.plugin("themeroller",{__init:function(){var b=this._get_settings().themeroller;this.get_container().addClass("ui-widget-content").delegate("a","mouseenter.jstree",function(){a(this).addClass(b.item_h)}).delegate("a","mouseleave.jstree",function(){a(this).removeClass(b.item_h)}).bind("open_node.jstree create_node.jstree",a.proxy
(function(a,b){this._themeroller(b.rslt.obj)},this)).bind("loaded.jstree refresh.jstree",a.proxy(function(a){this._themeroller()},this)).bind("close_node.jstree",a.proxy(function(a,c){c.rslt.obj.children("ins").removeClass(b.opened).addClass(b.closed)},this)).bind("select_node.jstree",a.proxy(function(a,c){c.rslt.obj.children("a").addClass(b.item_a)},this)).bind("deselect_node.jstree deselect_all.jstree",a.proxy(function(a,c){this.get_container().find("."+b.item_a).removeClass(b.item_a).end().find(".jstree-clicked").addClass(b.item_a)},this)).bind("move_node.jstree",a.proxy(function(a,b){this._themeroller(b.rslt.o)},this))},__destroy:function(){var b=this._get_settings().themeroller,c=["ui-icon"];a.each(b,function(a,b){b=b.split(" "),b.length&&(c=c.concat(b))}),this.get_container().removeClass("ui-widget-content").find("."+c.join(", .")).removeClass(c.join(" "))},_fn:{_themeroller:function(a){var b=this._get_settings().themeroller;a=!a||a==-1?this.get_container():this._get_node(a).parent(),a.find("li.jstree-closed > ins.jstree-icon").removeClass(b.opened).addClass("ui-icon "+b.closed).end().find("li.jstree-open > ins.jstree-icon").removeClass(b.closed).addClass("ui-icon "+b.opened).end().find("a").addClass(b.item).children("ins.jstree-icon").addClass("ui-icon "+b.item_icon)}},defaults:{opened:"ui-icon-triangle-1-se",closed:"ui-icon-triangle-1-e",item:"ui-state-default",item_h:"ui-state-hover",item_a:"ui-state-active",item_icon:"ui-icon-folder-collapsed"}}),a(function(){var b=".jstree .ui-icon { overflow:visible; } .jstree a { padding:0 2px; }";a.vakata.css.add_sheet({str:b})})}(jQuery),function(a){a.jstree.plugin("unique",{__init:function(){this.get_container().bind("before.jstree",a.proxy(function(b,c){var d=[],e=!0,f,g;c.func=="move_node"&&c.args[4]===!0&&c.args[0].o&&c.args[0].o.length&&(c.args[0].o.children("a").each(function(){d.push(a(this).text().replace(/^\s+/g,""))}),e=this._check_unique(d,c.args[0].np.find("> ul > li").not(c.args[0].o)));if(c.func=="create_node")if(c.args[4]||this._is_loaded(c.args[0])){f=this._get_node(c.args[0]);if(c.args[1]&&(c.args[1]==="before"||c.args[1]==="after")){f=this._get_parent(c.args[0]);if(!f||f===-1)f=this.get_container()}typeof c.args[2]=="string"?d.push(c.args[2]):!c.args[2]||!c.args[2].data?d.push(this._get_settings().core.strings.new_node):d.push(c.args[2].data),e=this._check_unique(d,f.find("> ul > li"))}if(c.func=="rename_node"){d.push(c.args[1]),g=this._get_node(c.args[0]),f=this._get_parent(g);if(!f||f===-1)f=this.get_container();e=this._check_unique(d,f.find("> ul > li").not(g))}if(!e)return b.stopPropagation(),!1},this))},_fn:{_check_unique:function(b,c){var d=[];return c.children("a").each(function(){d.push(a(this).text().replace(/^\s+/g,""))}),!d.length||!b.length?!0:(d=d.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(","),d.length+b.length!=d.concat(b).sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",").length?!1:!0)},check_move:function(){if(!this.__call_old())return!1;var b=this._get_move(),c=[];return b.o&&b.o.length?(b.o.children("a").each(function(){c.push(a(this).text().replace(/^\s+/g,""))}),this._check_unique(c,b.np.find("> ul > li").not(b.o))):!0}}})}(jQuery)}),require.addModuleClosure("underscore",function(a,b,c){(function(){var a=this,b=a._,d={},e=Array.prototype,f=Object.prototype,g=e.slice,h=e.unshift,i=f.toString,j=f.hasOwnProperty,k=e.forEach,l=e.map,m=e.reduce,n=e.reduceRight,o=e.filter,p=e.every,q=e.some,r=e.indexOf,s=e.lastIndexOf,t=Array.isArray,u=Object.keys,v=function(a){return new A(a)};typeof c!="undefined"&&c.exports?(c.exports=v,v._=v):a._=v,v.VERSION="1.1.4";var w=v.each=v.forEach=function(a,b,c){if(a==null)return;if(k&&a.forEach===k)a.forEach(b,c);else if(v.isNumber(a.length)){for(var e=0,f=a.length;e<f;e++)if(b.call(c,a[e],e,a)===d)return}else for(var g in a)if(j.call(a,g)&&b.call(c,a[g],g,a)===d)return};v.map=function(a,b,c){var d=[];return a==null?d:l&&a.map===l?a.map(b,c):(w(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),d)},v.reduce=v.foldl=v.inject=function(a,b,c,d){var e=c!==void 0;a==null&&(a=[]);if(m&&a.reduce===m)return d&&(b=v.bind(b,d)),e?a.reduce(b,c):a.reduce(b);w(a,function(a,f,g){!e&&f===0?(c=a,e=!0):c=b.call(d,c,a,f,g)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c},v.reduceRight=v.foldr=function(a,b,c,d){a==null&&(a=[]);if(n&&a.reduceRight===n)return d&&(b=v.bind(b,d)),c!==void 0?a.reduceRight(b,c):a.reduceRight(b);var e=(v.isArray(a)?a.slice():v.toArray(a)).reverse();return v.reduce(e,b,c,d)},v.find=v.detect=function(a,b,c){var d;return x(a,function(a,e,f){if(b.call(c,a,e,f))return d=a,!0}),d},v.filter=v.select=function(a,b,c){var d=[];return a==null?d:o&&a.filter===o?a.filter(b,c):(w(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},v.reject=function(a,b,c){var d=[];return a==null?d:(w(a,function(a,e,f){b.call(c,a,e,f)||(d[d.length]=a)}),d)},v.every=v.all=function(a,b,c){b=b||v.identity;var e=!0;return a==null?e:p&&a.every===p?a.every(b,c):(w(a,function(a,f,g){if(!(e=e&&b.call(c,a,f,g)))return d}),e)};var x=v.some=v.any=function(a,b,c){b=b||v.identity;var e=!1;return a==null?e:q&&a.some===q?a.some(b,c):(w(a,function(a,f,g){if(e=b.call(c,a,f,g))return d}),e)};v.include=v.contains=function(a,b){var c=!1;return a==null?c:r&&a.indexOf===r?a.indexOf(b)!=-1:(x(a,function(a){if(c=a===b)return!0}),c)},v.invoke=function(a,b){var c=g.call(arguments,2);return v.map(a,function(a){return(b?a[b]:a).apply(a,c)})},v.pluck=function(a,b){return v.map(a,function(a){return a[b]})},v.max=function(a,b,c){if(!b&&v.isArray(a))return Math.max.apply(Math,a);var d={computed:-Infinity};return w(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})}),d.value},v.min=function(a,b,c){if(!b&&v.isArray(a))return Math.min.apply(Math,a);var d={computed:Infinity};return w(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},v.sortBy=function(a,b,c){return v.pluck(v.map(a,function(a,d,e){return{value:a,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")},v.sortedIndex=function(a,b,c){c=c||v.identity;var d=0,e=a.length;while(d<e){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d},v.toArray=function(a){return a?a.toArray?a.toArray():v.isArray(a)?a:v.isArguments(a)?g.call(a):v.values(a):[]},v.size=function(a){return v.toArray(a).length},v.first=v.head=function(a,b,c){return b!=null&&!c?g.call(a,0,b):a[0]},v.rest=v.tail=function(a,b,c){return g.call(a,b==null||c?1:b)},v.last=function(a){return a[a.length-1]},v.compact=function(a){return v.filter(a,function(a){return!!a})},v.flatten=function(a){return v.reduce(a,function(a,b){return v.isArray(b)?a.concat(v.flatten(b)):(a[a.length]=b,a)},[])},v.without=function(a){var b=g.call(arguments,1);return v.filter(a,function(a){return!v.include(b,a)})},v.uniq=v.unique=function(a,b){return v.reduce(a,function(a,c,d){if(0==d||(b===!0?v.last(a)!=c:!v.include(a,c)))a[a.length]=c;return a},[])},v.intersect=function(a){var b=g.call(arguments,1);return v.filter(v.uniq(a),function(a){return v.every(b,function(b){return v.indexOf(b,a)>=0})})},v.zip=function(){var a=g.call(arguments),b=v.max(v.pluck(a,"length")),c=new Array(b);for(var d=0;d<b;d++)c[d]=v.pluck(a,""+d);return c},v.indexOf=function(a,b,c){if(a==null)return-1;var d,e;if(c)return d=v.sortedIndex(a,b),a[d]===b?d:-1;if(r&&a.indexOf===r)return a.indexOf(b);for(d=0,e=a.length;d<e;d++)if(a[d]===b)return d;return-1},v.lastIndexOf=function(a,b){if(a==null)return-1;if(s&&a.lastIndexOf===s)return a.lastIndexOf(b);var c=a.length;while(c--)if(a[c]===b)return c;return-1},v.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);while(e<d)f[e++]=a,a+=c;return f},v.bind=function(a,b){var c=g.call(arguments,2);return function(){return a.apply(b||{},c.concat(g.call(arguments)))}},v.bindAll=function(a){var b=g.call(arguments,1);return b.length==0&&(b=v.functions(a)),w(b,function(b){a[b]=v.bind(a[b],a)}),a},v.memoize=function(a,b){var c={};return b=b||v.identity,function(){var d=b.apply(this,arguments);return j.call(c,d)?c[d]:c[d]=a.apply(this,arguments)}},v.delay=function(a,b){var c=g.call(arguments,2);return setTimeout(function(){return a.apply(a,c)},b)},v.defer=function(a){return v.delay.apply(v,[a,1].concat(g.call(arguments,1)))};var y=function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,a.apply(e,f)};c&&clearTimeout(d);if(c||!d)d=setTimeout(g,b)}};v.throttle=function(a,b){return y(a,b,!1)},v.debounce=function(a,b){return y(a,b,!0)},v.wrap=function(a,b){return function(){var c=[a].concat(g.call(arguments));return b.apply(this,c)}},v.compose=function(){var a=g.call(arguments);return function(){var b=g.call(arguments);for(var c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},v.keys=u||function(a){var b=[];for(var c in a)j.call(a,c)&&(b[b.length]=c);return b},v.values=function(a){return v.map(a,v.identity)},v.functions=v.methods=function(a){return v.filter(v.keys(a),function(b){return v.isFunction(a[b])}).sort()},v.extend=function(a){return w(g.call(arguments,1),function(b){for(var c in b)a[c]=b[c]}),a},v.defaults=function(a){return w(g.call(arguments,1),function(b){for(var c in b)a[c]==null&&(a[c]=b[c])}),a},v.clone=function(a){return v.isArray(a)?a.slice():v.extend({},a)},v.tap=function(a,b){return b(a),a},v.isEqual=function(a,b){if(a===b)return!0;var c=typeof a,d=typeof b;if(c!=d)return!1;if(a==b)return!0;if(!a&&b||a&&!b)return!1;a._chain&&(a=a._wrapped),b._chain&&(b=b._wrapped);if(a.isEqual)return a.isEqual(b);if(v.isDate(a)&&v.isDate(b))return a.getTime()===b.getTime();if(v.isNaN(a)&&v.isNaN(b))return!1;if(v.isRegExp(a)&&v.isRegExp(b))return a.source===b.source&&a.global===b.global&&a.ignoreCase===b.ignoreCase&&a.multiline===b.multiline;if(c!=="object")return!1;if(a.length&&a.length!==b.length)return!1;var e=v.keys(a),f=v.keys(b);if(e.length!=f.length)return!1;for(var g in a)if(!(g in b)||!v.isEqual(a[g],b[g]))return!1;return!0},v.isEmpty=function(a){if(v.isArray(a)||v.isString(a))return a.length===0;for(var b in a)if(j.call(a,b))return!1;return!0},v.isElement=function(a){return!!a&&a.nodeType==1},v.isArray=t||function(a){return i.call(a)==="[object Array]"},v.isArguments=function(a){return!!a&&!!j.call(a,"callee")},v.isFunction=function(a){return!!(a&&a.constructor&&a.call&&a.apply)},v.isString=function(a){return!!(a===""||a&&a.charCodeAt&&a.substr)},v.isNumber=function(a){return!!(a===0||a&&a.toExponential&&a.toFixed)},v.isNaN=function(a){return a!==a},v.isBoolean=function(a){return a===!0||a===!1},v.isDate=function(a){return!!(a&&a.getTimezoneOffset&&a.setUTCFullYear)},v.isRegExp=function(a){return!(!(a&&a.test&&a.exec)||!a.ignoreCase&&a.ignoreCase!==!1)},v.isNull=function(a){return a===null},v.isUndefined=function(a){return a===void 0},v.noConflict=function(){return a._=b,this},v.identity=function(a){return a},v.times=function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)},v.mixin=function(a){w(v.functions(a),function(b){C(b,v[b]=a[b])})};var z=0;v.uniqueId=function(a){var b=z++;return a?a+b:b},v.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g},v.template=function(a,b){var c=v.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.interpolate,function(a,b){return"',"+b.replace(/\\'/g,"'")+",'"}).replace(c.evaluate||null,function(a,b){return"');"+b.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj",d);return b?e(b):e};var A=function(a){this._wrapped=a};v.prototype=A.prototype;var B=function(a,b){return b?v(a).chain():a},C=function(a,b){A.prototype[a]=function(){var a=g.call(arguments);return h.call(a,this._wrapped),B(b.apply(v,a),this._chain)}};v.mixin(v),w(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=e[a];A.prototype[a]=function(){return b.apply(this._wrapped,arguments),B(this._wrapped,this._chain)}}),w(["concat","join","slice"],function(a){var b=e[a];A.prototype[a]=function(){return B(b.apply(this._wrapped,arguments),this._chain)}}),A.prototype.chain=function(){return this._chain=!0,this},A.prototype.value=function(){return this._wrapped}})()}),require.addModuleClosure("app",function(a,b,c){function h(){var a=e.collections;return a.pages=k("pages"),a.templates=k("templates"),a.content=k("content"),a.plugins=k("plugins"),e.refresh({silent:!0}).get("collections").get("plugins").then(j)}function i(a,b){b.find(".sidebar").length?$("body").addClass("with-sidebar"):$("body").removeClass("with-sidebar"),$("body").removeClass("loading")}function j(b){return b.forEach(function(b){b.active&&a(b.moduleId)}),e}function k(b){var c,d;typeof localStorage!="undefined"&&(c=localStorage.getItem(b)||undefined);try{d=a(b)[b],d.refresh(c,{silent:!0})}catch(e){d=new f(c,{url:"api/"+b})}return d}var d=a("cookie"),e=a("data"),f=a("Backbone").Collection,g=a("screens");if(location.protocol!="https:"||location.host!="s3.amazonaws.com")throw location.href="https://s3.amazonaws.com/"+location.host+location.pathname,new Error("Cannot administer site from this location.");e.bind("login",h),g.bind("open",i),g.at("login")||e.auth().then(function(){location.hash||g.go("dashboard")},function(){g.go("login")})}),require.addModuleClosure("Backbone",function(a,b,c){((function(){var c;typeof b!="undefined"?c=b:c=this.Backbone={},c.VERSION="0.3.3";var d=this._;!d&&typeof a!="undefined"&&(d=a("underscore")._);var e=this.jQuery||this.Zepto;c.emulateHTTP=!1,c.emulateJSON=!1,c.Events={bind:function(a,b){var c=this._callbacks||(this._callbacks={}),d=this._callbacks[a]||(this._callbacks[a]=[]);return d.push(b),this},unbind:function(a,b){var c;if(!a)this._callbacks={};else if(c=this._callbacks)if(!b)c[a]=[];else{var d=c[a];if(!d)return this;for(var e=0,f=d.length;e<f;e++)if(b===d[e]){d.splice(e,1);break}}return this},trigger:function(a){var b,c,d,e;if(!(c=this._callbacks))return this;if(c[a]){b=c[a].slice(0);for(d=0,e=b.length;d<e;d++)b[d].apply(this,Array.prototype.slice.call(arguments,1))}if(c.all){b=c.all.slice(0);for(d=0,e=b.length;d<e;d++)b[d].apply(this,arguments)}return this}},c.Model=function(a,b){var c;a||(a={});if(c=this.defaults)d.isFunction(c)&&(c=c()),a=d.extend({},c,a);this.attributes={},this._escapedAttributes={},this.cid=d.uniqueId("c"),this.set(a,{silent:!0}),this._changed=!1,this._previousAttributes=d.clone(this.attributes),b&&b.collection&&(this.collection=b.collection),this.initialize(a,b)},d.extend(c.Model.prototype,c.Events,{_previousAttributes:null,_changed:!1,idAttribute:"id",initialize:function(){},toJSON:function(){return d.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(a){var b;if(b=this._escapedAttributes[a])return b;var c=this.attributes[a];return this._escapedAttributes[a]=v(c==null?"":""+c)},has:function(a){return this.attributes[a]!=null},set:function(a,b){b||(b={});if(!a)return this;a.attributes&&(a=a.attributes);var c=this.attributes,e=this._escapedAttributes;if(!b.silent&&this.validate&&!this._performValidation(a,b))return!1;this.idAttribute in a&&(this.id=a[this.idAttribute]);for(var f in a){var g=a[f];d.isEqual(c[f],g)||(c[f]=g,delete e[f],this._changed=!0,b.silent||this.trigger("change:"+f,this,g,b))}return!b.silent&&this._changed&&this.change(b),this},unset:function(a,b){if(a in this.attributes){b||(b={});var c=this.attributes[a],d={};return d[a]=void 0,!b.silent&&this.validate&&!this._performValidation(d,b)?!1:(delete this.attributes[a],delete this._escapedAttributes[a],a==this.idAttribute&&delete this.id,this._changed=!0,b.silent||(this.trigger("change:"+a,this,void 0,b),this.change(b)),this)}return this},clear:function(a){a||(a={});var b=this.attributes,c={};for(attr in b)c[attr]=void 0;if(!a.silent&&this.validate&&!this._performValidation(c,a))return!1;this.attributes={},this._escapedAttributes={},this._changed=!0;if(!a.silent){for(attr in b)this.trigger("change:"+attr,this,void 0,a);this.change(a)}return this},fetch:function(a){a||(a={});var b=this,d=a.success;return a.success=function(c){if(!b.set(b.parse(c),a))return!1;d&&d(b,c)},a.error=u(a.error,b,a),(this.sync||c.sync).call(this,"read",this,a),this},save:function(a,b){b||(b={});if(a&&!this.set(a,b))return!1;var d=this,e=b.success;b.success=function(a){if(!d.set(d.parse(a),b))return!1;e&&e(d,a)},b.error=u(b.error,d,b);var f=this.isNew()?"create":"update";return(this.sync||c.sync).call(this,f,this,b),this},destroy:function(a){a||(a={});var b=this,d=a.success;return a.success=function(c){b.trigger("destroy",b,b.collection,a),d&&d(b,c)},a.error=u(a.error,b,a),(this.sync||c.sync).call(this,"delete",this,a),this},url:function(){var a=s(this.collection)||this.urlRoot||t();return this.isNew()?a:a+(a.charAt(a.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(a){return a},clone:function(){return new this.constructor(this)},isNew:function(){return!this.id},change:function(a){this.trigger("change",this,a),this._previousAttributes=d.clone(this.attributes),this._changed=!1},hasChanged:function(a){return a?this._previousAttributes[a]!=this.attributes[a]:this._changed},changedAttributes:function(a){a||(a=this.attributes);var b=this._previousAttributes,c=!1;for(var e in a)d.isEqual(b[e],a[e])||(c=c||{},c[e]=a[e]);return c},previous:function(a){return!a||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return d.clone(this._previousAttributes)},_performValidation:function(a,b){var c=this.validate(a);return c?(b.error?b.error(this,c):this.trigger("error",this,c,b),!1):!0}}),c.Collection=function(a,b){b||(b={}),b.comparator&&(this.comparator=b.comparator,delete b.comparator),d.bindAll(this,"_onModelEvent","_removeReference"),this._reset(),a&&this.refresh(a,{silent:!0}),this.initialize(a,b)},d.extend(c.Collection.prototype,c.Events,{model:c.Model,initialize:function(){},toJSON:function(){return this.map(function(a){return a.toJSON()})},add:function(a,b){if(d.isArray(a))for(var c=0,e=a.length;c<e;c++)this._add(a[c],b);else this._add(a,b);return this},remove:function(a,b){if(d.isArray(a))for(var c=0,e=a.length;c<e;c++)this._remove(a[c],b);else this._remove(a,b);return this},get:function(a){return a==null?null:this._byId[a.id!=null?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},sort:function(a){a||(a={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return this.models=this.sortBy(this.comparator),a.silent||this.trigger("refresh",this,a),this},pluck:function(a){return d.map(this.models,function(b){return b.get(a)})},refresh:function(a,b){return a||(a=[]),b||(b={}),this.each(this._removeReference),this._reset(),this.add(a,{silent:!0}),b.silent||this.trigger("refresh",this,b),this},fetch:function(a){a||(a={});var b=this,d=a.success;return a.success=function(c){b[a.add?"add":"refresh"](b.parse(c),a),d&&d(b,c)},a.error=u(a.error,b,a),(this.sync||c.sync).call(this,"read",this,a),this},create:function(a,b){var d=this;b||(b={});if(a instanceof c.Model)a.collection=d;else{var e=a;a=new this.model(null,{collection:d});if(!a.set(e))return!1}var f=b.success;return b.success=function(a,b){d.add(a),f&&f(a,b)},a.save(null,b)},parse:function(a){return a},chain:function(){return d(this.models).chain()},_reset:function(a){this.length=0,this.models=[],this._byId={},this._byCid={}},_add:function(a,b){b||(b={}),a instanceof c.Model||(a=new this.model(a,{collection:this}));var d=this.getByCid(a);if(d)throw new Error(["Can't add the same model to a set twice",d.id]);this._byId[a.id]=a,this._byCid[a.cid]=a,a.collection||(a.collection=this);var e=this.comparator?this.sortedIndex(a,this.comparator):this.length;return this.models.splice(e,0,a),a.bind("all",this._onModelEvent),this.length++,b.silent||a.trigger("add",a,this,b),a},_remove:function(a,b){return b||(b={}),a=this.getByCid(a)||this.get(a),a?(delete this._byId[a.id],delete this._byCid[a.cid],this.models.splice(this.indexOf(a),1),this.length--,b.silent||a.trigger("remove",a,this,b),this._removeReference(a),a):null},_removeReference:function(a){this==a.collection&&delete a.collection,a.unbind("all",this._onModelEvent)},_onModelEvent:function(a,b,c,d){if(a!="add"&&a!="remove"||c==this)a=="destroy"&&this._remove(b,d),a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],this._byId[b.id]=b),this.trigger.apply(this,arguments);else return}});var f=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","invoke","max","min","sortBy","sortedIndex","toArray","size","first","rest","last","without","indexOf","lastIndexOf","isEmpty"];d.each(f,function(a){c.Collection.prototype[a]=function(){return d[a].apply(d,[this.models].concat(d.toArray(arguments)))}}),c.Controller=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize(a)};var g=/:([\w\d]+)/g,h=/\*([\w\d]+)/g,i=/[-[\]{}()+?.,\\^$|#\s]/g;d.extend(c.Controller.prototype,c.Events,{initialize:function(){},route:function(a,b,e){c.history||(c.history=new c.History),d.isRegExp(a)||(a=this._routeToRegExp(a)),c.history.route(a,d.bind(function(c){var d=this._extractParameters(a,c);e.apply(this,d),this.trigger.apply(this,["route:"+b].concat(d))},this))},saveLocation:function(a){c.history.saveLocation(a)},_bindRoutes:function(){if(!this.routes)return;var a=[];for(var b in this.routes)a.unshift([b,this.routes[b]]);for(var c=0,d=a.length;c<d;c++)this.route(a[c][0],a[c][1],this[a[c][1]])},_routeToRegExp:function(a){return a=a.replace(i,"\\$&").replace(g,"([^/]*)").replace(h,"(.*?)"),new RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}}),c.History=function(){this.handlers=[],this.fragment=this.getFragment(),d.bindAll(this,"checkUrl")};var j=/^#*/,k=!1;d.extend(c.History.prototype,{interval:50,getFragment:function(a){return(a||window.location).hash.replace(j,"")},start:function(){if(k)throw new Error("Backbone.history has already been started");var a=document.documentMode,b=e.browser.msie&&(!a||a<=7);return b&&(this.iframe=e('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow),"onhashchange"in window&&!b?e(window).bind("hashchange",this.checkUrl):setInterval(this.checkUrl,this.interval),k=!0,this.loadUrl()},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(){var a=this.getFragment();a==this.fragment&&this.iframe&&(a=this.getFragment(this.iframe.location));if(a==this.fragment||a==decodeURIComponent(this.fragment))return!1;this.iframe&&(window.location.hash=this.iframe.location.hash=a),this.loadUrl()},loadUrl:function(){var a=this.fragment=this.getFragment(),b=d.any(this.handlers,function(b){if(b.route.test(a))return b.callback(a),!0});return b},saveLocation:function(a){a=(a||"").replace(j,"");if(this.fragment==a)return;window.location.hash=this.fragment=a,this.iframe&&a!=this.getFragment(this.iframe.location)&&(this.iframe.document.open().close(),this.iframe.location.hash=a)}}),c.View=function(a){this.cid=d.uniqueId("view"),this._configure(a||{}),this._ensureElement(),this.delegateEvents(),this.initialize(a)};var l=function(a){return e(a,this.el)},m=/^(\w+)\s*(.*)$/,n=["model","collection","el","id","attributes","className","tagName"];d.extend(c.View.prototype,c.Events,{tagName:"div",$:l,initialize:function(){},render:function(){return this},remove:function(){return e(this.el).remove(),this},make:function(a,b,c){var d=document.createElement(a);return b&&e(d).attr(b),c&&e(d).html(c),d},delegateEvents:function(a){if(!a&&!(a=this.events))return;e(this.el).unbind(".delegateEvents"+this.cid);for(var b in a){var c=a[b],f=b.match(m),g=f[1],h=f[2],i=d.bind(this[c],this);g+=".delegateEvents"+this.cid,h===""?e(this.el).bind(g,i):e(this.el).delegate(h,g,i)}},_configure:function(a){this.options&&(a=d.extend({},this.options,a));for(var b=0,c=n.length;b<c;b++){var e=n[b];a[e]&&(this[e]=a[e])}this.options=a},_ensureElement:function(){if(!this.el){var a=this.attributes||{};this.id&&(a.id=this.id),this.className&&(a["class"]=this.className),this.el=this.make(this.tagName,a)}else d.isString(this.el)&&(this.el=e(this.el).get(0))}});var o=function(a,b){var c=r(this,a,b);return c.extend=o,c};c.Model.extend=c.Collection.extend=c.Controller.extend=c.View.extend=o;var p={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};c.sync=function(a,b,f){var g=p[a],h=d.extend({type:g,contentType:"application/json",dataType:"json",processData:!1},f);h.url||(h.url=s(b)||t()),!h.data&&b&&(a=="create"||a=="update")&&(h.data=JSON.stringify(b.toJSON())),c.emulateJSON&&(h.contentType="application/x-www-form-urlencoded",h.processData=!0,h.data=h.data?{model:h.data}:{}),c.emulateHTTP&&(g==="PUT"||g==="DELETE")&&(c.emulateJSON&&(h.data._method=g),h.type="POST",h.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",g)}),e.ajax(h)};var q=function(){},r=function(a,b,c){var e;return b&&b.hasOwnProperty("constructor")?e=b.constructor:e=function(){return a.apply(this,arguments)},d.extend(e,a),q.prototype=a.prototype,e.prototype=new q,b&&d.extend(e.prototype,b),c&&d.extend(e,c),e.prototype.constructor=e,e.__super__=a.prototype,e},s=function(a){return!a||!a.url?null:d.isFunction(a.url)?a.url():a.url},t=function(){throw new Error("A 'url' property or function must be specified")},u=function(a,b,c){return function(d){a?a(b,d,c):b.trigger("error",b,d,c)}},v=function(a){return a.replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}})).call(this)}),require.run("app")